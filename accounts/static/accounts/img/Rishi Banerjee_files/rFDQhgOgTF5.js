if (self.CavalryLogger) { CavalryLogger.start_js(["BxuEA"]); }

__d("ChatAnimatedGifs",["URI"],(function(a,b,c,d,e,f){__p&&__p();var g={shouldHideBody:function(a){__p&&__p();if(!a.has_attachment)return!1;for(var b=0;b<a.attachments.length;b++){var c=a.attachments[b];if(c.preview_url){c=g.getRawUrlFromSafeUrl(c.preview_url);if(a.body==c)return!0}}return!1},getRawUrlFromSafeUrl:function(a){return new(b("URI"))(a).getQueryData().url}};e.exports=g}),null);
__d("ChatBubble.react",["cx","BootloadedComponent.react","DOMDimensions","EmojiOnlyMessage.react","ErrorBoundary.react","JSResource","MercuryConfig","MercuryMessageBody.react","MercuryMessageRenderLocations","MessageReplyPermissions","MessengerMathUtils","MessengerSupportedEmojiUtils","React","ReactDOM","joinClasses","messengerCustomColorUtils"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;var h=2;c=b("React").createClass({displayName:"ChatBubble",_boxWidth:0,_repliedToMessageRef:null,propTypes:{attachments:a.node,body:a.string,className:a.string,customColor:a.string,customLike:a.object,isEmojiLike:a.bool,isFromViewer:a.bool,maxWidth:a.number.isRequired,message:a.object,metaRanges:a.array,onReplyToMessage:a.func,ranges:a.array,threadCustomColor:a.string,threadID:a.string},getInitialState:function(){return{emojis:undefined,bubbleWidth:null}},componentDidMount:function(){if(this.props.attachments&&!this.props.isEmojiLike)return;if(!this.props.emojis){var a=this.props.body||"";a=b("MessengerSupportedEmojiUtils").getEmojiOnlyContents(a);a&&a.length&&this.setState({emojis:a})}this._restyleBubble(this.props)},componentDidUpdate:function(a){(a.maxWidth!==this.props.maxWidth||a.body!==this.props.body||!a.attachments&&this.props.attachments)&&this._restyleBubble(a)},render:function(){__p&&__p();var a=this.props,c=a.attachments,d=a.body;d=d===void 0?"":d;var e=a.className,f=a.maxWidth;a=babelHelpers.objectWithoutProperties(a,["attachments","body","className","maxWidth"]);a=Object.assign({},a);delete a.customColor;delete a.customLike;delete a.isEmojiLike;delete a.isFromViewer;delete a.message;delete a.metaRanges;delete a.ranges;delete a.threadCustomColor;delete a.threadID;return b("React").createElement("div",babelHelpers["extends"]({},a,{className:b("joinClasses")("_5w1r"+(this.state.emojis?"":" _3_om")+(this.state.emojis?" _31xx":"")+(this.props.message&&this.props.message.replied_to_message&&this.props.message.replied_to_message.body&&!b("MercuryConfig").SM3BD?" _1vmy":""),e),ref:"bubble",style:{maxWidth:f,width:this.state.emojis?null:this.state.bubbleWidth,wordWrap:d.length>=15?"break-word":"inherit"}}),b("React").createElement("div",{className:"_4gx_",ref:"inner"},this._renderContent(),c))},_renderContent:function(){if(!this.props.body||this.props.isEmojiLike)return null;var a={},c=null;this.state.emojis?c=b("React").createElement(b("EmojiOnlyMessage.react"),{contents:this.state.emojis}):(c=b("React").createElement(b("MercuryMessageBody.react"),{body:this.props.body,ranges:this.props.ranges,metaRanges:this.props.metaRanges,threadID:this.props.threadID,customLike:this.props.customLike,threadCustomColor:this.props.threadCustomColor,isFromViewer:this.props.isFromViewer,renderLocation:b("MercuryMessageRenderLocations").CHAT}),this.props.customColor&&(a=b("messengerCustomColorUtils").customBubbleStyle(this.props.customColor,a)));var d=this.props.message&&this.props.message.replied_to_message&&b("MessageReplyPermissions").bubbleContainsRepliedToMessage(this.props.message.replied_to_message,!!this.state.emojis)?b("React").createElement(b("ErrorBoundary.react"),null,b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("RepliedToMessageContent.react").__setRef("ChatBubble.react"),bootloadPlaceholder:b("React").createElement("div",null),isFromViewer:this.props.isFromViewer,isLinkified:!0,isMessengerUI:!1,repliedToMessage:this.props.message&&this.props.message.replied_to_message,threadID:this.props.threadID,ref:this._setRepliedToMessageRef})):null;return b("React").createElement("div",{className:"_1aa6"+(this.state.emojis?" _31xy":"")+(this.props.message&&this.props.message.isSelected?" _1yok":"")+(d?" _6e7o":""),ref:"contentWrapper",style:a},d,d?"\n":null,b("React").createElement("span",{className:"_5yl5",ref:"content"},c))},_restyleBubble:function(a){__p&&__p();if(this.props.attachments||this.props.body!=null&&b("MessengerMathUtils").isMathBlock(this.props.body.trim())){this.setState({bubbleWidth:null});return}var c=b("ReactDOM").findDOMNode(this.refs.bubble);if(a.maxWidth!==this.props.maxWidth||b("DOMDimensions").getElementDimensions(c).width>this.props.maxWidth){a=this.props.maxWidth;this.setState({bubbleWidth:a},this._shrinkBubble);return}this._shrinkBubble()},_shrinkBubble:function(){__p&&__p();var a=b("ReactDOM").findDOMNode(this.refs.bubble);a=b("DOMDimensions").getElementDimensions(a).width;var c=b("ReactDOM").findDOMNode(this.refs.content),d=b("DOMDimensions").getElementDimensions(c).width;if(this._repliedToMessageRef){var e=b("ReactDOM").findDOMNode(this._repliedToMessageRef);e=b("DOMDimensions").getElementDimensions(e).width;d=Math.max(e,d)}e=c?d+b("DOMDimensions").measureElementBox(b("ReactDOM").findDOMNode(this.refs.contentWrapper),"width",!0,!1,!1):0;c=e+h;d>0&&c<this.props.maxWidth&&a-c-this.getBoxWidth()>0&&this.setState({bubbleWidth:c})},contentWraps:function(){var a=b("ReactDOM").findDOMNode(this.refs.content);if(!a)return!1;var c=a.getClientRects();a=b("DOMDimensions").getElementDimensions(a).height;return c&&c.length>1&&c[0].height<a},_setRepliedToMessageRef:function(a){this._repliedToMessageRef=a},getBoxWidth:function(){this._boxWidth||(this._boxWidth=b("DOMDimensions").measureElementBox(b("ReactDOM").findDOMNode(this.refs.bubble),"width",!0,!0,!1));return this._boxWidth}});e.exports=c}),null);
__d("ChatCodePasteUtils",["cx","BanzaiODS","ChatBubble.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=/`{3,}/,i=3,j=/^\s+/,k=/\s+$/;function a(a){return!!(a&&h.test(a)&&a.split("\n").length>1)}function l(a,b){__p&&__p();var c=0;if(b-2>=0){c+=a[b-2].trim().length;var d=a[b-2].match(k);d&&(c+=d[0].length)}b-1>=0&&(c+=a[b-1].length+2*i);d=a[b].match(j);d&&(c+=d[0].length);return c}function m(a,b,c){if(a)return a.map(function(a){return Object.assign(Object.assign({},a),{offset:a.offset-b})}).filter(function(a){return 0<=a.offset&&a.offset<c});else return a}function c(a,c,d,e,f){__p&&__p();a=a.split(h);var g=[],i=0;for(var j=0;j<a.length;j+=2){var k=a[j].trim();if(k){i+=l(a,j);var n=d?m(d,i,k.length):d;g.push(b("React").createElement("div",{key:j,className:"_1e-x _n4o"},b("React").createElement(b("ChatBubble.react"),{body:k,customColor:f||undefined,className:"clearfix _5wdf",maxWidth:c,ranges:n||undefined,threadID:e||undefined})))}if(j+1<a.length&&a[j+1]){k=a[j+1].split("\n");n=k[0].replace(/[^a-zA-Z]+/g,"");k=k.slice(1).join("\n");b("BanzaiODS").bumpEntityKey("chat_code_paste","render_bubble");g.push(b("React").createElement("div",{key:j+1,className:"_1e-x _n4o"},b("React").createElement("div",{ref:"bubble",className:"_3_om _4yng _5wdf"},b("React").createElement("div",{style:{maxWidth:c},ref:"syntaxTarget"+j,className:"language-"+n},k))))}}return g}e.exports={containsCodeBlock:a,getCodeAndMessageBubbles:c}}),null);
__d("ChatTabBlinking",["cx","CSS","FantaTabActions","clearInterval","gkx","setIntervalAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr")?1200:600,i="highlightTitle";a={_blinkMap:{},_interval:null,_isHighlighting:!1,blinkTab:function(a,b){this._blinkMap[a]||(this._blinkMap[a]={view:b,elem:b.getTabElem()}),this.checkInterval()},unblinkTab:function(a){if(this._blinkMap[a]){var c=this._blinkMap[a].elem;c&&(b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr")?setTimeout(function(){b("FantaTabActions").unhighlightNewMessage(a)}):b("CSS").removeClass(c,i));delete this._blinkMap[a]}this.checkInterval()},checkInterval:function(){var a=Object.keys(this._blinkMap).length;a>0?this._interval||(this._interval=b("setIntervalAcrossTransitions")(this._toggleBlinkHighlight.bind(this),h)):this._interval&&(b("clearInterval")(this._interval),this._interval=null)},_toggleBlinkHighlight:function(){__p&&__p();var a=this;this._isHighlighting=!this._isHighlighting;var c=function(c){if(Object.prototype.hasOwnProperty.call(a._blinkMap,c)){var d=a._blinkMap[c],e=d.elem;d=d.view;e&&e.parentNode&&!d.isFocused()&&!d.isHovered()?b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr")?a._isHighlighting?setTimeout(function(){b("FantaTabActions").highlightNewMessage(c)}):setTimeout(function(){b("FantaTabActions").unhighlightNewMessage(c)}):b("CSS").conditionClass(e,i,a._isHighlighting):a.unblinkTab(c)}};for(var d in this._blinkMap)c(d)}};e.exports=a}),null);
__d("ChatCloseButton.react",["cx","fbt","Link.react","React","TrackingNodes","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){var a=b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.CLOSE_BUTTON),c=h._("Press Esc to close"),d=h._("Close tab"),e="_4vu4";return b("React").createElement(b("Link.react"),{"aria-label":this.props.active?c:d,className:b("joinClasses")(this.props.className,"close","button",e),"data-ft":a,"data-hover":"tooltip","data-tooltip-content":this.props.active?c:d,"data-tooltip-position":"above",onClick:this.props.onClick,onKeyUp:this.props.onKeyUp,onMouseDown:this.props.onMouseDown})};function a(){i.apply(this,arguments)}a.propTypes={onClick:c.func,onKeyUp:c.func,onMouseDown:c.func,active:c.bool};a.defaultProps={active:!1};e.exports=a}),null);
__d("ChatCollapsedLogMessageGroup.react",["cx","fbt","Link.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={collapsed:!0},b}a.prototype.render=function(){var a=h._("See Latest Activity"),c=h._("See Less Activity");return b("React").createElement("div",{className:"_5w0o"},b("React").createElement(b("Link.react"),{className:"_4ea1",onClick:function(){return this.setState({collapsed:!this.state.collapsed})}.bind(this)},this.state.collapsed?a:c),this.state.collapsed?null:b("React").createElement("div",null,b("React").createElement("div",{className:"_2zsu"}),this.props.children,b("React").createElement("div",{className:"_2zsu"})))};e.exports=a}),null);
__d("ChatDateBreak.react",["cx","React","formatDate","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.shouldComponentUpdate=function(a){"use strict";return this.props.date.getTime()!==a.date.getTime()};a.prototype.render=function(){"use strict";var a=b("formatDate")(this.props.date,{today:"g:ia",withinWeek:"D g:ia",thisYear:"M jS, g:ia",older:"m/d/Y g:ia"});return b("React").createElement("time",{className:b("joinClasses")(this.props.className,"_5w-5")},b("React").createElement("span",{className:"_5w-6"},a))};function a(){"use strict";h.apply(this,arguments)}a.propTypes={date:c.instanceOf(Date).isRequired};e.exports=a}),null);
__d("ChatMessage.react",["csx","cx","fbt","BootloadedComponent.react","ChatAnimatedGifs","ChatBubble.react","ChatCodePasteUtils","CSS","EmojiLikeUtils","FluxContainer","immutable","ImmutableObject","JSResource","Locale","MercuryAttachment","MercuryDisplayTimeFilterMessageRenderer","MercuryErrorInfo","MercuryIDs","MercuryMessageError.react","MercuryTimestamp","MessengerDecorator","MessengerInnerDecorators.react","MessengerMessage.bs","MessengerVideoAutoplayStore","MNCommerceMessageType","React","ReactDOM","TooltipData","XUISpinner.react","convertMIGColorToFIGColor","isRTL","joinClasses"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);j=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=j.constructor).call.apply(a,[this].concat(d)),this.state={isVisible:!1},this.$2=function(){return this.setState({hovered:!0})}.bind(this),this.$3=function(){return this.setState({hovered:!1})}.bind(this),b}a.getStores=function(){return[b("MessengerVideoAutoplayStore")]};a.calculateState=function(a,c){return{isVisible:b("MessengerVideoAutoplayStore").isVisible(c.message.thread_id,c.message.message_id)}};a.prototype.componentDidMount=function(){b("CSS").conditionClass(b("ReactDOM").findDOMNode(this),"_2cnu",this.isOneLine())};a.prototype.isOneLine=function(){var a=this.props.message;return b("MessengerMessage.bs").isInbound(a)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps()};a.prototype.shouldComponentUpdate=function(a,b){var c=a.message!==this.props.message,d=!1,e=!1,f=this.props.thread;if(f)d=f.custom_like_icon!==a.thread.custom_like_icon,e=f.solid_color!==a.thread.solid_color;else if(a.thread)return!0;return c||d||e||b.isVisible!==this.state.isVisible};a.prototype.render=function(){__p&&__p();var a=this.props.message,c=b("MercuryAttachment").get(a).length>0,d=b("MessengerMessage.bs").isInbound(a),e=b("MercuryIDs").isGroupChat(a.thread_id),f=b("MercuryErrorInfo").hasErrorStatus(a);c="_5wd4"+(d?" _1nc7":"")+(d?"":" _1nc6")+(c?" _2_-t":"")+(d&&e?" _5ysy":"")+(f?" _1zcs":"");var g=this.props.isFromViewer,h=[],i=a,j=this.props.thread?b("convertMIGColorToFIGColor")(this.props.thread.solid_color):"";i&&b("MessengerDecorator").getBeforeDecorators().forEach(function(a){a.check(i)&&h.push(a.render(i,g,{customColor:j}))});d=b("MercuryAttachment").get(a).filter(function(a){return!b("MercuryAttachment").isBubblePreferred(a)});e=this.$1("outside",d);return b("React").createElement("div",{className:b("joinClasses")(this.props.className,c),onMouseEnter:this.$2,onMouseLeave:this.$3},b("React").createElement("div",{className:b("joinClasses")("._1dlq","_h8t")},h,this.$4(e)),d.some(function(a){return b("MercuryAttachment").isShareAttachment(a)})?b("React").createElement(b("MessengerInnerDecorators.react"),{message:a,isFromViewer:g||!1,hovered:this.state.hovered,messageProps:this.props}):b("React").createElement("div",{className:"_40qi"}),this.$5(i,g),this.$6())};a.prototype.$4=function(a){var c=this.props.message,d={};if(b("MessengerMessage.bs").isOutbound(c)){var e=i._("{time}",[i._param("time",b("MercuryTimestamp").getPreciseTimestamp(c.timestamp))]);Object.assign(d,b("TooltipData").propsFor(e,"right"))}if(c.is_filtered_content)return b("React").createElement("div",babelHelpers["extends"]({className:"_5wd9 _5wdc uiBoxYellow clearfix",ref:"inner"},d),b("MercuryDisplayTimeFilterMessageRenderer").renderFilteredContent(c));e=c.body&&c.body!==""?b("isRTL")(c.body):b("Locale").isRTL();return b("React").createElement("div",babelHelpers["extends"]({className:"_5wd9"+(e?" direction_rtl":"")+(e?"":" direction_ltr"),ref:"inner"},d),this.$7(!a),a)};a.prototype.$5=function(a,c){__p&&__p();if(a){var d=[],e=[];b("MessengerDecorator").getAfterExternalDecorators().forEach(function(b){a&&b.check(a)&&(d.push(b.render(a,c,this.props)),e.push(b.getAdditionalClassNames()))}.bind(this));if(e.length===0&&d.length===0)return null;var f=e.join(" ");return b("React").createElement("div",{className:b("joinClasses")(f,"_5ijz"+(c?"":" isFromOther"))},d)}return null};a.prototype.$6=function(){var a=this.props.message;return a.is_filtered_content||!b("MessengerMessage.bs").hasError(a)?null:b("React").createElement("div",{className:"_3ry4",ref:"undertext"},b("React").createElement(b("MercuryMessageError.react"),{className:"_5wda clearfix",message:a,ref:"status"}),this.$8())};a.prototype.$8=function(){return this.props.message.is_spoof_warning?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("MercurySpoofWarning.react").__setRef("ChatMessage.react"),authorID:this.props.message.author,className:"_5wdb"}):null};a.prototype.$9=function(){return b("React").createElement("div",{style:{padding:"20px",text_align:"center",background:"white"}},b("React").createElement(b("XUISpinner.react"),null))};a.prototype.$1=function(a,c){__p&&__p();if(this.props.message.commerce_message_type===b("MNCommerceMessageType").RIDE_INTENT)return null;var d=this.props.message,e=this.props.thread?this.props.thread.custom_like_icon:null,f=a=="inside"?"attachmentsInside":"attachmentsOutside",g=this.props.thread?b("convertMIGColorToFIGColor")(this.props.thread.solid_color):"",h=[],i=[];a==="outside"&&d&&b("MessengerDecorator").getAfterDecorators().forEach(function(a){a.check(d,this.props.isFromViewer)&&(h.push(a.render(d,this.props.isFromViewer,this.props,this.state.hovered)),i.push(a.getAdditionalClassNames()))}.bind(this));if(c.length>0){var j=b("React").createElement(b("MessengerInnerDecorators.react"),{className:"_1z_2",message:d,isFromViewer:this.props.isFromViewer||!1,hovered:this.state.hovered,messageProps:this.props});return b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:this.$9(),bootloadLoader:b("JSResource")("MercuryAttachments.react").__setRef("ChatMessage.react"),className:b("joinClasses")((a==="outside"?"_3e7u":"")+(d.body?" _16ys":"")+(g?" _3al":"")+" _n4o"+(h?" _1a6y":""),i),attachments:c,customLike:e,customColor:g,isChat:!0,afterDecorators:h,innerDecorators:j,isVisible:this.state.isVisible,maxWidth:this.props.maxBubbleWidth,message:d,onUnwrap:this.$10,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,ref:f})}return null};a.prototype.$7=function(a){__p&&__p();var c=this.props,d=c.isFromViewer,e=c.message;c=c.thread;var f=e.body,g=b("MercuryAttachment").get(e).filter(function(a){return b("MercuryAttachment").isBubblePreferred(a)});g=this.$1("inside",g);var h=[],i=[],j=e;j&&(a&&b("MessengerDecorator").getAfterDecorators().forEach(function(a){a.check(j,d)&&(h.push(a.render(j,d,this.props)),i.push(a.getAdditionalClassNames()))}.bind(this)),b("MessengerDecorator").getBeforeDecorators().forEach(function(a){a.check(j,d)&&i.push(a.getAdditionalClassNames())}));var k=i.join(" ");b("ChatAnimatedGifs").shouldHideBody(e)&&(f="");var l=e.ranges;e.profile_ranges&&e.profile_ranges.length&&(l=(l||[]).concat(e.profile_ranges.map(function(a){return babelHelpers["extends"]({},a,{url:"/"+a.id})})));var m=b("ChatCodePasteUtils").containsCodeBlock(f);return(f||g)&&!b("EmojiLikeUtils").isEmojiLike(e)?b("React").createElement("div",{className:b("joinClasses")(k,"_1e-x _n4o")},m?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",{style:{height:22}}),bootloadLoader:b("JSResource")("ChatCodeBubble.react").__setRef("ChatMessage.react"),body:f,className:"_5wdf",maxWidth:this.props.maxBubbleWidth,ranges:l,threadID:e.thread_id,customColor:c&&d?b("convertMIGColorToFIGColor")(c.solid_color):""}):b("React").createElement("div",{className:"_3_bl"},b("React").createElement("div",{className:"_3_bp"}),b("React").createElement(b("ChatBubble.react"),{attachments:g,body:f,className:"_5wdf",isEmojiLike:!1,isFromViewer:this.props.isFromViewer,onReplyToMessage:this.props.onReplyToMessage,metaRanges:e.meta_ranges,message:e,maxWidth:this.props.maxBubbleWidth,ranges:l,ref:"bubble",threadID:e.thread_id,customLike:e.customLike,customColor:c&&d?b("convertMIGColorToFIGColor")(c.solid_color):"",threadCustomColor:c&&b("convertMIGColorToFIGColor")(c.solid_color)})),a?b("React").createElement(b("MessengerInnerDecorators.react"),{className:"_1z_2",message:e,isFromViewer:this.props.isFromViewer||!1,hovered:this.state.hovered,messageProps:this.props}):null,h):null};a.propTypes={message:c.instanceOf(b("ImmutableObject")).isRequired,maxBubbleWidth:c.number.isRequired,onAttachmentLoad:c.func,onStickerClick:c.func,participants:c.instanceOf(b("immutable").Map).isRequired,readReceipts:c.instanceOf(b("immutable").OrderedMap).isRequired,thread:c.instanceOf(b("ImmutableObject"))};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("ChatMessageGroup.react",["cx","fbt","ChatConfig","ChatDateBreak.react","ChatMessage.react","CurrentUser","Image.react","immutable","ImmutableObject","MercuryConfig","MercuryIDs","MercuryTimestamp","MessengerParticipants.bs","MessengerTextWithEmoticons.react","QE2Logger","React","ReactDOM","WorkForeignEntityType","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=b("immutable").OrderedMap;c=b("React").PropTypes;var i=new(b("ImmutableObject"))({name:"",href:"#",image_src:""}),j=b("ChatConfig").get("chattab_rounded_profile",!1);d=b("React").createClass({displayName:"ChatMessageGroup",propTypes:{activeMessageID:c.string,author:c.string,hasDateBreak:c.bool,isCanonical:c.bool,isFromViewer:c.bool,isPageMessage:c.bool,isOnline:c.bool,maxBubbleWidth:c.number,messages:c.instanceOf(b("immutable").List).isRequired,readReceipts:c.instanceOf(a).isRequired,onAttachmentLoad:c.func,onStickerClick:c.func,persona:c.object,thread:c.instanceOf(b("ImmutableObject")),threadID:c.string},getInitialState:function(){return{participants:{}}},componentDidMount:function(){b("QE2Logger").logExposureForUser("messenger_growth_tombstone"),this._subscription=this._computeParticipants()},shouldComponentUpdate:function(a,c){return this.props.isOnline!==a.isOnline||this.props.activeMessageID!==a.activeMessageID||this.props.isFromViewer!==a.isFromViewer||!b("immutable").is(this.props.messages,a.messages)||this.state.participants!==c.participants||!b("immutable").is(this.props.thread,a.thread)},componentDidUpdate:function(a){a=k(this.props);!this._subscription&&!a.every(function(a){return this.state.participants[a]}.bind(this))&&(this._subscription=this._computeParticipants())},componentWillUnmount:function(){this._subscription&&b("MessengerParticipants.bs").removeCallback(this._subscription)},render:function(){return b("React").createElement("div",{className:"_4tdt"+(this.props.isFromViewer?" _ua0":"")+(this.props.isFromViewer?"":" _ua1")+(this._hasSeenHeadsAtBottom()?" _3lil":"")},this._renderProfileColumn(),b("React").createElement("div",{className:"_ua2"},this._renderName(),b("React").createElement("div",{className:"_4tdv"},this._renderMessages())))},_renderProfileColumn:function(){__p&&__p();var a;if(this.props.isFromViewer)return null;var c=this.state.participants[this.props.author]||i;if(b("gkx")("AT4vZBWyiZL1KZrir2lJt4vVNMIYu8sDbA3PtNwJWZh5seJSYZeYdmCgqH3wgiUS4PfslnEPm3wz9jSsjDINBCSy")&&this.props.isCanonical&&!this.props.persona&&!c.is_messenger_platform_bot)return null;var d=c.name,e=c.image_src;this.props.persona&&(d=this.props.persona.name,e=this.props.persona.profile_picture_url);d=h._("{name} {time}",[h._param("name",d),h._param("time",b("MercuryTimestamp").getPreciseTimestamp(this.props.messages.last().timestamp))]);e=e?b("React").createElement(b("Image.react"),{src:e}):null;var f=b("MercuryConfig").GDWC&&this.props.isOnline;a=b("CurrentUser").isWorkUser()&&((a=c)!=null?(a=a.work_foreign_entity_info)!=null?a.type:a:a)===b("WorkForeignEntityType").FOREIGN;return b("React").createElement("div",{className:"_31o4"+(j?" _3njy":"")},b("React").createElement("a",{"aria-label":d,className:"_4tdw","data-hover":"tooltip","data-tooltip-content":d,"data-tooltip-position":"left",href:this.props.persona?null:c.href,ref:"link"},e),a?b("React").createElement("div",{className:"_4rwx _4rwy"}):f?b("React").createElement("div",{className:"_sce"}):null)},_renderName:function(){__p&&__p();if(this.props.isCanonical&&!this.props.persona||this.props.isFromViewer)return null;var a=this.state.participants[this.props.messages.first().author];if(!a)return null;if(this.props.messages.first().replied_to_message)return null;var c=a.short_name;if(this.props.thread&&this.props.thread.custom_nickname){a=b("MercuryIDs").getUserIDFromParticipantID(a.id);this.props.thread.custom_nickname[a]&&(c=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:this.props.thread.custom_nickname[a]}))}if(this.props.persona){a=this.state.participants[this.props.messages.first().author];c=a?h._("{persona name} from {page name}",[h._param("persona name",this.props.persona.name),h._param("page name",a.short_name)]):this.props.persona.name}return b("React").createElement("div",{className:"_4tdx"},c)},_renderMessages:function(){var a=this.props.messages.size,c=[];this.props.messages.forEach(function(d,e,f){var g=d.message_id===this.props.activeMessageID;g&&!(e===0&&this.props.hasDateBreak)&&c.push(b("React").createElement(b("ChatDateBreak.react"),{date:new Date(d.timestamp),key:"db:"+d.message_id}));c.push(b("React").createElement(b("ChatMessage.react"),{isFromViewer:this.props.isFromViewer,key:d.message_id,maxBubbleWidth:this.props.maxBubbleWidth,message:d,participants:b("immutable").Map(this.state.participants),readReceipts:this.props.readReceipts,ref:d.message_id,nextTimestamp:this._getNextTimestamp(f,a,e),onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,thread:this.props.thread}))}.bind(this));return c},_hasSeenHeadsAtBottom:function(){var a=this.props,b=a.messages,c=a.nextTimestamp;a=a.readReceipts;var d=b.last().timestamp,e=0;a.forEach(function(a){return a>=d&&a<c&&++e===2?!1:null});return e===2},_getNextTimestamp:function(a,b,c){return c<b-1?a.get(c+1).timestamp:this.props.nextTimestamp},getMessageElement:function(a){return b("ReactDOM").findDOMNode(this.refs[a])},_computeParticipants:function(){__p&&__p();var a=k(this.props),c={},d=[];a.forEach(function(a){var e=b("MessengerParticipants.bs").getNow(a);c[a]=e;e||d.push(a)});this.setState({participants:c});return d.length>0?b("MessengerParticipants.bs").getMulti(d,function(b){var a=this.state.participants;d.forEach(function(c){a[c]=b[c]});this._subscription=null;this.setState({participants:a})}.bind(this)):null}});function k(a){var b=[a.author];a.readReceipts.forEach(function(a,c){b.push(c)});return b}e.exports=d}),null);
__d("MercuryMessageRendererUtils",["cx","invariant","HovercardLink","MercuryViewer","MessengerTextWithEmoticons.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a={getLinkToParticipant:function(a,c){var d=a.fbid,e=b("HovercardLink").constructEndpoint({id:d});c=c&&c.custom_nickname&&c.custom_nickname[d];c&&(c=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:c}));d=c?c:a.name;return a.href?b("React").createElement("a",{className:"_5wzt",href:a.href,"data-hovercard":e},d):d},moveCurrentUserToFront:function(a){a===void 0&&(a=[]);a||h(0);var c=a.indexOf(b("MercuryViewer").getID());if(c>0){c=a.filter(function(a){return a!==b("MercuryViewer").getID()});return[b("MercuryViewer").getID()].concat(c)}return a}};e.exports=a}),null);
__d("MercuryLogMessageRenderer",["cx","fbt","invariant","ix","Bootloader","CSS","CurrentUser","Image.react","MercuryAttachmentViewer","MercuryLogMessageType","MercuryMessageRendererUtils","MercuryViewer","MessagingSourceEnum","MessengerAdminGroupUtils","MessengerLightweightActionUtils","MessengerParticipants.bs","MessengerState.bs","MessengerTextWithEmoticons.react","React","ReactDOM","TooltipLink.react","UserAgent","convertMIGColorToFIGColor"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();a={renderText:function(a,c,d,e){__p&&__p();c=c||b("MessengerState.bs").getThreadMetaNow(b("CurrentUser").getID(),a.thread_id);if(b("MessengerLightweightActionUtils").isLWAMessage(a)){e(b("MessengerLightweightActionUtils").getCollapsedLWAText(a));return}switch(a.log_message_type){case b("MercuryLogMessageType").SUBSCRIBE:var f=a.author;a.log_message_data||i(0);var g=a.log_message_data.added_participants;g||i(0);f=g.length===1&&f===g[0];g=c&&b("MessengerAdminGroupUtils").isWorkGroupSyncedChat(c)&&b("MessengerAdminGroupUtils").isWorkSyncedChatThreadMemberSyncMessage(a);f||g?b("Bootloader").loadModules(["MercuryJoinableMessageRenderer"],function(b){b.renderText(a,c,e)},"MercuryLogMessageRenderer"):m(a,e);break;case b("MercuryLogMessageType").UNSUBSCRIBE:b("MessengerAdminGroupUtils").isJoinableThread(c)?b("MessengerAdminGroupUtils").isGroupChat(c)?A(a,e):s(a,e):r(a,e);break;case b("MercuryLogMessageType").THREAD_NAME:c&&b("MessengerAdminGroupUtils").isWorkGroupSyncedChat(c)&&b("MessengerAdminGroupUtils").isWorkSyncedChatThreadCreationMessage(a)?v(a,e):c&&b("MessengerAdminGroupUtils").isJoinableThread(c)?b("MessengerAdminGroupUtils").isGroupChat(c)?B(a,c,e):t(a,c,e):w(a,c,e);break;case b("MercuryLogMessageType").THREAD_IMAGE:c&&b("MessengerAdminGroupUtils").isJoinableThread(c)?b("MessengerAdminGroupUtils").isGroupChat(c)?C(a,c,e):x(a,c,e):y(a,c,e);break;case b("MercuryLogMessageType").WALLPAPER:z(a,e);break;case b("MercuryLogMessageType").GENERIC_ADMIN_TEXT:var h=b("convertMIGColorToFIGColor")(c&&c.solid_color);b("Bootloader").loadModules(["MercuryXMATRenderer"],function(b){e(b.renderText(h,a,d))},"MercuryLogMessageRenderer");break;default:b("Bootloader").loadModules(["MercurySpecialLogMessageRenderer"],function(b){b.renderText(a,e)},"MercuryLogMessageRenderer");break}},renderIcon:function(a){return b("React").createElement(b("Image.react"),{className:k(a.log_message_type,a.log_message_data),src:j("99239")})},renderLegacy:function(a,c,d,e){k(e.log_message_type,e.log_message_data).split(" ").forEach(function(c){return c&&b("CSS").addClass(a,c)}),this.renderText(e,null,!1,function(a){b("ReactDOM").render(b("React").createElement("span",null,a),c)}),this.renderAttachmentLegacy(d,e)},renderAttachmentLegacy:function(a,c){if(c.log_message_type===b("MercuryLogMessageType").THREAD_IMAGE){c.log_message_data||i(0);var d=c.log_message_data.image;d&&d.preview_url&&(b("ReactDOM").render(b("React").createElement(b("Image.react"),{className:"_z6a",onClick:function(){return l(d)},src:d.preview_url}),a),b("CSS").show(a))}}};e.exports=a;function k(a,c){c=!!(c&&c.answered);return"_5wzu"+(a===b("MercuryLogMessageType").SUBSCRIBE?" _5wzj":"")+(a===b("MercuryLogMessageType").UNSUBSCRIBE?" _5wzk":"")+(a===b("MercuryLogMessageType").THREAD_NAME?" _5wzl":"")+(a===b("MercuryLogMessageType").THREAD_IMAGE?" _5wzm":"")+(a===b("MercuryLogMessageType").VIDEO_CALL&&c?" _5wzn":"")+(a===b("MercuryLogMessageType").VIDEO_CALL&&!c?" _5wzo":"")+(a===b("MercuryLogMessageType").PHONE_CALL&&c?" _5wzp":"")+(a===b("MercuryLogMessageType").PHONE_CALL&&!c?" _5wzq":"")+(a===b("MercuryLogMessageType").SERVER_ERROR?" _5wzr":"")+(a?"":" _2r5l")}function l(a){b("MercuryAttachmentViewer").bootstrapWithConfig({src:a.preview_url,endpoint:a.url,fbid:a.metadata.fbid,dimensions:a.metadata.dimensions,disablePaging:!0},null)}function m(a,c){__p&&__p();a.log_message_data||i(0);var d=b("MercuryMessageRendererUtils").moveCurrentUserToFront(a.log_message_data.added_participants);d||i(0);switch(d.length){case 1:n(a,c,d);break;case 2:o(a,c,d);break;case 3:p(a,c,d);break;default:q(a,c,d);break}}function n(a,c,d){var e=[a.author,d[0]];b("MessengerParticipants.bs").getMulti(e,function(e){a.author===b("MercuryViewer").getID()?c(h._("You added {subscriber1}.",[h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]]))])):d[0]===b("MercuryViewer").getID()?c(h._("{actor} added you.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author]))])):c(h._("{actor} added {subscriber1}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]]))]))})}function o(a,c,d){var e=[a.author].concat(d);b("MessengerParticipants.bs").getMulti(e,function(e){a.author===b("MercuryViewer").getID()?c(h._("You added {subscriber1} and {subscriber2}.",[h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]]))])):d[0]===b("MercuryViewer").getID()?c(h._("{actor} added you and {subscriber2}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]]))])):c(h._("{actor} added {subscriber1} and {subscriber2}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]]))]))})}function p(a,c,d){var e=[a.author].concat(d);b("MessengerParticipants.bs").getMulti(e,function(e){a.author===b("MercuryViewer").getID()?c(h._("You added {subscriber1}, {subscriber2} and {subscriber3}.",[h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]])),h._param("subscriber3",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[2]]))])):d[0]===b("MercuryViewer").getID()?c(h._("{actor} added you, {subscriber2} and {subscriber3}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]])),h._param("subscriber3",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[2]]))])):c(h._("{actor} added {subscriber1}, {subscriber2} and {subscriber3}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]])),h._param("subscriber3",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[2]]))]))})}function q(a,c,d){var e=[a.author].concat(d);b("MessengerParticipants.bs").getMulti(e,function(e){function f(a){var c=b("React").createElement("div",null,a.map(function(a){return b("React").createElement("div",null,a.name)}));return b("React").createElement(b("TooltipLink.react"),{alignH:"center",position:"above",tooltip:c},h._({"*":"{num} more"},[h._param("num",a.length,[0])]))}var g=d.map(function(a){return e[a]});a.author===b("MercuryViewer").getID()?c(h._("You added {subscriber1}, {subscriber2} and {more_people}.",[h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(g[0])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(g[1])),h._param("more_people",f(g.slice(2)))])):d[0]===b("MercuryViewer").getID()?c(h._("{actor} added you, {subscriber2} and {more_people}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(g[1])),h._param("more_people",f(g.slice(2)))])):c(h._("{actor} added {subscriber1}, {subscriber2} and {more_people}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(g[0])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(g[1])),h._param("more_people",f(g.slice(2)))]))})}function r(a,c){__p&&__p();var d=[a.author];a.log_message_data||i(0);var e=a.log_message_data.removed_participants;e||i(0);var f;e.length===1&&(f=e[0],d.push(f));b("MessengerParticipants.bs").getMulti(d,function(d){var e=d[a.author];d=d[f];a.author===b("MercuryViewer").getID()?!f||f===a.author?c(h._("You left the conversation.")):c(h._("You removed {name} from the conversation.",[h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))])):!f||f===a.author?c(h._("{actor} left the conversation.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):f===b("MercuryViewer").getID()?c(h._("{actor} removed you from the conversation.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):c(h._("{actor} removed {name} from the conversation.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e)),h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))]))})}function s(a,c){__p&&__p();var d=[a.author];a.log_message_data||i(0);var e=a.log_message_data.removed_participants;e||i(0);var f;e.length===1&&(f=e[0],d.push(f));b("MessengerParticipants.bs").getMulti(d,function(d){var e=d[a.author];d=d[f];a.author===b("MercuryViewer").getID()?!f||f===a.author?c(h._("You left the room.")):c(h._("You removed {name} from the room.",[h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))])):!f||f===a.author?c(h._("{actor} left the room.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):f===b("MercuryViewer").getID()?c(h._("{actor} removed you from the room.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):c(h._("{actor} removed {name} from the room.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e)),h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))]))})}function t(a,c,d){__p&&__p();a.log_message_data||i(0);var e=a.log_message_data.name,f="_5wzs"+(b("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(a.author===b("MercuryViewer").getID())if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("You named the room: {name}.",[h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("You removed the room name."));else b("MessengerParticipants.bs").get(a.author,function(a){a=b("MercuryMessageRendererUtils").getLinkToParticipant(a,c);if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("{actor} named the room: {name}.",[h._param("actor",a),h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("{actor} removed the room name.",[h._param("actor",a)]))})}function u(a,c,d,e,f){a.author===b("MercuryViewer").getID()?f(h._("You named the group {thread_name}. Your group is also on Facebook.",[h._param("thread_name",b("React").createElement("span",{className:e},b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:d})))])):b("MessengerParticipants.bs").get(a.author,function(a){a=b("MercuryMessageRendererUtils").getLinkToParticipant(a,c);f(h._("{actor} named the group {thread_name}. Your group is also on Facebook.",[h._param("actor",a),h._param("thread_name",b("React").createElement("span",{className:e},b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:d})))]))})}function v(a,c){a.log_message_data||i(0);a=a.log_message_data.name;var d="_5wzs"+(b("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(a){c(h._("You can now chat to {name} on Workplace Chat.",[h._param("name",b("React").createElement("span",{className:d},b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:a})))]));return}}function w(a,c,d){__p&&__p();a.log_message_data||i(0);var e=a.log_message_data.name,f="_5wzs"+(b("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(e&&a.tags&&a.tags.indexOf(b("MessagingSourceEnum").EVENT_UPCOMING_BUMP)!==-1)d(h._("The group has been named {name}.",[h._param("name",b("React").createElement("span",{className:f},b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e})))]));else if(e&&a.tags&&a.tags.indexOf(b("MessagingSourceEnum").GROUPSYNC_NAMING)!==-1)u(a,c,e,f,d);else if(a.author===b("MercuryViewer").getID())if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("You named the conversation: {name}.",[h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("You removed the conversation name."));else b("MessengerParticipants.bs").get(a.author,function(a){a=b("MercuryMessageRendererUtils").getLinkToParticipant(a,c);if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("{actor} named the conversation: {name}.",[h._param("actor",a),h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("{actor} removed the conversation name.",[h._param("actor",a)]))})}function x(a,c,d){a.author===b("MercuryViewer").getID()?(a.log_message_data||i(0),a.log_message_data.image?d(h._("You changed the room picture.")):d(h._("You removed the room picture."))):b("MessengerParticipants.bs").get(a.author,function(e){e=b("MercuryMessageRendererUtils").getLinkToParticipant(e,c);a.log_message_data||i(0);a.log_message_data.image?d(h._("{actor} changed the room picture.",[h._param("actor",e)])):d(h._("{actor} removed the room picture.",[h._param("actor",e)]))})}function y(a,c,d){a.tags!==undefined&&a.tags.indexOf(b("MessagingSourceEnum").EVENT_UPCOMING_BUMP)!==-1?d(h._("The conversation picture has been set.")):a.author===b("MercuryViewer").getID()?(a.log_message_data||i(0),a.log_message_data.image?d(h._("You changed the conversation picture.")):d(h._("You removed the conversation picture."))):b("MessengerParticipants.bs").get(a.author,function(e){e=b("MercuryMessageRendererUtils").getLinkToParticipant(e,c);a.log_message_data||i(0);a.log_message_data.image?d(h._("{actor} changed the conversation picture.",[h._param("actor",e)])):d(h._("{actor} removed the conversation picture.",[h._param("actor",e)]))})}function z(a,c){a.author===b("MercuryViewer").getID()?c(h._("You changed the wallpaper.")):b("MessengerParticipants.bs").get(a.author,function(a){a=b("MercuryMessageRendererUtils").getLinkToParticipant(a);c(h._("{actor} changed the wallpaper.",[h._param("actor",a)]))})}function A(a,c){__p&&__p();var d=[a.author];a.log_message_data||i(0);var e=a.log_message_data.removed_participants;e||i(0);var f;e.length===1&&(f=e[0],d.push(f));b("MessengerParticipants.bs").getMulti(d,function(d){var e=d[a.author];d=d[f];a.author===b("MercuryViewer").getID()?!f||f===a.author?c(h._("You left the chat.")):c(h._("You removed {name} from the chat.",[h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))])):!f||f===a.author?c(h._("{actor} left the chat.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):f===b("MercuryViewer").getID()?c(h._("{actor} removed you from the chat.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):c(h._("{actor} removed {name} from the chat.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e)),h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))]))})}function B(a,c,d){__p&&__p();a.log_message_data||i(0);var e=a.log_message_data.name,f="_5wzs"+(b("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(a.author===b("MercuryViewer").getID())if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("You named the chat: {name}.",[h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("You removed the chat name."));else b("MessengerParticipants.bs").get(a.author,function(a){a=b("MercuryMessageRendererUtils").getLinkToParticipant(a,c);if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("{actor} named the chat: {name}.",[h._param("actor",a),h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("{actor} removed the chat name.",[h._param("actor",a)]))})}function C(a,c,d){a.author===b("MercuryViewer").getID()?(a.log_message_data||i(0),a.log_message_data.image?d(h._("You changed the chat picture.")):d(h._("You removed the chat picture."))):b("MessengerParticipants.bs").get(a.author,function(e){e=b("MercuryMessageRendererUtils").getLinkToParticipant(e,c);a.log_message_data||i(0);a.log_message_data.image?d(h._("{actor} changed the chat picture.",[h._param("actor",e)])):d(h._("{actor} removed the chat picture.",[h._param("actor",e)]))})}}),null);
__d("MercuryLogMessage.react",["cx","fbt","DOM","DOMDimensions","Event","EventReminderRequestHelper","ImmutableObject","MercuryLogMessageRenderer","MercuryLogMessageType","MessagingGenericAdminTextType","React","ReactDOM","ShimButton.react","cancelAnimationFrame","emptyFunction","formatDate","joinClasses","requestAnimationFrame","requireWeak"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;var j=266;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={messageText:null,showEventReminderFlyout:!1},this.$4=function(){this.$5()}.bind(this),this.$9=function(){var a;a=(a=this.props.message)!=null?(a=a.log_message_data)!=null?(a=a.untypedData)!=null?a.event_id:a:a:a;!this.state.showEventReminderFlyout&&a?b("EventReminderRequestHelper").fetchEventReminder(this.props.thread.thread_id,a,function(){this.$1&&this.setState({showEventReminderFlyout:!0})}.bind(this)):this.setState({showEventReminderFlyout:!1})}.bind(this),this.$11=function(a){a!==this.state.showEventReminderFlyout&&this.setState({showEventReminderFlyout:a})}.bind(this),c}a.prototype.componentDidMount=function(){this.$1=!0,this.UNSAFE_componentWillReceiveProps(this.props)};a.prototype.componentWillUnmount=function(){this.$1=!1,this.$2&&b("cancelAnimationFrame")(this.$2)};a.prototype.$3=function(){return b("React").createElement(b("ShimButton.react"),{form:"link",onClick:this.$4},h._("Show previous messages."))};a.prototype.$5=function(){var a=this.props.loadMoreMessages&&this.props.loadMoreMessages();if(!this.$1)return;if(a)this.setState({messageText:this.$3()});else{a=h._("Couldn't find previous messages.");this.setState({messageText:a})}};a.prototype.UNSAFE_componentWillReceiveProps=function(a){if(a.message.log_message_type===b("MercuryLogMessageType").SERVER_ERROR)return;b("MercuryLogMessageRenderer").renderText(a.message,a.thread,a.isLastOfType,function(a){this.$1&&this.setState({messageText:a})}.bind(this))};a.prototype.shouldComponentUpdate=function(a,b){return this.state.messageText!=b.messageText||a.maxWidth!==this.props.maxWidth||this.state.showEventReminderFlyout!==b.showEventReminderFlyout};a.prototype.componentDidUpdate=function(){this.$6();if(!this.refs.attachment)return;b("MercuryLogMessageRenderer").renderAttachmentLegacy(this.refs.attachment,this.props.message);b("DOM").scry(this.refs.wrap,"img").forEach(function(a){var c=b("Event").listen(a,"load",function(){this.$6(),c.remove()}.bind(this))}.bind(this))};a.prototype.render=function(){return b("React").createElement("div",babelHelpers["extends"]({},this.props,{className:b("joinClasses")(this.props.className,"_5ye6"),ref:"wrap",style:babelHelpers["extends"]({},this.props.style,this.$7()),title:b("formatDate")(new Date(this.props.message.timestamp),"g:ia")}),b("React").createElement("div",{className:"_5ye7"},b("MercuryLogMessageRenderer").renderIcon(this.props.message),this.state.messageText),b("React").createElement("div",{className:"_5ye8",ref:"attachment"},this.$8()))};a.prototype.$8=function(){__p&&__p();var a;if(this.props.thread&&!this.props.thread.lightweight_event||!this.props.message.log_message_data)return null;if(!this.props.event||!this.props.event.exists)return null;a=(a=this.props.message)!=null?(a=a.log_message_data)!=null?(a=a.untypedData)!=null?a.event_time:a:a:a;if(!a)return null;typeof a==="string"&&(a=parseInt(a,10));if(a<=Math.floor(Date.now()/1e3))return null;var c;b("requireWeak")("Link.react",function(a){c=a});var d;switch(this.props.message.log_message_data.message_type){case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_CREATE:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TIME:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TITLE:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_LOCATION:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE:d=h._("Change");break;default:d=null}a=b("React").createElement(c,{href:"#",onClick:this.$9,title:h._("Edit Event"),ref:"event_rem_link"},d);this.props.displayItems&&(a=null);return b("React").createElement("span",null,a,this.$10())};a.prototype.$10=function(){__p&&__p();var a;if(!this.state.showEventReminderFlyout)return null;var c="right",d=b("ReactDOM").findDOMNode(this.refs.wrap);d&&d instanceof Element&&d.getBoundingClientRect().left<j&&(c="left");d={alignment:c,position:"above",contextRef:function(){return this.refs.event_rem_link}.bind(this),shown:this.state.showEventReminderFlyout,onToggle:this.$11};var e;b("requireWeak")("EventsActionsLogger",function(a){e=a});c={action_history:[{surface:e.Surface.MESSENGER_CHAT_TAB,mechanism:e.Mechanism.REMINDER_ADMIN_TEXT}]};a=(a=this.props.message)!=null?(a=a.log_message_data)!=null?(a=a.untypedData)!=null?a.event_id:a:a:a;a={threadID:this.props.thread.thread_id,eventID:a,dialogProps:d,flyoutNoSheet:!0,isEditing:!0,actionContext:c};var f;b("requireWeak")("ChatEventReminderContainer.react",function(a){f=a});return b("React").createElement(f,a)};a.prototype.$7=function(){return this.props.maxWidth?{maxWidth:this.props.maxWidth}:null};a.prototype.$6=function(){this.$2&&b("cancelAnimationFrame")(this.$2);if(!this.$1)return;this.$2=b("requestAnimationFrame")(function(){this.props.onImageLoad&&this.props.onImageLoad(b("DOMDimensions").getElementDimensions(this.refs.wrap).height),delete this.$2}.bind(this))};a.propTypes={loadMoreMessages:c.func,maxWidth:c.number,message:c.instanceOf(b("ImmutableObject")).isRequired,onImageLoad:c.func,thread:c.object,isLastOfType:c.bool.isRequired,event:c.object};a.defaultProps={onImageLoad:b("emptyFunction")};e.exports=a}),null);
__d("MercuryLogMessageContainer.react",["EventReminderStateStore","FluxContainer","MercuryLogMessage.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("EventReminderStateStore")]};a.calculateState=function(a,c){a=(a=c.message)!=null?(a=a.log_message_data)!=null?(a=a.untypedData)!=null?a.event_id:a:a:a;return{event:b("EventReminderStateStore").getEvent(c.thread?c.thread.thread_id:"",a)}};a.prototype.render=function(){return b("React").createElement(b("MercuryLogMessage.react"),{className:this.props.className,onLogMessageExpanded:this.props.onLogMessageExpanded,loadMoreMessages:this.props.loadMoreMessages,message:this.props.message,onImageLoad:this.props.onImageLoad,viewer:this.props.viewer,isPageMessage:this.props.isPageMessage,thread:this.props.thread,isLastOfType:this.props.isLastOfType,event:this.state.event})};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("ChatConversation.react",["ChatCollapsedLogMessageGroup.react","ChatDateBreak.react","ChatMessageGroup.react","immutable","MercuryIDs","MercuryLogMessageContainer.react","MercuryShareAttachmentRenderLocations","MessageList.react","MessengerReadReceipt.bs","React","cancelAnimationFrame","requestAnimationFrame"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("immutable").OrderedMap;a=b("React").PropTypes;c=b("React").createClass({displayName:"ChatConversation",_raf:undefined,_onMountTimeout:undefined,propTypes:{contextBanner:a.object,isCanonical:a.bool.isRequired,loadMoreMessages:a.func,maxBubbleWidth:a.number.isRequired,messages:a.instanceOf(b("immutable").List).isRequired,onAttachmentLoad:a.func,onMount:a.func,onlineUsers:a.instanceOf(b("immutable").List).isRequired,onStickerClick:a.func,viewer:a.string.isRequired,thread:a.object,threadID:a.string.isRequired},componentDidMount:function(){this._raf=b("requestAnimationFrame")(function(){this._onMountTimeout=setTimeout(function(){this.props.onMount&&this.props.onMount(),delete this._onMountTimeout}.bind(this),0),delete this._raf}.bind(this))},componentWillUnmount:function(){this._raf&&b("cancelAnimationFrame")(this._raf),clearTimeout(this._onMountTimeout)},render:function(){return b("React").createElement("div",null,this.props.contextBanner,b("React").createElement(b("MessageList.react"),{DateBreak:b("ChatDateBreak.react"),LogMessage:b("MercuryLogMessageContainer.react"),MessageGroup:b("ChatMessageGroup.react"),deliveryTimestamp:0,isCanonical:this.props.isCanonical,location:b("MercuryShareAttachmentRenderLocations").CHAT,loadMoreMessages:this.props.loadMoreMessages,maxBubbleWidth:this.props.maxBubbleWidth,CollapsedLogMessageGroup:b("ChatCollapsedLogMessageGroup.react"),messages:this.props.messages,onAttachmentLoad:this.props.onAttachmentLoad,onlineUsers:this.props.onlineUsers,onStickerClick:this.props.onStickerClick,readReceipts:this._calculateReceipts(this.props),ref:"messageList",viewer:this.props.viewer,thread:this.props.thread,threadID:this.props.threadID}))},_calculateReceipts:function(a){__p&&__p();var c=b("MercuryIDs").getParticipantIDFromUserID(a.viewer),d=b("MessengerReadReceipt.bs").getSeenTimestamps(a.readReceipts,a.threadID),e=new Set(a.thread?a.thread.participants:d.keys());e["delete"](c);return d.withMutations(function(c){b("immutable").Seq(a.messages).reverse().forEach(function(a){if(e.size===0)return!1;if(!e.has(a.author))return null;c.update(a.author,function(b){return!b||b.watermark<=a.timestamp?{watermark:a.timestamp,action:a.timestamp}:b});e["delete"](a.author);return null})})},getMessageList:function(){return this.refs.messageList}});e.exports=c}),null);
__d("ChatDetailStack.react",["cx","React"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c=a.bottomDetail;a=a.topDetail;c=c?b("React").createElement("div",{className:"_4jeh"},c):null;return b("React").createElement("div",{className:"_2rt2"},b("React").createElement("div",{className:"_4jeg"},a),c)}e.exports=a}),null);
__d("ChatEditParticipantsUtils",["AsyncDialog","AsyncRequest","MercuryIDs","MercuryThreadIDMap","URI"],(function(a,b,c,d,e,f){"use strict";var g=b("MercuryThreadIDMap").get();a={showParticipantsModal:function(a){if(!b("MercuryIDs").isGroupChat(a))return;g.getServerIDFromClientID(a,function(a){b("AsyncDialog").send(new(b("AsyncRequest"))(new(b("URI"))("/ajax/browser/dialog/multichat_members/").addQueryData({id:a})))})}};e.exports=a}),null);
__d("ChatTabComposerContainer.react",["cx","fbt","Bootloader","ChatComposer","ChatConfig","FantaMessageActions","FantaTypeComposer","MercuryIDs","MercuryMessageActions","MercuryShareAttachmentRenderLocations","MessengerBotMenuDataFetcher","MessengerParticipants.bs","MessengerState.bs","MNCommercePageSetting","P2PGKValues","React","ReactComponentWithPureRenderMixin","ReactDOM","SimpleXUIDialog","getPageIDFromThreadID","getThreadTypeNameFromThreadType","setImmediate"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("ChatComposer").ChatComposer,j="right";a=b("React").PropTypes;var k=b("ChatConfig").get("single_line_composer"),l=140,m=90;c=b("React").createClass({displayName:"ChatTabComposerContainer",_participantSubscription:null,mixins:[b("ReactComponentWithPureRenderMixin")],propTypes:{composer:a.object.isRequired,disableInput:a.bool.isRequired,fileUploader:a.object,handleSend:a.func,inputKeyDown:a.func,isFocused:a.bool,onEscape:a.func,onFileUploadFail:a.func,onPhotoUploadFail:a.func,onStickerSelect:a.func,onTab:a.func,onUploadCancel:a.func,onUploadComplete:a.func,onUploadSubmit:a.func,thread:a.any,threadID:a.string,viewer:a.string.isRequired},_inputRef:null,_photoUploader:null,_setTextImmediate:null,_singleLineComposerRef:null,getInitialState:function(){return{participants:[],showP2PButton:this._getShowP2PButton(),pageID:b("getPageIDFromThreadID")(this.props.threadID),showStructuredMenu:this._getShowStructuredMenu(),longInput:!1}},componentDidMount:function(){this.props.onMount(this),this.state.pageID&&b("MessengerBotMenuDataFetcher").getHasPageSetting(this.state.pageID,function(a){this.setState({showStructuredMenu:a})}.bind(this),function(){this.setState({showStructuredMenu:!1})}.bind(this),b("MNCommercePageSetting").STRUCTURED_MENU_ENABLED),this.setState({participants:this._computeParticipants()})},componentDidUpdate:function(a){var b=this.props.thread;b=b?b.thread_id:null;if(b===this.props.threadID){this.props.fileUploader!==a.fileUploader&&this._handleComposerHeightMayChange();return}this.setState({participants:this._computeParticipants()})},componentWillUnmount:function(){this._participantSubscription&&b("MessengerParticipants.bs").removeCallback(this._participantSubscription)},_computeParticipants:function(){__p&&__p();var a=this.props.thread;if(!a)return[];var c=[],d=[];a.participants.forEach(function(a){var e=b("MessengerParticipants.bs").getNow(a);e?d.push(e):c.push(a)});c.length>0&&(this._participantSubscription&&b("MessengerParticipants.bs").removeCallback(this._participantSubscription),this._participantSubscription=b("MessengerParticipants.bs").getMulti(c,function(b){this._participantSubscription=null,this.setState({participants:a.participants.map(function(a){return b[a]})})}.bind(this)));return d},_getShowP2PButton:function(){return b("P2PGKValues").P2PVisible&&this.props.viewer!==b("MercuryIDs").getUserIDFromThreadID(this.props.threadID)},_getShowStructuredMenu:function(){var a=b("getPageIDFromThreadID")(this.props.threadID);return a===null||a===undefined?!1:b("MessengerBotMenuDataFetcher").getHasPageSetting(a,function(){},function(){},b("MNCommercePageSetting").STRUCTURED_MENU_ENABLED)},render:function(){var a=this.props.composer,c=this.props.threadID;c=c?b("MessengerState.bs").isEmptyLocalThread(this.props.viewer,c):!1;return k?b("React").createElement(i,{composer:a,fileUploader:this.props.fileUploader,handleSend:this.props.handleSend,handleSendClick:this._handleSendClick,inputRef:function(a){return this._inputRef=a}.bind(this),isEmptyLocalThread:c,isFocused:this.props.isFocused,defaultText:a.text,onEmojiSelect:this._handleEmojiSelect,onEscape:this._handleEscape,onInputKeyDown:this._handleInputKeyDown,onTab:this.props.onTab,onTextChange:this._onTextChange,onUploaderMount:function(a){return this._photoUploader=a}.bind(this),pageID:this.state.pageID,participantIDs:undefined,participants:this.state.participants,disableInput:this.props.disableInput,showP2PButton:this.state.showP2PButton,showStructuredMenu:this.state.showStructuredMenu,thread:this.props.thread,threadID:this.props.threadID,uploadPhotoFn:function(a){this._photoUploader&&this._photoUploader.uploadFiles([].concat(a))}.bind(this),viewer:this.props.viewer,focusInput:this.focusInput,longInput:this.state.longInput,ref:function(a){return this._singleLineComposerRef=a}.bind(this)}):b("React").createElement(i,babelHelpers["extends"]({composer:this.props.composer,defaultText:a.text,fileUploader:this.props.fileUploader,fileUploaderProps:this._getFileUploaderProps(),handleSendClick:this._handleSendClick,isEmptyLocalThread:c,ref:"composer",thread:this.props.thread},this.props,{disableInput:this.props.disableInput,onTextChange:this._onTextChange,p2pProps:this._getP2PProps(),pageID:this.state.pageID,participantIDs:undefined,participants:this.state.participants,photoUploaderProps:this._getPhotoUploaderProps(),showP2PButton:this.state.showP2PButton,showStructuredMenu:this.state.showStructuredMenu,stickerButtonProps:this._getStickerButtonProps()}))},onSend:function(a){if(a&&a.profile_ranges&&a.profile_ranges.length){var c=a,d=this.props.thread,e=this.state.participants;b("Bootloader").loadModules(["MessengerMentionsTypedLogger","MessengerMentionsLoggerEvents"],function(a,f){new a().setEvent(f.MENTION).setGroupSize(e&&e.length).setNumDelivered((c.profile_ranges||[]).length).setThreadid(d&&d.thread_id).setThreadType(b("getThreadTypeNameFromThreadType")(d&&d.thread_type)).setOfflineThreadid(c.offline_threading_id).log()},"ChatTabComposerContainer.react")}k?this._inputRef&&this._inputRef.onSend&&this._inputRef.onSend(a):this.refs.composer&&this.refs.composer.onSend(a)},getInput:function(){return k?this._inputRef:this.refs.composer&&this.refs.composer.getInput&&this.refs.composer.getInput()},focusInput:function(){var a=this.getInput();a&&a.focus&&a.focus()},isUploading:function(){return this.refs.composer.isUploading()},_handleSendClick:function(a){a=this.getInput();a&&typeof a.handleSend==="function"&&(a&&a.handleSend())},_getP2PProps:function(){return!this.state.showP2PButton?{}:{button:b("React").createElement("i",{className:"hidden_elem"}),className:"_6ga _6gb",flyoutAlignment:j,referrer:b("MercuryShareAttachmentRenderLocations").CHAT,threadID:this.props.threadID,onTrigger:this.props.onP2PTrigger}},_getStickerButtonProps:function(){var a={className:"_6gb _6gf",flyoutAlignment:j,threadID:this.props.threadID,onStickerSelect:this.props.onStickerSelect};return a},_getPhotoUploaderProps:function(){var a={className:"_6gd",customUI:!0,imageClassName:"hidden_elem",linkClassName:"_6gb _6ge",threadID:this.props.threadID,onLastUploadCancel:this._handleUploadCancel,onAllUploadsComplete:this._handleUploadComplete,onLastUploadFail:this._handlePhotoUploadFail,onUploadError:this._handleUploadError,onSubmit:this._handleUploadSubmit};return a},_getFileUploaderProps:function(){var a=this._getPhotoUploaderProps();a.linkClassName="_6gb _6gg";a.imagesOnly=!1;a.onLastUploadFail=this._handleFileUploadFail;return a},_handleUploadComplete:function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).confirmAttachmentPlaceholder(c.upload_id,c),this.props.onUploadComplete&&this.props.onUploadComplete(c)},_handleUploadError:function(a){var b,c;switch(a.error){case"size-exceeded":b=h._("The file you have selected is too large");c=h._("The file you have selected is too large. The maximum size is 25MB.");break;default:b=h._("File Upload Failed"),c=h._("There was a problem uploading the file.")}this._showErrorDialog(b,c);this.props.onFileUploadFail&&this.props.onFileUploadFail(a)},_handleUploadCancel:function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(c.upload_id,c),this.props.onUploadCancel&&this.props.onUploadCancel(c)},_handleFileUploadFail:function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(c.upload_id,c);a=h._("File Upload Failed");var d=h._("There was a problem uploading the file.");c.errorDialogParams&&(a=c.errorDialogParams.title||a,d=c.errorDialogParams.body||d);this._showErrorDialog(a,d);this.props.onFileUploadFail&&this.props.onFileUploadFail(c)},_handlePhotoUploadFail:function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(c.upload_id,c);a=h._("Upload Failed");var d=h._("Please try again. Make sure you are uploading a valid file.");c.errorDialogParams&&(a=c.errorDialogParams.title||a,d=c.errorDialogParams.body||d);this._showErrorDialog(a,d);this.props.onPhotoUploadFail&&this.props.onPhotoUploadFail(c)},_handleUploadSubmit:function(a,b){this.props.onUploadSubmit&&this.props.onUploadSubmit(b)},_showErrorDialog:function(a,c){b("SimpleXUIDialog").show(c,a)},_handleInputKeyDown:function(a,b){this.props.inputKeyDown&&this.props.inputKeyDown(a,b)},_handleEscape:function(a){this.props.onEscape&&this.props.onEscape(a)},_handleEmojiSelect:function(a){this._inputRef&&this._inputRef.insertEmoji&&this._inputRef.insertEmoji(a)},_onTextChange:function(a,c){var d=this.props.threadID;d&&(this._setTextImmediate=b("setImmediate")(function(){this._setTextImmediate=null,b("FantaMessageActions").composerTextUpdate(d,a,c)}.bind(this)));this._handleComposerHeightMayChange()},_handleComposerHeightMayChange:function(){if(!this._singleLineComposerRef)return;var a=b("ReactDOM").findDOMNode(this._singleLineComposerRef);if(!a)return;a=a.clientHeight;!this.state.longInput&&a>l?this.setState({longInput:!0}):this.state.longInput&&a<m&&this.setState({longInput:!1})}});e.exports=c}),null);
__d("M4IconSettings.bs",["React","M4IconSVG.bs","ReasonReact.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("ReasonReact.bs").statelessComponent("M4IconSettings");function h(a,c,d){var e=a?a[0]:!0,f=c?c[0]:"blue",h={fill:"none",stroke:f,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10"};return[g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],function(){var a=!e;return b("ReasonReact.bs").element(0,0,b("M4IconSVG.bs").make([a?b("React").createElement("g",{key:"filled"},b("React").createElement("path",{key:"outer",style:h,d:"M15.5,8.9V7.1l-2.2-0.5c-0.1-0.5-0.3-0.9-0.6-1.3l1.2-1.9l-1.2-1.2l-1.9,1.2C10.3,3,9.9,2.8,9.4,2.7L8.9,0.5\n          \t\t\tH7.1L6.6,2.7C6.1,2.8,5.7,3,5.2,3.2L3.3,2.1L2.1,3.3l1.2,1.9C3,5.7,2.8,6.1,2.7,6.6L0.5,7.1v1.7l2.2,0.5c0.1,0.5,0.3,0.9,0.6,1.3\n          \t\t\tl-1.2,1.9l1.2,1.2l1.9-1.2c0.4,0.2,0.9,0.4,1.3,0.6l0.5,2.2h1.7l0.5-2.2c0.5-0.1,0.9-0.3,1.3-0.6l1.9,1.2l1.2-1.2l-1.2-1.9\n          \t\t\tc0.2-0.4,0.4-0.9,0.6-1.3L15.5,8.9z"}),b("React").createElement("circle",{key:"inner",style:h,cx:"8",cy:"8",r:"2.5"})):b("React").createElement("path",{key:"all",d:"M15.5,8.9V7.1l-2.2-0.5c-0.1-0.5-0.3-0.9-0.6-1.3l1.2-1.9l-1.2-1.2l-1.9,1.2C10.3,3,9.9,2.8,9.4,2.7L8.9,0.5 H7.1L6.6,2.7C6.1,2.8,5.7,3,5.2,3.2L3.3,2.1L2.1,3.3l1.2,1.9C3,5.7,2.8,6.1,2.7,6.6L0.5,7.1v1.7l2.2,0.5c0.1,0.5,0.3,0.9,0.6,1.3 l-1.2,1.9l1.2,1.2l1.9-1.2c0.4,0.2,0.9,0.4,1.3,0.6l0.5,2.2h1.7l0.5-2.2c0.5-0.1,0.9-0.3,1.3-0.6l1.9,1.2l1.2-1.2l-1.2-1.9 c0.2-0.4,0.4-0.9,0.6-1.3L15.5,8.9z M8,11c-1.7,0-3-1.3-3-3c0-1.7,1.3-3,3-3c1.7,0,3,1.3,3,3C11,9.7,9.7,11,8,11z",fill:f,stroke:f})]))},g[9],g[10],g[11],g[12]]}a=b("ReasonReact.bs").wrapReasonForJs(g,function(a){return h([a.filled],[a.color],[])});f.component=g;f.make=h;f.jsComponent=a}),null);
__d("ChatTabMenuBootloader.react",["cssVar","cx","fbt","AutoFocusableLink.react","BootloadOnInteraction.react","CurrentUser","FantaTypeComposer","immutable","JSResource","LazyComponent.react","M4IconSettings.bs","MessengerState.bs","React"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("M4IconSettings.bs").jsComponent;j=babelHelpers.inherits(a,b("React").Component);j&&j.prototype;a.prototype.render=function(){var a=this.props,c=a.highlightNewMessage,d=a.isFocused;a=a.threadID;a=b("MessengerState.bs").getThreadMetaNow(b("CurrentUser").getID(),a);a=a&&a.header_color||"#0084ff";c=c?"#FFFFFF":d?a:"#bec2c9";d=i._("Options");return b("React").createElement("div",{className:"_461_",ref:"menu"},b("React").createElement(b("BootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),this.props),loader:b("JSResource")("ChatTabMenu.react").__setRef("ChatTabMenuBootloader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{"aria-label":d,role:"button"},b("React").createElement(k,{filled:!0,color:c}))}))};function a(){j.apply(this,arguments)}e.exports=a}),null);
__d("MessengerHoverCardLink",["URI"],(function(a,b,c,d,e,f){var g={getBaseURI:function(){return new(b("URI"))("/ajax/hovercard/chat.php")},constructEndpoint:function(a){return new(b("URI"))(g.getBaseURI()).setQueryData({id:a.id,type:"chat"})}};e.exports=g}),null);
__d("ChatTitleLink.react",["cx","ChatEditParticipantsUtils","Link.react","MercuryIDs","MercuryThreadTitle.react","MessengerAdminGroupUtils","MessengerHoverCardLink","React","TrackingNodes","UserAgent","gkx","goURI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"ChatTitleLink",propTypes:{href:a.string,isEmptyChat:a.bool,thread:a.object,viewer:a.string},getDefaultProps:function(){return{href:null}},getTitle:function(){return this.refs.threadTitle.getTitle()},render:function(){if(!this.props.thread)return null;var a=this.props,c=a.href,d=a.thread,e=a.viewer;a=babelHelpers.objectWithoutProperties(a,["href","thread","viewer"]);var f="";b("gkx")("AT6Pi2a8MKJnWbIzTtkE83l3SQto_q6iFEUcjRzrX_KWbZvaeUi7XiJBSppF6WZHWLawAEgGrQhXyShvNLt7lgt3")&&d&&d.thread_id&&(f=b("MessengerHoverCardLink").constructEndpoint({id:b("MercuryIDs").getThreadFBIDFromThreadID(d.thread_id)}));return b("React").createElement(h,babelHelpers["extends"]({className:"titlebarText"+(b("UserAgent").isBrowser("Chrome")&&!b("UserAgent").isPlatform("Windows")?" fixemoji":"")+(c===null?" noLink":""),"data-ft":b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.TITLE),"data-hover":"tooltip",onClick:function(a){return this._handleClick(a)}.bind(this),"data-hovercard":f.toString(),href:c},a),b("React").createElement(b("MercuryThreadTitle.react"),{ref:"threadTitle",isNewThread:this.props.isEmptyChat,thread:d,useAndSeparator:!0,useShortName:!d.is_canonical,viewer:e}))},_handleClick:function(a){var c=this.props,d=c.href;c=c.thread;if(!d)return;c&&c.associated_object?b("goURI")(d):b("MessengerAdminGroupUtils").showParticipantsModal(c.is_canonical,this.props.isEmptyChat,c)&&(b("ChatEditParticipantsUtils").showParticipantsModal(c.thread_id),a.preventDefault())}});var h=function(a){return a.href?b("React").createElement(b("Link.react"),a):b("React").createElement("span",a)};e.exports=c}),null);
__d("M4IconCamcorder.bs",["React","M4IconSVG.bs","ReasonReact.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("ReasonReact.bs").statelessComponent("M4IconCamcorder");function h(a,c,d){var e=a?a[0]:!0,f=c?c[0]:"blue",h={fill:e?f:"none",stroke:f};return[g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],function(){return b("ReasonReact.bs").element(0,0,b("M4IconSVG.bs").make([b("React").createElement("path",{key:"body",style:h,d:"M9.5,13.5h-7c-1.1,0-2-0.9-2-2v-7c0-1.1,0.9-2,2-2h7c1.1,0,2,0.9,2,2v7C11.5,12.6,10.6,13.5,9.5,13.5z"}),b("React").createElement("line",{key:"focus-ring",stroke:e?"none":f,x1:"13.5",x2:"13.5",y1:"5",y2:"11"}),b("React").createElement("path",{key:"lens",style:h,d:"M15,3.6l-3.5,3V8v1.4l3.5,3c0.2,0.2,0.5,0,0.5-0.3V8V3.9C15.5,3.6,15.2,3.4,15,3.6z"})]))},g[9],g[10],g[11],g[12]]}a=b("ReasonReact.bs").wrapReasonForJs(g,function(a){return h([a.filled],[a.color],[])});f.component=g;f.make=h;f.jsComponent=a}),null);
__d("M4IconPhone.bs",["React","M4IconSVG.bs","ReasonReact.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("ReasonReact.bs").statelessComponent("M4IconPhone");function h(a,c,d){d=a?a[0]:!0;a=c?c[0]:"blue";var e={fill:d?a:"none",stroke:a};return[g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],function(){return b("ReasonReact.bs").element(0,0,b("M4IconSVG.bs").make([b("React").createElement("path",{key:"all",style:e,d:"M8.8,11.6c0.1,0,0.1,0.1,0.2,0.1c0.4,0.2,0.8,0.1,1-0.3c0.1-0.2,0.2-0.4,0.3-0.6c0.2-0.2,0.5-0.6,0.8-0.7 C11.5,10,11.8,10,12,10c0.4,0,0.9,0.4,1.6,0.8c0.7,0.4,1.2,0.8,1.5,1c0.2,0.2,0.3,0.4,0.3,0.6c0,0.4,0,1.2-0.7,1.9 c-1,1.1-2.5,1.6-4.3,1c-1.8-0.6-4.1-1.7-6-3.7s-3.1-4.2-3.7-6s-0.2-3.3,1-4.3c0.7-0.6,1.4-0.7,1.9-0.7c0.2,0,0.5,0.1,0.6,0.3 c0.2,0.3,0.6,0.8,1,1.5C5.7,3.1,6,3.6,6,4c0,0.3,0,0.6-0.1,0.8C5.8,5.1,5.5,5.4,5.2,5.6C5,5.8,4.8,5.9,4.7,6C4.3,6.1,4.1,6.6,4.3,7 c0,0.1,0.1,0.1,0.1,0.2C5.5,9,7,10.5,8.8,11.6z"})]))},g[9],g[10],g[11],g[12]]}a=b("ReasonReact.bs").wrapReasonForJs(g,function(a){return h([a.filled],[a.color],[])});f.component=g;f.make=h;f.jsComponent=a}),null);
__d("ChatVideoCallButtonBootloader.react",["cx","AutoFocusableLink.react","BootloadOnInteraction.react","JSResource","LazyComponent.react","M4IconCamcorder.bs","M4IconPhone.bs","React","requireWeak"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("M4IconCamcorder.bs").jsComponent,j=b("M4IconPhone.bs").jsComponent;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=!1,this.state={RTCComponent:null},b}a.prototype.componentDidMount=function(){this.$1=!0,b("requireWeak")("ChatVideoCallButton.react",function(a){this.$1&&this.setState({RTCComponent:a})}.bind(this))};a.prototype.render=function(){var a=this.props.isAudio,c=this.state.RTCComponent;return b("React").createElement("div",{className:"_3a61"+(a?" _461a":"")+(a?"":" _461b"),key:"rtc"+(a?"audio":"video")},c?b("React").createElement(c,this.props):b("React").createElement(b("BootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),this.props),loader:b("JSResource")("ChatVideoCallButton.react").__setRef("ChatVideoCallButtonBootloader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{role:"button"},a?b("React").createElement(j,{color:this.props.color,filled:!0}):b("React").createElement(i,{color:this.props.color,filled:!0}))}))};e.exports=a}),null);
__d("ChatTabHeader.react",["ix","cx","fbt","AutoFocusableLink.react","Bootloader","BootloadOnRender.react","ChatCloseButton.react","ChatTitleLink.react","EventPlanExperiment","EventReminderStateStore","FantaTypeComposer","Image.react","immutable","JSResource","LayerFadeOnHide","LazyComponent.react","LoadOnRender.react","MercuryBootloadOnInteraction.react","MercuryIDs","MercuryThreadInfo","MercuryTypingAnimation.react","MessageRequestUtils","MessagingTag","MessengerAdminGroupUtils","MessengerJoinableModeType","React","SimpleNUXMessage","TooltipData","WorkChatAvailabilityStatusLoader","XUIAmbientNUX.react","asset","gkx","requireWeak"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PropTypes;var k="118809038721180",l=function(a){b("Bootloader").loadModules(["ArchiveWarningReact.bs"],function(b){b=b.jsComponent;return a(b)},"ChatTabHeader.react")},m=b("gkx")("AT7esXHVKl_rB1r5C-zEkmCVhZJMRd4NQJBo-b1EyRH6vUNk2XZEcNJ3WOEvumLbmsR6a_bwkl5o0d60WUY3jm1v");d=babelHelpers.inherits(a,b("React").PureComponent);j=d&&d.prototype;function a(a){j.constructor.call(this,a),this.$1=!1,this.$4=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];this.props.onClick.apply(null,b)}.bind(this),this.$15=function(){return this.refs.menu}.bind(this),this.$16=function(){b("SimpleNUXMessage").markMessageSeenByUser(k),this.setState({eventPlanNuxSeen:!0})}.bind(this),this.state={eventPlanNuxSeen:b("SimpleNUXMessage").hasUserSeenMessage(k)}}a.prototype.componentDidMount=function(){this.$1=!0,b("requireWeak")("ChatVideoCallButton.react",function(a){this.$1&&this.setState({RTCComponent:a})}.bind(this))};a.prototype.componentWillUnmount=function(){this.$1=!1};a.prototype.render=function(){var a=this.$3(),c=this.props.isRaised;return b("React").createElement("div",{className:"_15p4"+(this.props.isRaised?"":" _15p5")+(c||!a?" _2pis":""),onMouseUp:this.$4,ref:"root"},b("React").createElement("div",{"aria-level":"2",className:"titlebarTextWrapper _15p6",role:"heading"},b("React").createElement("div",{className:"_61td",role:c?"presentation":"button",tabIndex:c?-1:0},a,this.$5()),this.props.isTyping&&!this.props.isRaised?b("React").createElement(b("MercuryTypingAnimation.react"),{className:"_15p8",color:"dark"}):null),b("React").createElement("ul",{className:"_32ca"+(m?" _2qi8":"")},this.$6(),b("React").createElement("li",{className:"_32cb"},b("React").createElement(b("ChatCloseButton.react"),{active:this.props.isActive,className:"_3olu _3olv",onClick:this.props.onCloseClick}))))};a.prototype.focus=function(){this.refs.root&&this.refs.root.focus()};a.prototype.$7=function(){return this.props.thread?b("MessageRequestUtils").isMessageRequest(this.props.thread):!1};a.prototype.$6=function(){if(!this.props.isRaised)return null;var a=[this.$8(),this.$9(),this.$10(),this.$11(),this.$12(),this.$13()];return a.filter(Boolean)};a.prototype.$12=function(){return this.$14({isAudio:!0})};a.prototype.$11=function(){return this.$14({isAudio:!1})};a.prototype.$14=function(a){__p&&__p();if(this.props.isEmptyChat||this.$7())return null;var c=this.props,d=c.isGroupChat,e=c.onRTCNuxCloseButtonClick,f=c.rtcNuxShown,g=c.thread,h=c.threadID;c=c.viewer;if(d){if(!g||g.participants.length<=1||!b("MercuryThreadInfo").canReply(g))return null;if(g.joinable_mode&&g.joinable_mode.mode===b("MessengerJoinableModeType").JOINABLE)return null}d=babelHelpers["extends"]({isGroupChat:d,onRTCNuxCloseButtonClick:e,rtcCallData:g&&g.rtc_call_data,rtcNuxShown:f&&a.isAudio,threadID:h,thread:g,viewer:c},a);d.className="_3olv"+(d.isAudio?" _2fpc":"")+(d.isAudio?"":" _2fpd");e=this.state.RTCComponent;return b("React").createElement("li",{className:"_3a61"+(d.isAudio?" _461a":"")+(d.isAudio?"":" _461b"),key:"rtc"+(d.isAudio?"audio":"video")},e?b("React").createElement(e,d):b("React").createElement(b("MercuryBootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),d),loader:b("JSResource")("ChatVideoCallButton.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{className:d.className,role:"button"})}))};a.prototype.$13=function(){__p&&__p();var a=this.props.thread;if(this.props.isEmptyChat||!!a&&a.folder===b("MessagingTag").PENDING)return null;a={attachmentsShelf:this.props.attachmentsShelf,composer:this.props.composer,hasBlockedMessages:this.props.hasBlockedMessages,isEmptyChat:this.props.isEmptyChat,isGroupChat:this.props.isGroupChat,isMultiCompany:this.props.isMultiCompany,isMuted:this.props.isMuted,isPageChat:this.props.isPageChat,membershipParticipants:this.props.membershipParticipants,participants:this.props.participants,sheetController:this.props.sheetController,thread:this.props.thread,threadID:this.props.threadID,viewer:this.props.viewer};a.className="_3olv _1ll-";var c=i._("Options"),d=!1;if(this.props.threadID){var e=b("EventReminderStateStore").getEvent(this.props.threadID);d=e&&!e.exists&&!this.state.eventPlanNuxSeen&&b("EventPlanExperiment").shouldShowEntryPointNuxWithExposure()}return b("React").createElement("div",{key:"menu"},b("React").createElement("li",{className:"_3a61 _461_",ref:"menu"},b("React").createElement(b("MercuryBootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),a),loader:b("JSResource")("ChatTabMenu.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{className:a.className,"aria-label":c,role:"button"})})),b("React").createElement(b("XUIAmbientNUX.react"),{alignment:"right",behaviors:{LayerFadeOnHide:b("LayerFadeOnHide")},contextRef:this.$15,onCloseButtonClick:this.$16,shown:d,width:"auto"},i._("Click here to start a new plan.")))};a.prototype.$10=function(){if(this.props.isPageChat||this.props.isEmptyChat||this.props.isMultiCompany&&!this.props.isGroupChat||this.$7())return null;var a={className:"_3olv _3jyj",isFBAtWork:this.props.isWorkUser,shouldAddToApprovalQueue:b("MessengerAdminGroupUtils").shouldAddToApprovalQueue(this.props.thread,this.props.viewer),shown:!0,onClick:function(){return this.props.sheetController.openAddFriendsSheet()}.bind(this),thread:this.props.thread,viewer:this.props.viewer},c=i._("Add");return b("React").createElement("li",{className:"_3a61 _4620",key:"add"},b("React").createElement(b("MercuryBootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),a),loader:b("JSResource")("ChatAddToThreadButton.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{"aria-label":c,className:a.className,role:"button"})}))};a.prototype.$8=function(){if(!this.props.isViewerEmployee)return null;var a=this.props.participants;a=a?a.length>0&&a.every(function(a){return!!(a&&a.employee)}):!1;return!a?null:b("React").createElement("li",{key:"archiveWarning"},b("React").createElement(b("LoadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{shown:!0}),loader:l,placeholder:b("React").createElement("div",null)}))};a.prototype.$9=function(){if(!this.props.isWorkUser||!this.props.isMultiCompany)return null;var a=i._("Multi company chat");return b("React").createElement("li",{key:"multiCompanyBadge"},b("React").createElement("div",{className:"_3olv"},b("React").createElement(b("AutoFocusableLink.react"),babelHelpers["extends"]({className:"_kp6",onClick:this.props.onClick,lable:a,role:"presentation"},b("TooltipData").propsFor(a,"above")))))};a.prototype.$17=function(){return b("React").createElement("span",{className:"_3a61"+(this.props.isRaised?"":" _3-99")},b("React").createElement("span",{className:"_3olv _2nlt"}))};a.prototype.$18=function(){var a=this.props.threadID?b("MercuryIDs").getUserIDFromThreadID(this.props.threadID):null;a=b("WorkChatAvailabilityStatusLoader").isLoaded()&&a?b("WorkChatAvailabilityStatusLoader").getStoreEnforce().getDescription(a):"";return b("React").createElement(b("Image.react"),{className:"_4jft","data-tooltip-content":a,"data-hover":"tooltip",src:g("550341")})};a.prototype.$5=function(){var a=this.props.thread,c=this.props.tooltip;b("gkx")("AT6Pi2a8MKJnWbIzTtkE83l3SQto_q6iFEUcjRzrX_KWbZvaeUi7XiJBSppF6WZHWLawAEgGrQhXyShvNLt7lgt3")&&a&&a.is_canonical&&(c="");return b("React").createElement(b("ChatTitleLink.react"),babelHelpers["extends"]({href:this.props.isRaised?this.props.href:undefined,isEmptyChat:this.props.isEmptyChat,thread:this.props.thread,viewer:this.props.viewer},b("TooltipData").propsFor(c,"above")))};a.prototype.$3=function(){var a=this.props,c=a.isRaised;a=a.thread;return!c&&a&&a.unread_count>0?b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{className:"_3-8_ _3-99",count:a.unread_count,type:"special"}),loader:b("JSResource")("XUIBadge.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement("span",null)}):b("React").createElement(b("React").Fragment,null,this.$18(),this.$17())};a.propTypes={attachmentsShelf:c.object.isRequired,composer:c.object,hasBlockedMessages:c.bool.isRequired,href:c.string,isActive:c.bool.isRequired,isEmptyChat:c.bool,isGroupChat:c.bool,isMuted:c.bool,isPageChat:c.bool,isRaised:c.bool,isTyping:c.bool,isViewerEmployee:c.bool,isWorkUser:c.bool,onClick:c.func.isRequired,onCloseClick:c.func.isRequired,onRTCNuxCloseButtonClick:c.func.isRequired,participants:c.arrayOf(c.object),rtcNuxShown:c.bool.isRequired,sheetController:c.object.isRequired,thread:c.object,threadID:c.string,tooltip:c.string,viewer:c.string.isRequired};e.exports=a}),null);
__d("getGroupNameTooltipFromParticipantIDs",["fbt","MercuryViewer","MessengerParticipants.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=10,i="\n";function a(a,c){__p&&__p();var d=[],e=b("MercuryViewer").getID();a=a&&a.filter(function(a){return a!==e});if(!a||!a.length){c(null);return}var f=a.length,j=f-h;j>1&&(a=a.slice(0,h));b("MessengerParticipants.bs").getMulti(a,function(a){for(var b in a){var e=a[b];d.push(e.name)}if(j>1){e=g._("and {number of hidden chat participants} more.",[g._param("number of hidden chat participants",j)]);d.push(e)}c(d.join(i))})}function c(a){__p&&__p();var c=[],d=b("MercuryViewer").getID();a=a&&a.filter(function(a){return a!==d});if(!a||!a.length)return null;c=a.map(function(a){a=b("MessengerParticipants.bs").getNow(a);return a&&a.name}).filter(function(a){return!!a});a=a.length-(a.length-c.length)-h;if(a>1){c=c.slice(0,h);a=g._("and {number of hidden chat participants} more.",[g._param("number of hidden chat participants",a)]);c.push(a)}return c.join(i)}e.exports={getGroupNameTooltipFromParticipantIDs:c,getGroupNameTooltipFromParticipantIDsAsync:a}}),null);
__d("getTitleHrefFromThreadID",["MercuryIDs","MessengerParticipants.bs","WebMessengerThreadPermalinks"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){if(b("MercuryIDs").isLocalThread(a)){c();return}var d=b("MercuryIDs").getUserIDFromThreadID(a);d?b("MessengerParticipants.bs").get(b("MercuryIDs").getParticipantIDFromUserID(d),function(a){a.href?c(a.href):c(b("WebMessengerThreadPermalinks").getThreadURIFromUserID(d))}):b("WebMessengerThreadPermalinks").getThreadURI(a,c)}e.exports={getTitleHrefFromThreadID:a}}),null);
__d("ChatTabHeaderContainer.react",["ChatTabHeader.react","CurrentUser","FantaTypeComposer","immutable","MercuryIDs","MercuryThreadInfo","React","WorkModeConfig","getGroupNameTooltipFromParticipantIDs","getPageIDFromThreadID","getTitleHrefFromThreadID"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("getGroupNameTooltipFromParticipantIDs").getGroupNameTooltipFromParticipantIDs,i=b("getTitleHrefFromThreadID").getTitleHrefFromThreadID;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);g=d&&d.prototype;function a(a){g.constructor.call(this,a),this.state=this.calculateState(a)}a.prototype.calculateState=function(a){var c=!1,d;a.threadID&&(c=b("MercuryIDs").isGroupChat(a.threadID),d=b("getPageIDFromThreadID")(a.threadID));return{isGroupChat:c,pageID:d}};a.prototype.componentDidMount=function(){this.$1(),this.props.onMount&&this.props.onMount(this)};a.prototype.UNSAFE_componentWillReceiveProps=function(a){this.setState(this.calculateState(a))};a.prototype.componentDidUpdate=function(a,b){a.threadID!==this.props.threadID&&this.$1()};a.prototype.render=function(){var a=this.props.participants&&this.props.participants.toList().toArray(),c=this.props.thread,d;c&&(d=h(c.participants));var e=c?b("MercuryThreadInfo").isNewEmptyLocalThread(c):!1;return b("React").createElement(b("ChatTabHeader.react"),{attachmentsShelf:this.props.attachmentsShelf,composer:this.props.composer,hasBlockedMessages:this.props.hasBlockedMessages,href:this.state.href,isActive:this.props.isActive,isEmptyChat:e,isGroupChat:this.state.isGroupChat,isMultiCompany:this.props.isMultiCompany,isMuted:!!c&&b("MercuryThreadInfo").isMuted(c),isPageChat:!!this.state.pageID,isRaised:this.props.isRaised,isTyping:this.props.isTyping,isViewerEmployee:b("CurrentUser").isEmployee(),isWorkUser:!!b("WorkModeConfig").is_work_user,membershipParticipants:this.props.membershipParticipants,onClick:this.props.onClick,onCloseClick:this.props.onCloseClick,onRTCNuxCloseButtonClick:this.props.onRTCNuxCloseButtonClick,participants:a,ref:"header",rtcNuxShown:this.props.rtcNuxShown,sheetController:this.props.sheetController,thread:c,threadID:this.props.threadID,tooltip:d,viewer:this.props.viewer})};a.prototype.focus=function(){this.refs.header.focus()};a.prototype.$1=function(){i(this.props.threadID,function(a){return this.setState({href:a})}.bind(this))};a.propTypes={attachmentsShelf:c.object.isRequired,composer:c.object,isActive:c.bool.isRequired,isRaised:c.bool,isTyping:c.bool,onClick:c.func.isRequired,onCloseClick:c.func.isRequired,onMount:c.func,onRTCNuxCloseButtonClick:c.func.isRequired,rtcNuxShown:c.bool.isRequired,sheetController:c.object.isRequired,thread:c.object,threadID:c.string,viewer:c.string.isRequired};e.exports=a}),null);
__d("ChatDetailStack.bs",["ReasonReact.bs","ChatDetailStack.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){return b("ReasonReact.bs").wrapJsForReason(b("ChatDetailStack.react"),{topDetail:a,bottomDetail:c},d)}f.make=a}),null);
__d("ChatTabMenu.bs",["MercuryIDs","ReasonReact.bs","bs_js_primitive","MessengerState.bs","bs_js_null_undefined","getPageIDFromThreadID","ChatTabMenuBootloader.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e,f,g,h,i,j,k,l){var m=a?[a[0].thread_id]:0;if(m){var n=m[0];n=[b("MercuryIDs").isGroupChat(n),b("MessengerState.bs").isNewEmptyLocalThread(c,n),b("bs_js_primitive").null_undefined_to_opt(b("getPageIDFromThreadID")(n))!==0]}else n=[!1,!0,!1];var o=a?a[0].message_count===0:!0;return b("ReasonReact.bs").wrapJsForReason(b("ChatTabMenuBootloader.react"),{autoFocus:!1,composer:d,hasBlockedMessages:g,highlightNewMessage:j,isEmptyChat:n[1],isEmptyConversation:o,isFocused:i,isGroupChat:n[0],isMultiCompany:h,isPageChat:n[2],membershipParticipants:e?e[0]:null,participantsMap:f?f[0]:null,isNewMessageTab:k,thread:a?a[0]:null,threadID:b("bs_js_null_undefined").fromOption(m),viewer:c},l)}f.make=a}),null);
__d("ChatThreadName.bs",["cx","React","goURI","LinkReact.bs","MercuryIDs","ReasonReact.bs","MessengerState.bs","MessengerHoverCardLink","MercuryThreadTitleReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ReasonReact.bs").statelessComponent("ChatThreadName");function a(a,c,d,e,f,g){__p&&__p();return[h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],function(){__p&&__p();if(a){var g=a[0],h=g.thread_id,i=b("ReasonReact.bs").element(0,0,b("LinkReact.bs").make(0,0,[d],[f],0,["tooltip"],[d],0,0,[c],0,[function(a){if(c.length>0){b("goURI")(c,undefined,undefined);a.stopPropagation();return 0}else return 0}],0,0,0,0,0,0,0,[b("ReasonReact.bs").element(0,0,b("MercuryThreadTitleReact.bs").make(["_1ogo"],0,g,e,[b("MessengerState.bs").isNewEmptyLocalThread(e,g.thread_id)],0,[!g.is_canonical],[!0],[]))]));if(g.is_canonical){g=b("MessengerHoverCardLink").constructEndpoint({id:b("MercuryIDs").getThreadFBIDFromThreadID(h)});return b("React").cloneElement(i,{"data-hovercard":g,"data-hover":""})}else return i}else return null},h[9],h[10],h[11],h[12]]}f.component=h;f.make=a}),null);
__d("ChatVideoCallButton.bs",["MercuryIDs","ReasonReact.bs","bs_js_primitive","bs_js_null_undefined","ChatVideoCallButtonBootloader.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e,f,g,h,i){__p&&__p();a=a?a[0]:!0;c=c?c[0]:function(){return 0};d=d?d[0]:!1;h=h?h[0]:!0;if(f){var j=f[0];j=[[j.thread_id],b("bs_js_primitive").null_undefined_to_opt(j.rtc_call_data)]}else j=[0,0];var k=j[1];k=k?k[0]:{call_state:"NO_ONGOING_CALL",server_info_data:null,initiator_fbid:null};j=b("bs_js_null_undefined").fromOption(j[0]);var l=b("MercuryIDs").isGroupChat(j);return b("ReasonReact.bs").wrapJsForReason(b("ChatVideoCallButtonBootloader.react"),{isAudio:a,isGroupChat:l,color:e?e[0]:null,onRTCNuxCloseButtonClick:c,rtcNuxShown:d,threadID:j,thread:b("bs_js_null_undefined").fromOption(f),viewer:g,shown:h,rtcCallData:k},i)}f.make=a}),null);
__d("FantaCloseButton.bs",["ix","cx","fbt","bs_curry","asset","LinkReact.bs","ImageReact.bs","ReasonReact.bs","TrackingNodes","TrackingNodeTypes"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("ReasonReact.bs").statelessComponent("FantaCloseButton");function a(a,c,d){return[j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7],function(){var d=b("TrackingNodes").getTrackingInfo(b("TrackingNodeTypes").CLOSE_BUTTON),e=c?i._("Press Esc to close"):i._("Close tab");return b("ReasonReact.bs").element(0,0,b("LinkReact.bs").make(0,0,[e],["_40qq _4vu4 button"],[d],["tooltip"],[e],0,["above"],0,0,[function(c){c.stopPropagation();return b("bs_curry")._1(a,c)}],0,0,0,0,0,0,0,[b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make(["close"],0,0,0,[g("393091")],0,0,0,0,[]))]))},j[9],j[10],j[11],j[12]]}f.component=j;f.make=a}),null);
__d("SplitImage.bs",["ReasonReact.bs","SplitImage.react","bs_js_null_undefined"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f){return b("ReasonReact.bs").wrapJsForReason(b("SplitImage.react"),{border:b("bs_js_null_undefined").fromOption(e),size:a,srcs:c,className:b("bs_js_null_undefined").fromOption(d)},f)}f.make=a}),null);
__d("FantaProfilePresence.bs",["cx","React","goURI","gkx","LinkReact.bs","bs_caml_array","ImageReact.bs","MercuryIDs","SplitImage.bs","ReasonReact.bs","bs_js_primitive","MessengerHoverCardLink"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ReasonReact.bs").statelessComponent("FantaProfilePresence");function i(a,c,d,e,f,g,i,j,k){__p&&__p();var l=j?j[0]:"";return[h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],function(){__p&&__p();var h=b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr")&&a.length>1;if(h){var j=Math.round(c/3)|0;j=c-j|0;j=b("React").createElement("div",{className:"_44yp",style:{height:c.toString()+"px",width:c.toString()+"px"}},b("React").createElement("div",{className:"_1gyw"},b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make(0,[""],0,0,[b("bs_caml_array").caml_array_get(a,0)],[j],0,[j],0,[]))),b("React").createElement("div",{className:"_1gyw",style:{borderColor:l}},b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make(0,[""],0,0,[b("bs_caml_array").caml_array_get(a,1)],[j],0,[j],0,[]))))}else j=b("ReasonReact.bs").element(0,0,b("SplitImage.bs").make(c,a,["_1gyw"],e,[]));j=b("ReasonReact.bs").element(0,0,b("LinkReact.bs").make(0,0,[i],["_2yg8"],0,["tooltip"],[i],0,0,[g],0,[function(a){if(g.length>0){b("goURI")(g,undefined,undefined);a.stopPropagation();return 0}else return 0}],0,0,0,0,[-1],0,0,[j]));if(f){var k=f[0];if(k.is_canonical){k=b("MessengerHoverCardLink").constructEndpoint({id:b("MercuryIDs").getThreadFBIDFromThreadID(k.thread_id)});k=b("React").cloneElement(j,{"data-hovercard":k})}else k=j}else k=j;return b("React").createElement("div",{"aria-hidden":!0,className:"_ro7"+(h?" _44yq":"")},k,d?b("React").createElement("div",{className:"_1gyx",style:{borderColor:l}}):null)},h[9],h[10],h[11],h[12]]}a=b("ReasonReact.bs").wrapReasonForJs(h,function(a){return i(a.images,a.imageSize,a.isActive,b("bs_js_primitive").null_undefined_to_opt(a.border),b("bs_js_primitive").null_undefined_to_opt(a.thread),a.threadHref,a.tooltip,b("bs_js_primitive").null_undefined_to_opt(a.backgroundColor),[])});f.component=h;f.make=i;f.jsComponent=a}),null);
__d("FantaM4Header.bs",["cx","fbt","cssVar","React","gkx","bs_caml_obj","MercuryIDs","ChatTabMenu.bs","ReasonReact.bs","bs_js_primitive","ChatThreadName.bs","ChatDetailStack.bs","FantaCloseButton.bs","ArchiveWarningReact.bs","ChatVideoCallButton.bs","FantaProfilePresence.bs","MessengerParticipants.bs","getPageIDFromThreadID","getGroupNameTooltipFromParticipantIDs"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("ReasonReact.bs").statelessComponent("FantaM4Header");function k(a,c){__p&&__p();if(a){var d=a[0];return d.reduce(function(a,e,f,g){__p&&__p();if(a.length<5)if(d.size>4){if(b("bs_caml_obj").caml_notequal(e.fbid,c)){f=e.image_src;f==null||a.push(f)}}else{g=e.image_src;g==null||a.push(g)}return a},[])}else return[]}function l(a,c,d){__p&&__p();if(a){a=a[0];var e=a.image_src;if(e==null){a=b("MercuryIDs").getParticipantIDFromFromThreadID(a.thread_id);if(a==null)return k(c,d);else{c=b("MessengerParticipants.bs").getNow(a);if(c==null)return[];else{d=c.image_src;if(d==null)return[];else return[d]}}}else return[e]}else return[]}function m(a){__p&&__p();if(a){a=a[0];if(a.is_canonical)return"";else{a=b("getGroupNameTooltipFromParticipantIDs").getGroupNameTooltipFromParticipantIDs(a.participants);if(a==null)return"";else return a}}else return""}function n(a,c,d,e,f,g,i,k,n,o,p,q,r,s,t,u,v,w){__p&&__p();var x=s?s[0]:"";return[j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7],function(){__p&&__p();var j=l(r,p,t),s=r?b("bs_js_primitive").null_undefined_to_opt(b("getPageIDFromThreadID")(r[0].thread_id)):0,y=h._("Active now");s=s||!e?null:b("React").createElement("div",{"aria-label":y,role:"presentation"},y);if(p){y=p[0];var z=y.filter(function(b,a,c){return b.employee});z=y.count()>0&&z.count()===y.count()}else z=!1;y=m(r);if(r){var A=r[0].header_color;A=A==null?["#0084ff"]:[A]}else A=["#0084ff"];A=d?A?[["#FFFFFF"],A[0]]:[["#bec2c9"],""]:A?f?[[A[0]],""]:[["#bec2c9"],""]:[["#bec2c9"],""];var B=A[1];A=A[0];var C=b("gkx")("AT6xa_Prh72hnOTDQ3aoezexBws-l47wdubCJdahCNHN_M0yvNIVgO3a6G_ArwG33iWNx1YBgXNCaMdq6kvMfM0Y");C=d?C?"_69pt _2mgn _3566":"_69pt _2mgn":"_69pt";var D=v?h._("New Message"):b("ReasonReact.bs").element(0,0,b("ChatThreadName.bs").make(r,x,y,t,"_2mgq",[]));z=v?null:z?b("React").createElement("div",{className:"_69r-"},b("React").createElement("div",{className:"_1v1u"},b("ReasonReact.bs").element(0,0,b("ArchiveWarningReact.bs").make(z,[]))),s):s;return b("React").createElement("div",{className:C,style:{backgroundColor:B},onClick:n},b("React").createElement("div",{className:"_66n2"},v?null:b("ReasonReact.bs").element(0,0,b("FantaProfilePresence.bs").make(j,32,u?!0:e,[!0],r,x,y,[B],[])),b("React").createElement("div",{className:"_66n3"+(v?" _6dtv":"")},b("ReasonReact.bs").element(0,0,b("ChatDetailStack.bs").make(D,z,[])),r&&!v?b("React").createElement("div",{className:"_69ae"},b("React").createElement("div",{className:"_66n5 _1iti"},b("ReasonReact.bs").element(0,0,b("ChatVideoCallButton.bs").make([!1],0,0,A,r,t,0,[]))),b("React").createElement("div",{className:"_66n5 _1iti"},b("ReasonReact.bs").element(0,0,b("ChatVideoCallButton.bs").make([!0],[o],[q],A,r,t,0,[]))),b("React").createElement("div",{className:"_66n5"},b("ReasonReact.bs").element(0,0,b("ChatTabMenu.bs").make(r,t,a,i,p,c,g,f,d,v,[])))):null)),b("ReasonReact.bs").element(0,0,b("FantaCloseButton.bs").make(k,f,[])))},j[9],j[10],j[11],j[12]]}a=b("ReasonReact.bs").wrapReasonForJs(j,function(a){return n(a.composer,a.hasBlockedMessages,a.highlightNewMessage,a.isActive,a.isFocused,a.isMultiCompany,b("bs_js_primitive").null_undefined_to_opt(a.membershipParticipants),a.onClose,a.onHeaderToggle,a.onRTCNuxCloseButtonClick,b("bs_js_primitive").null_undefined_to_opt(a.participants),a.rtcNuxShown,b("bs_js_primitive").null_undefined_to_opt(a.thread),[a.threadHref],a.viewer,b("bs_js_primitive").null_undefined_to_opt(a.pageIndicatorDescription),a.isNewMessageTab,[])});c=32;d=20;f.component=j;f.profile_image_size=c;f.small_profile_image_size=d;f.getUpToFourImages=k;f.getProfileImages=l;f.getTooltip=m;f.make=n;f.jsComponent=a}),null);
__d("XGroupCallNuxController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/groupcall/nux/",{action:{type:"String",required:!0}})}),null);
__d("FantaChatHeaderContainer.react",["cx","AsyncRequest","ChatTabHeaderContainer.react","FantaAvailableStatus","FantaM4Header.bs","FantaTabActions","FantaTabSheetActions","FantaTypeComposer","immutable","MercuryIgnoredBlockedParticipants.bs","React","XGroupCallNuxController","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("FantaM4Header.bs").jsComponent;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=!1,this.state={rtcNuxShown:!1},this.$7=function(){var a=this.props.threadID;b("FantaTabSheetActions").openAddMoreFriendsSheet(a)}.bind(this),this.$4=function(event){this.props.onClose&&this.props.onClose(),event.preventDefault()}.bind(this),this.$5=function(event){var a=event.target,c=a&&a.classList&&a.classList.contains("button");a=a&&(a.tagName==="svg"||a.ownerSVGElement!=null);if(c||a)return;event.stopPropagation();b("FantaTabActions").minimizeTab(this.props.threadID)}.bind(this),this.$6=function(event){this.$3();var a=event.target;if(!a)return;(a.getAttribute("role")==="presentation"||a.classList&&(a.classList.contains("_15p6")||a.classList.contains("_2nlt")||a.classList.contains("_14lt")))&&(event.stopPropagation(),b("FantaTabActions").minimizeTab(this.props.threadID))}.bind(this),this.$3=function(){if(this.state.rtcNuxShown&&this.$1){this.setState({rtcNuxShown:!1});var a=b("XGroupCallNuxController").getURIBuilder().setString("action","dismiss").getURI();new(b("AsyncRequest"))(a).send()}}.bind(this),c}a.prototype.shouldComponentUpdate=function(a,b){var c=this.props,d=this.state;return c.threadHref!==a.threadHref||c.highlightNewMessage!==a.highlightNewMessage||c.isFocused!==a.isFocused||c.viewer!==a.viewer||c.threadID!==a.threadID||c.isLastGroupTab!==a.isLastGroupTab||c.thread!==a.thread||d.rtcNuxShown!==b.rtcNuxShown||c.customColor!==a.customColor||c.blockedIDs!==a.blockedIDs||!c.membershipParticipants&&!!a.membershipParticipants||!!c.membershipParticipants&&!!a.membershipParticipants&&!c.membershipParticipants.equals(a.membershipParticipants)||!c.participants&&!!a.participants||!!c.participants&&!!a.participants&&!c.participants.equals(a.participants)};a.prototype.componentDidMount=function(){this.$1=!0,this.$2()};a.prototype.componentWillUnmount=function(){this.$3(),this.$1=!1};a.prototype.render=function(){var a=this.props,c=a.blockedIDs,d=a.composer,e=a.customColor,f=a.highlightNewMessage,g=a.isFocused,h=a.isNewMessageTab,j=a.membershipParticipants,k=a.pageIndicatorDescription,l=a.participants,m=a.thread,n=a.threadHref,o=a.threadID;a=a.viewer;var p=this.state.rtcNuxShown,q=e?{color:e}:null;c=!!m&&b("MercuryIgnoredBlockedParticipants.bs").qualifiesAs(a,c,m);if(b("gkx")("AT6A1bnDK2h8UfK21QtwMasCKSCRuJLNl1CkXiFlb4ngyuzOTwnMPylW45yiU1EwI4xsY2mbtMRkoGbbra-xak0V")){var r=b("FantaAvailableStatus").isAvailable(m,o);return b("React").createElement("div",{className:"clearfix titlebar"},b("React").createElement(i,{composer:d,hasBlockedMessages:c,highlightNewMessage:f,isActive:r,isFocused:g,isMultiCompany:this.props.isMultiCompany,isNewMessageTab:!!h,membershipParticipants:j,onClose:this.$4,onHeaderToggle:this.$5,onRTCNuxCloseButtonClick:this.$3,pageIndicatorDescription:k,participants:l,rtcNuxShown:p,thread:m,threadHref:n,viewer:a}))}return b("React").createElement("div",{className:"clearfix fbNubFlyoutTitlebar titlebar"+(e?" _1m34":""),style:q},b("React").createElement(b("ChatTabHeaderContainer.react"),{attachmentsShelf:document.createElement("div"),composer:d,hasBlockedMessages:c,isActive:g,isMultiCompany:this.props.isMultiCompany,isRaised:!0,isTyping:!1,membershipParticipants:j,onClick:this.$6,onCloseClick:this.$4,onRTCNuxCloseButtonClick:this.$3,participants:l,rtcNuxShown:p,sheetController:{openAddFriendsSheet:this.$7},thread:m,threadID:o,viewer:a}))};a.prototype.$2=function(){if(this.props.isLastGroupTab){var a=b("XGroupCallNuxController").getURIBuilder().setString("action","should_show").getURI();new(b("AsyncRequest"))(a).setHandler(function(a){a=a.payload.shouldShow;this.$1&&this.setState({rtcNuxShown:a})}.bind(this)).send()}};a.propTypes={blockedIDs:c.instanceOf(Set).isRequired,customColor:c.string,highlightNewMessage:c.bool,isFocused:c.bool.isRequired,isLastGroupTab:c.bool.isRequired,onClose:c.func.isRequired,thread:c.object,threadID:c.string.isRequired,viewer:c.string.isRequired};e.exports=a}),null);
__d("FantaConversation.react",["Bootloader","ChatConversation.react","CurrentUser","EventProfiler","MercuryIDs","MessengerHotLikePreviewEvents","React","StickerInterfaces","StickersTypedLogger","SubscriptionsHandler","emptyFunction"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(a){g.constructor.call(this,a),this.$4=function(a){this.props.threadID===a&&this.setState({likePreview:null})}.bind(this),this.$5=function(a,c){if(!a)return;new(b("StickersTypedLogger"))().setEvent("click_sticker").setPackid(a).setStickerid(c).log();b("Bootloader").loadModules(["StickersPackInTray","StickersActions","StickersStoreController"],function(c,d,e){c.onIsPackInTray(a,b("StickerInterfaces").MESSAGES,function(b){b.in_sticker_tray?(d.selectTrayPack(a),d.showStickerFlyout(this.props.threadID)):e.showStore(a)}.bind(this))}.bind(this),"FantaConversation.react")}.bind(this),this.state={likePreview:null},this.$1=new(b("SubscriptionsHandler"))()}a.prototype.shouldComponentUpdate=function(a,b){var c=this.props,d=this.state;return!c.onlineUsers.equals(a.onlineUsers)||!c.messages.equals(a.messages)||c.threadID!==a.threadID||c.thread!==a.thread||d.likePreview!==b.likePreview};a.prototype.componentDidMount=function(){this.$2(),this.$3()};a.prototype.componentDidUpdate=function(){this.$3()};a.prototype.componentWillUnmount=function(){this.$1.release()};a.prototype.$3=function(){b("EventProfiler").informManualInteractionTimestamp(["MessageJewelListItem","ChatSideBarLink"],!0,"click")};a.prototype.$2=function(){this.$1.addSubscriptions(b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").START,function(a,b){this.props.threadID===b&&this.setState({likePreview:a})}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").STOP,this.$4),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").STOP_EMOJI,this.$4),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").REMOVE,this.$4))};a.prototype.render=function(){var a=this.props.messages,c=this.props,d=c.onLoadMoreMessages,e=c.thread;c=c.threadID;var f=this.state.likePreview,g=b("CurrentUser").getID();f&&(a=a.push(f));return e?b("React").createElement(b("ChatConversation.react"),{isCanonical:b("MercuryIDs").isCanonical(c),loadMoreMessages:d,maxBubbleWidth:181-this.props.scrollbarPadding,messages:a,onAttachmentLoad:function(){return this.props.onAttachmentLoad()}.bind(this),onMount:b("emptyFunction"),onStickerClick:this.$5,onlineUsers:this.props.onlineUsers,readReceipts:this.props.readReceipts,ref:"conversation",thread:e,threadID:c,viewer:g}):b("React").createElement("div",null)};a.prototype.getMessageList=function(){return this.refs.conversation&&this.refs.conversation.getMessageList()};a.propTypes={messages:c.object.isRequired,onLoadMoreMessages:c.func.isRequired,onlineUsers:c.object.isRequired,scrollbarPadding:c.number,thread:c.object,threadID:c.string.isRequired};e.exports=a}),null);
__d("FantaPageGreetingLoader.react",["cx","BootloadOnRender.react","JSResource","LazyComponent.react","React","getPageIDFromThreadID"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=function(a){var c=a.thread;a=a.threadID;if(c!=null){c=((c=c)!=null?c.is_canonical_neo_user:c)||!1;if(c)return null}else return null;return b("getPageIDFromThreadID")(a)?b("React").createElement("div",{className:"_av1"},b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("MercuryChatTabPagesGreetingContainer.react").__setRef("FantaPageGreetingLoader.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{threadID:a})})):null};e.exports=a}),null);
__d("MercuryLastMessageIndicator.react",["cx","fbt","CurrentUser","immutable","MercuryIDs","MercuryMessageSourceTags","MercuryViewer","MessengerParticipants.bs","MessengerReadReceipt.bs","MessengerTextWithEmoticons.react","React","SubscriptionsHandler","TooltipData","WorkModeConfig","XWorkplaceHomepageMainController","emptyFunction","formatDate","gkx","joinClasses"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i,j=b("immutable").Set;c=b("React").PropTypes;var k=function(a,c,d){a=b("MessengerReadReceipt.bs").getSeenTimestamp(a,d,c[0]);d=a.action*.001;return{seenTimestamp:d,seenByData:null}},l=function(a,c,d){__p&&__p();var e={};for(var f=a,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;e[i]=b("MessengerParticipants.bs").getNow(i)}i=null;c&&c.custom_nickname&&(i=c.custom_nickname);h={};g=Object.keys(e);for(var f=0;f<g.length;f++){var j=g[f],k=e[j],l;void 0;!k?l=b("MessengerParticipants.bs").getDefaultName():(l=k.short_name,i&&i[k.fbid]&&(l=i[k.fbid]));h[j]=l}var m;k=!1;j=!1;n(a,d,c)?j=!0:a.length==1?m=" "+h[a[0]]:a.length==2?m=" "+h[a[0]]+", "+h[a[1]]:a.length==3?m=" "+h[a[0]]+", "+h[a[1]]+", "+h[a[2]]:a.length>3&&(m=" "+h[a[0]]+", "+h[a[1]]+", ",k=!0);return{seenTimestamp:null,seenByData:{seenByAll:j,text:m,showTooltip:k,seenBy:a}}},m=function(a,c,d,e){e=b("MessengerReadReceipt.bs").getSeenBy(a,e,!0);if(e.length===0)return{seenTimestamp:null,seenByData:null};var f=b("MercuryIDs").getUserIDFromThreadID(d);if(f)return k(a,e,d);else return l(e,c)},n=function(a,c,d){var e=d?d.participants.length:0;a=a.length;c&&c.author!=b("MercuryViewer").getID()&&(!d||d.participants.indexOf(c.author)>-1)&&a++;return e>2&&a>=e-1};d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={seenTimestamp:null,seenByData:null},b}a.getDerivedStateFromProps=function(a,b){"use strict";return m(a.readReceipts,a.thread,a.threadID,a.lastMessage)};a.prototype.shouldComponentUpdate=function(a,b){"use strict";__p&&__p();if(a.thread!==this.props.thread||a.threadID!==this.props.threadID||a.lastMessage!==this.props.lastMessage||a.isTyping!==this.props.isTyping||a.readReceipts!==this.props.readReceipts||b.seenTimestamp!==this.state.seenTimestamp)return!0;a=this.state.seenByData;b=b.seenByData;if(!a&&!b)return!1;if(!a||!b)return!0;if(a.seenByAll!==b.seenByAll||a.showTooltip!==b.showTooltip||a.text!==b.text)return!0;return!j(a.seenBy).equals(j(b.seenBy))?!0:!1};a.prototype.componentDidUpdate=function(){"use strict";if(!this.isVisible())return;this.props.indicatorDidShow&&this.props.indicatorDidShow()};a.prototype.componentWillUnmount=function(){"use strict";this.$1&&this.$1.release()};a.prototype.$2=function(){"use strict";return!this.props.lastMessage?[]:this.props.lastMessage.source_tags||this.props.lastMessage.tags||[]};a.prototype.$3=function(){"use strict";if(this.props.isTyping)return b("React").createElement("div",{className:this.$4([])},b("React").createElement("div",{className:"_510h"}),b("React").createElement("span",{className:"_510f",ref:"text"},"\xa0"));var a=this.$2(),c=this.state.seenByData,d=this.state.seenTimestamp;if(c)return b("React").createElement("div",{className:this.$4(a)},b("React").createElement("div",{className:"_510h"}),b("React").createElement("span",{className:"_510f"},this.$5(c)));else if(d)return b("React").createElement("div",{className:this.$4(a)},b("React").createElement("div",{className:"_510h"}),b("React").createElement("span",{className:"_510f",ref:"text"},this.$6(d)));else return b("React").createElement("div",{className:this.$4(a)},b("React").createElement("div",{className:"_510h"}),b("React").createElement("span",{className:"_510f",ref:"text"},this.$7(a)))};a.prototype.render=function(){"use strict";if(!b("CurrentUser").isWorkUser()&&b("gkx")("AT4vZBWyiZL1KZrir2lJt4vVNMIYu8sDbA3PtNwJWZh5seJSYZeYdmCgqH3wgiUS4PfslnEPm3wz9jSsjDINBCSy"))return b("React").createElement("div",{className:"_4gd0"},this.$3());else return this.$3()};a.prototype.$6=function(a){"use strict";var c=Date.now()*.001,d;a<c-518400?d="M j":a<c-86400?d="D g:ia":d="g:ia";return h._("Seen {timestamp}",[h._param("timestamp",b("formatDate")(a,d))])};a.prototype.$7=function(a){"use strict";__p&&__p();if(a.includes(b("MercuryMessageSourceTags").MESSENGER))if(!b("WorkModeConfig").is_work_user)return b("React").createElement("a",{href:"/mobile/messenger",className:"fcg",target:"_blank"},h._("Sent from Messenger"));else return b("React").createElement("a",{href:"https://www.facebook.com/workplace/mobile/",className:"fcg",target:"_blank"},h._("Sent from Workplace Chat"));else if(a.includes(b("MercuryMessageSourceTags").MOBILE)){var c=b("WorkModeConfig").is_work_user?"/workplace/mobile":"/mobile";return b("React").createElement("a",{href:c,className:"fcg",target:"_blank"},h._("Sent from Mobile"))}else if(a.includes(b("MercuryMessageSourceTags").EMAIL))return b("React").createElement("span",null,h._("Sent from email"));else if(a.includes(b("MercuryMessageSourceTags").WORK_DESKTOP)){c=b("XWorkplaceHomepageMainController").getURIBuilder().setString("path","chat-app").setString("ref","last-message-indicator").getURI();return b("React").createElement("a",{href:c,className:"fcg",target:"_blank"},h._("Sent from the desktop app"))}return null};a.prototype.$4=function(a){"use strict";var c=this.props.lastMessage&&this.props.lastMessage.author&&b("MercuryViewer").isViewer(this.props.lastMessage.author);c="_510g"+(c?" _510e":"");var d=null;this.props.isTyping?d=null:this.state.seenByData!==null||this.state.seenTimestamp!==null?d="seen":a.includes(b("MercuryMessageSourceTags").MESSENGER)||a.includes(b("MercuryMessageSourceTags").MOBILE)?d="sentFromMobile":a.includes(b("MercuryMessageSourceTags").WORK_DESKTOP)?d="sentFromDesktop":a.includes(b("MercuryMessageSourceTags").EMAIL)&&(d="sentFromEmail");return b("joinClasses")(c,d)};a.prototype.isVisible=function(){"use strict";var a=this.$2();return a.includes(b("MercuryMessageSourceTags").MESSENGER)||a.includes(b("MercuryMessageSourceTags").MOBILE)||a.includes(b("MercuryMessageSourceTags").EMAIL)||a.includes(b("MercuryMessageSourceTags").WORK_DESKTOP)?!0:this.state.seenTimestamp!==null||this.state.seenByData!==null};a.prototype.$5=function(a){"use strict";__p&&__p();var c=a.seenByAll;if(c)return h._("Seen by everyone");c=a.text;if(!c)return null;c=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoji:!0,renderEmoticons:!0,text:c});var d=a.showTooltip;if(!d)return h._("Seen by {names}",[h._param("names",c)]);else{d=this.$8(a);return h._("Seen by {names}{=num more link}",[h._param("names",c),h._param("=num more link",d)])}};a.prototype.$8=function(a){"use strict";__p&&__p();if(!a.text||!a.showTooltip)return null;var c={},d=0,e=null;b("MessengerParticipants.bs").getMulti(a.seenBy,function(b){e=a.seenBy.map(function(a){return b[a].name}).join("\r\n"),d=Object.keys(b).length-2});c=Object.assign({"data-tooltip-alignh":"center"},b("TooltipData").propsFor(e,"above"));var f=h._({"*":"{num} more"},[h._param("num",d,[0])]);return b("React").createElement("span",babelHelpers["extends"]({className:"more"},c),f)};a.propTypes={indicatorDidShow:c.func,lastMessage:c.object,readReceipts:c.object,threadID:c.string.isRequired,isTyping:c.bool.isRequired};a.defaultProps={indicatorDidShow:b("emptyFunction")};e.exports=a}),null);
__d("MercuryQuickReply.react",["cx","BootloadedComponent.react","JSResource","MercuryIDs","MessengerQuickCamOrigins","MessengerQuickReplyUtils","MessengerViewerContactMethodsWebGraphQLQuery","React","WebGraphQL","XUISpinner.react","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={viewerEmail:null,viewerPhone:null},b}a.prototype.componentDidMount=function(){this.$1(this.props.lastMessage)!==null&&this.props.quickReplyDidShow()};a.prototype.componentDidUpdate=function(a){this.$1(this.props.lastMessage)!==null&&this.$1(a.lastMessage)===null&&this.props.quickReplyDidShow(),this.$2(this.props.lastMessage)};a.prototype.render=function(){__p&&__p();var a=this.props.lastMessage,c=b("MercuryIDs").getParticipantIDFromUserID(this.props.viewer);if(!a||a.author===c)return null;c=this.$1(a);if(Array.isArray(c)){var d=c.every(function(a){return a.content_type==="user_email"&&this.state.viewerEmail===null||a.content_type==="user_phone_number"&&this.state.viewerPhone===null}.bind(this));if(!d){d=b("MessengerQuickReplyUtils").localizeTitleIfNecessary(c);return b("React").createElement("div",{className:"_419m"},b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("MessengerBotsQuickReplyButtonList.react").__setRef("MercuryQuickReply.react"),bootloadPlaceholder:b("React").createElement(b("XUISpinner.react"),{className:"_5h-9"}),isSponsored:a.is_sponsored,messageId:a.message_id,options:d,pageId:b("MercuryIDs").getUserIDFromParticipantID(a.author),threadID:a.thread_id,quickCamOriginLocation:this.props.quickCamOriginLocation,viewer:this.props.viewer,viewerEmail:this.state.viewerEmail,viewerPhone:this.state.viewerPhone}))}}return null};a.prototype.$1=function(a){a=a&&a.platform_xmd&&JSON.parse(a.platform_xmd);return Array.isArray(a&&a.quick_replies)?a&&a.quick_replies:null};a.prototype.$2=function(a){__p&&__p();a=this.$1(a);if(!a||a.length===0)return;a.some(function(a){return a.content_type==="user_email"||a.content_type==="user_phone_number"})&&b("promiseDone")(b("WebGraphQL").exec(new(b("MessengerViewerContactMethodsWebGraphQLQuery"))({})),function(a){var b;b=(b=a)!=null?(b=b.viewer)!=null?(b=b.user)!=null?b.all_phones:b:b:b;a=(a=a)!=null?(a=a.viewer)!=null?a.all_emails:a:a;var c=b?b.find(function(a){return a.is_preferred}):null;!c&&b&&(c=b[0]);b=a?a.find(function(a){return a.is_primary}):null;this.setState({viewerEmail:(a=b)!=null?a.display_email:a,viewerPhone:(b=c)!=null?(b=b.phone_number)!=null?b.universal_number:b:b})}.bind(this))};a.propTypes={quickReplyDidShow:c.func.isRequired,lastMessage:c.object,quickCamOriginLocation:c.oneOf(b("MessengerQuickCamOrigins").getValues()).isRequired,threadID:c.string.isRequired,viewer:c.string.isRequired};e.exports=a}),null);
__d("MessengerTabsThreadSearchLoader",["Promise","Bootloader","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={_store:null,_actions:null,_promise:null,getStoreEnforce:function(){b("nullthrows")(this._store,"Tab thread search store is not loaded");return this._store},getActionsEnforce:function(){b("nullthrows")(this._actions,"Tab thread search actions are not loaded");return this._actions},isLoaded:function(){return this._store&&this._actions},load:function(){this._promise||(this._promise=new(b("Promise"))(function(a){b("Bootloader").loadModules(["MessengerThreadSearchActions","MessengerTabsThreadSearchStore"],function(b,c){this._store=c.get(),this._actions=b,a({store:c,actions:b})}.bind(this),"MessengerTabsThreadSearchLoader")}.bind(this)));return this._promise}};e.exports=a}),null);
__d("FantaConversationScroller.react",["ix","cx","csx","fbt","Animation","Arbiter","BootloadedComponent.react","Bootloader","ChatThread","ChatTypingIndicatorsWrapper.react","CurrentUser","Event","FantaConversation.react","FantaPageGreetingLoader.react","FantaTabActions","Grid.react","Image.react","immutable","JSResource","Link.react","MercuryAttachment","MercuryConfig","MercuryIDs","MercuryLastMessageIndicator.react","MercuryQuickReply.react","MercuryShareAttachmentRenderLocations","MessengerHotLikePreviewEvents","MessengerParticipants.bs","MessengerQuickCamOrigins","MessengerTabsThreadSearchLoader","MessengerVideoAutoplayActions","MessengerVideoAutoplayStore","Parent","QE2Logger","React","ReactDOM","Scroll","ScrollBoundaryContain","Style","SubscriptionsHandler","TimeSlice","WebMessengerConstants","XUIButton.react","XUISpinner.react","asset","clearImmediate","emptyFunction","getElementPosition","getPageIDFromThreadID","gkx","isEventSupported","joinClasses","promiseDone","setImmediate","shallowEqual","throttle"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l=b("ChatThread").ChatThread,m=b("Grid.react").GridItem;c=b("React").PropTypes;var n=15,o=null,p=20,q=1e3;function r(a){__p&&__p();if(o===null){var c=a.firstElementChild;if(c){b("Style").set(a,"overflow","scroll");var d=c.clientWidth;b("Style").set(a,"overflow","hidden");c=c.clientWidth;o=Math.max(c-d,0);b("Style").set(a,"overflow","")}else o=0}return o}d=babelHelpers.inherits(a,b("React").Component);k=d&&d.prototype;function a(a){__p&&__p();k.constructor.call(this,a),this.$9=[],this.state={loadingMessages:!this.props.isEmptyLocalThread,scrollbarPadding:o===null?n:o,hideLastMessageIndicator:!1,searchResults:null},this.$20=function(a){a=b("ReactDOM").findDOMNode(this.refs.scrollContainer);a&&(this.$21(),this.$22()&&!this.$23()&&!this.$3&&!this.props.hasFetchedAll&&!(this.state.searchResults&&this.state.searchResults.mid)&&(this.setState({loadingMessages:!0}),this.props.onLoadMoreMessages()),this.$24(),this.$10())}.bind(this),this.$16=function(){__p&&__p();if(!this.refs||this.state.loadingMessages||!this.props.thread){this.$9=[];return}var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer),c=b("getPageIDFromThreadID")(this.props.threadID);if(!a||!c){this.$9=[];return}var d=10,e,f;try{e=a.getBoundingClientRect(),f=this.refs.conversation?this.refs.conversation.getMessageList():null}catch(a){return}if(!f||!e)return;var g=[];this.$8.forEach(function(a){if(!f)return;var h=a.message_id,i=f.getMessageElement(h);if(i){i=i.getBoundingClientRect();i.top>e.top-d&&i.bottom<e.bottom+d&&(g.push(h),this.$9.includes(h)||b("Bootloader").loadModules(["MessengerAdsWebLogger","MNAdsLoggerEventEnum"],function(b,d){b.log(a.ad_client_token,a.ad_id,d.MESSAGE_SEEN_THREAD,!0,h,c)},"FantaConversationScroller.react"))}}.bind(this),this);this.$9=g}.bind(this),this.$26=function(){this.$1=null,b("FantaTabActions").scrollBottomChanged(this.props.threadID,this.$6,this.$27)}.bind(this),this.$27=function(){this.$28(!1),this.$18()}.bind(this),this.$29=function(a){a=b("Parent").byClass(a.target,"._1dlq");a||this.props.onFocus&&this.props.onFocus()}.bind(this),this.$31=function(a){a.target&&a.target.classList&&a.target.classList.contains("_5wd4")&&(this.props.onFocus&&this.props.onFocus())}.bind(this),this.$6=!0}a.prototype.shouldComponentUpdate=function(a,c){var d=this.props,e=this.state;return!d.onlineUsers.equals(a.onlineUsers)||d.hasFetchedAll!==a.hasFetchedAll||d.isFocused!==a.isFocused||!d.messages.equals(a.messages)||d.showContextBanner!==a.showContextBanner||d.readReceipts!==a.readReceipts||d.thread!==a.thread||d.threadID!==a.threadID||e.loadingMessages!==c.loadingMessages||e.hideLastMessageIndicator!==c.hideLastMessageIndicator||!b("shallowEqual")(e.searchResults,c.searchResults)||d.jumpToMessage!==a.jumpToMessage};a.prototype.componentDidMount=function(){this.$7=new(b("SubscriptionsHandler"))(),this.$11(),this.$12(),this.$13(),b("MessengerVideoAutoplayActions").updateStore(this.props.threadID,this.$14()),this.setState({scrollbarPadding:r(this.refs.scrollContainer),searchResults:this.$15()}),this.$10=b("throttle")(this.$16,q),this.$8=this.props.messages.filter(function(a){return a.is_sponsored}),this.$10(),this.$17()};a.prototype.componentDidUpdate=function(a){__p&&__p();this.$13();if(this.$3){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer),d=this.$3||0;c=c.scrollHeight-d;this.scrollToPosition(c,!1);this.$3=null}if(!a.messages.equals(this.props.messages)){b("MessengerVideoAutoplayActions").updateStore(this.props.threadID,this.$14());d=a.messages.last();c=this.props.messages.last();if(d!==c&&c&&c.author){a=b("MercuryIDs").getUserIDFromParticipantID(c.author);a===b("CurrentUser").getID()&&(this.scrollToBottom(!1),this.$18())}}this.$19();this.$10()};a.prototype.componentWillUnmount=function(){this.$1&&b("clearImmediate")(this.$1),this.$7.release(),b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().updateThreadState(this.props.threadID,null)};a.prototype.UNSAFE_componentWillReceiveProps=function(a){__p&&__p();var c=this.state.loadingMessages&&a.messages.size>0&&!a.messages.equals(this.props.messages);if(c||a.hasFetchedAll||a.showContextBanner){this.setState({loadingMessages:!1});c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);var d=c.scrollHeight;c=b("Scroll").getTop(c);this.$3=d-c}this.$8=a.messages.filter(function(a){return a.is_sponsored})};a.prototype.$15=function(){return b("MessengerTabsThreadSearchLoader").isLoaded()?b("MessengerTabsThreadSearchLoader").getStoreEnforce().getThreadState(this.props.threadID):null};a.prototype.$17=function(){(b("gkx")("AT5-H1DssNMzHFJnUsWkAc7ZTo_DRYYDCHBxlitySatfbYXgP_km8FqsTzTXC2uX7HeORenaopRdXTYwYznmUFoOqEvkESAzIjmNIdQtgjBCQQ")||b("MercuryConfig").M3CRE)&&b("promiseDone")(b("MessengerTabsThreadSearchLoader").load(),function(a){var b=a.store;a.actions;this.$7.addSubscriptions(b.get().addListener("change",function(){return this.setState({searchResults:this.$15(),loadingMessages:!1})}.bind(this)))}.bind(this))};a.prototype.$13=function(a){a===void 0&&(a=!1),this.$6&&b("TimeSlice").guard(function(){this.scrollToBottom(a)}.bind(this),"post load chat animations",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()};a.prototype.renderGroupWave=function(){var a=this.props.thread;return b("MercuryIDs").isLocalThread(this.props.threadID)&&b("gkx")("AT7uCGaYk4KWBCIq3SurfBIwk1DjmbU_QXgSqcY73Sdnw3DJhbzA4qigZjhm4wwYtWnHVZcxghHN6RO33C1W8YjG")&&a&&!a.associated_object&&!a.is_canonical&&!a.thread_fbid?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement(b("XUISpinner.react"),{background:"light",className:"loading",size:"small"}),bootloadLoader:b("JSResource")("ChatWaveImage.react").__setRef("FantaConversationScroller.react"),thread:a,m4Thread:l!=null}):null};a.prototype.maybeRenderNullStateWave=function(){__p&&__p();var a=this.props,c=a.thread;a=a.threadID;if(!c||!c.is_canonical||c.timestamp)return null;b("QE2Logger").logExposureForUser("wave_in_www_null_state");if(!b("MercuryConfig").MNWNS)return null;c=b("MercuryIDs").getParticipantIDFromFromThreadID(a);c=c?b("MessengerParticipants.bs").getNow(c):null;c=c?c.short_name:null;return b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("MessengerNewWavePrompt.react").__setRef("FantaConversationScroller.react"),threadID:a,recipientName:c,entrypoint:"canonical_null_state"})};a.prototype.$24=function(){__p&&__p();var a=this.props.threadID,c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);if(!c)return;var d;try{c=c.getBoundingClientRect(),d=this.refs.conversation?this.refs.conversation.getMessageList():null}catch(a){return}if(!d||!c)return;var e=[],f=b("MessengerVideoAutoplayStore").getMessageIDs(a),g=f||this.$14()||b("immutable").List();g.map(function(a){var c=b("MercuryAttachment").getVideoElem(a,d);c&&e.push([a,c.getBoundingClientRect()])});e.length&&b("MessengerVideoAutoplayActions").onScroll(a,f?null:g,b("immutable").Map(e),c)};a.prototype.$14=function(){return this.props.messages.filter(function(a){return b("MercuryAttachment").isSingleVideoAttachment(a)||b("MercuryAttachment").isSharedVideoAttachmentMessage(a)}).reverse().map(function(a){return a.message_id})};a.prototype.$25=function(a,c){__p&&__p();var d=this.refs.conversation?this.refs.conversation.getMessageList():null;if(!d)return;var e=b("ReactDOM").findDOMNode(this.refs.scrollContainer),f=b("ReactDOM").findDOMNode(this.refs.conversation);d=d.getMessageElement(a,!0);if(!d||!f||!e)return;a=f.getBoundingClientRect().top;f=d.getBoundingClientRect().top;d=Math.abs(f-a)-e.getBoundingClientRect().height/2;this.$6=!1;this.scrollToPosition(Math.max(d,0),!1);var g=c;g&&b("setImmediate")(function(){return g()})};a.prototype.scrollToBottom=function(a){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);c&&this.scrollToPosition(c.scrollHeight,a)};a.prototype.scrollToPosition=function(a,c){var d=b("ReactDOM").findDOMNode(this.refs.scrollContainer);this.$5&&this.$5.stop();c?this.$5=new(b("Animation"))(d).to("scrollTop",a).ease(b("Animation").ease.end).duration(400).go():b("Scroll").setTop(d,a)};a.prototype.$23=function(a){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);a=a===0?0:a||p;return b("Scroll").getTop(c)+c.clientHeight>=c.scrollHeight-a};a.prototype.$22=function(){var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer);return b("Scroll").getTop(a)<a.clientHeight};a.prototype.$18=function(){var a=this.$6;this.$23()?this.$6=!0:this.$6=!1;a!==this.$6&&(this.$1=b("setImmediate")(this.$26))};a.prototype.$11=function(){__p&&__p();var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer);if(!a)return;var c=b("isEventSupported")("mousewheel")?"mousewheel":b("isEventSupported")("wheel")?"wheel":"DOMMouseScroll",d=function(){this.$18()}.bind(this),e=function(){a.addEventListener(c,d,{passive:!0})},f=function(){a.removeEventListener(c,d,{passive:!0})};this.$7.addSubscriptions(b("Arbiter").subscribe("overflow-applied-to-body",function(){return this.$13()}.bind(this)),b("Event").listen(a,"mousedown",d),b("Event").listen(a,"mouseup",d),b("Event").listen(a,"mouseenter",e),b("Event").listen(a,"mouseleave",f),{cancel:f},b("Event").listen(a,"scroll",b("throttle")(this.$20,50)));e=b("ScrollBoundaryContain").applyToElem(a);e&&this.$7.addSubscriptions(e)};a.prototype.$12=function(){this.$7.addSubscriptions(b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").START,function(a,b){this.props.threadID===b&&(this.$28(!1),clearInterval(this.$4),this.$4=setInterval(function(){this.$28(!1)}.bind(this),50))}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").FINISH_ANIMATION,function(a){clearInterval(this.$4)}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").FINISH_EMOJI_ANIMATION,function(a){clearInterval(this.$4)}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").REMOVE,function(a){this.props.threadID===a&&clearInterval(this.$4)}.bind(this)))};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.hasFetchedAll,d=a.isEmptyLocalThread,e=a.messages,f=a.showContextBanner,g=a.thread;a=a.threadID;var h=b("CurrentUser").getID(),i=b("gkx")("AT572SLwCLmZDDTsXg5I9LZsOQ15AFaFyPW6mF-2-OPcT86erU7KYs2R9o67DUyJwQ6AK0Y7upy2o2--jlRi_7EZ");i=i&&(d||c||f);d=this.state.loadingMessages||!g?b("React").createElement("div",{className:"_1xdl"},b("React").createElement(b("XUISpinner.react"),{background:"light",className:"loading",size:"small"})):null;c=function(){return this.$13()}.bind(this);f=b("React").createElement(b("FantaPageGreetingLoader.react"),{thread:g,threadID:a});i=i?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("MessengerContextBannerContainer.react").__setRef("FantaConversationScroller.react"),isContinuation:!1,location:b("MercuryShareAttachmentRenderLocations").CHAT,viewer:h,thread:g,threadID:a}):null;var k=b("React").createElement("div",{className:b("joinClasses")("accessible_elem","_2kwv")},j._("Chat Conversation Start")),n=b("React").createElement("div",{className:b("joinClasses")("accessible_elem","_2kwv")},j._("Chat Conversation End")),o=null,p=this.state.searchResults;if(p&&p.messages){var q=j._("Load more...");o=b("React").createElement(b("React").Fragment,null,p.upExhausted?null:b("React").createElement(b("XUIButton.react"),{className:"_41jf",label:q,onClick:function(){return b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().getMoreSearchContext(b("WebMessengerConstants").MORE_SEARCH_CONTEXT_UP,this.props.threadID)}.bind(this),type:"primary",use:"default"}),b("React").createElement(b("FantaConversation.react"),{onAttachmentLoad:c,scrollbarPadding:this.state.scrollbarPadding,ref:"conversation",messages:p.messages,onLoadMoreMessages:b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().getMoreSearchContext,hasFetchedAll:this.props.hasFetchedAll,isFocused:this.props.isFocused,onFocus:this.props.onFocus,onlineUsers:this.props.onlineUsers,readReceipts:this.props.readReceipts,showContextBanner:this.props.showContextBanner,thread:this.props.thread,threadID:this.props.threadID}),p.downExhausted?null:b("React").createElement(b("XUIButton.react"),{className:"_41jf",label:q,onClick:function(){return b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().getMoreSearchContext(b("WebMessengerConstants").MORE_SEARCH_CONTEXT_DOWN,this.props.threadID)}.bind(this),type:"primary",use:"default"}),b("React").createElement(b("ChatTypingIndicatorsWrapper.react"),{threadID:a,indicatorClass:undefined,indicatorsWillShow:b("emptyFunction"),indicatorsDidShow:function(){return this.setState({hideLastMessageIndicator:!0},function(){this.$13(!0)}.bind(this))}.bind(this),indicatorsDidHide:function(){return this.setState({hideLastMessageIndicator:!1})}.bind(this),rootClassName:undefined,viewer:h,onlineUsers:this.props.onlineUsers}))}else o=b("React").createElement(b("React").Fragment,null,b("React").createElement(b("FantaConversation.react"),babelHelpers["extends"]({onAttachmentLoad:c,scrollbarPadding:this.state.scrollbarPadding,ref:"conversation"},this.props)),b("React").createElement(b("MercuryQuickReply.react"),{lastMessage:e.size>0?e.last():undefined,threadID:a,quickReplyDidShow:function(){return this.$13(!0)}.bind(this),viewer:h,quickCamOriginLocation:b("MessengerQuickCamOrigins").CHAT_TAB}),b("React").createElement(b("ChatTypingIndicatorsWrapper.react"),{threadID:a,indicatorClass:undefined,indicatorsWillShow:b("emptyFunction"),indicatorsDidShow:function(){return this.setState({hideLastMessageIndicator:!0},function(){this.$13(!0)}.bind(this))}.bind(this),indicatorsDidHide:function(){return this.setState({hideLastMessageIndicator:!1})}.bind(this),rootClassName:undefined,viewer:h,onlineUsers:this.props.onlineUsers}),this.renderGroupWave(),this.maybeRenderNullStateWave(),b("React").createElement(b("MercuryLastMessageIndicator.react"),{isTyping:this.state.hideLastMessageIndicator,indicatorDidShow:function(){this.$13(!0)}.bind(this),indicatorWillShow:b("emptyFunction"),lastMessage:e.size>0?e.last():null,readReceipts:this.props.readReceipts,thread:g,threadID:a}));p=b("React").createElement("div",{className:"_1xdm"+(d?" _1xdw":"")},b("React").createElement("div",{className:"_1xdx"},b("React").createElement("div",{className:"_1xe8"})),k,i,d,b("React").createElement("div",{style:e.size>0?{height:"176px"}:d?{height:"168px"}:{height:"192px"},className:"_1xdm"},o),n);return l!=null?b("React").createElement(l,{onClick:this.$29,spacerContent:b("React").createElement(b("React").Fragment,null,k,i,f,d),scrollRef:function(a){this.refs.scrollContainer=a}.bind(this)},o,n,this.$30(!0)):b("React").createElement("div",{className:"_2v5j"},b("React").createElement("div",{className:"fbNubFlyoutBody scrollable",onClick:this.$31,ref:"scrollContainer",role:"button",tabIndex:"0"},b("React").createElement("div",{className:"fbNubFlyoutBodyContent"},f,b("React").createElement(b("Grid.react"),{className:"conversationContainer",role:"log",cols:1},b("React").createElement(m,{alignv:"bottom"},p)))),this.$30(!1))};a.prototype.$30=function(a){a=a?{bottom:"14px"}:{bottom:"74px"};return this.state.searchResults&&this.state.searchResults.messages?b("React").createElement(b("Link.react"),{style:a,className:"_2llh",onClick:function(){return b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().updateThreadState(this.props.threadID,null)}.bind(this)},b("React").createElement(b("Image.react"),{className:"_2llt",src:g("415098")})):null};a.prototype.$19=function(){var a=this.props.jumpToMessage;if(!a)return;this.props.messages.some(function(b){return b.message_id===a})||this.state.searchResults&&this.state.searchResults.messages&&this.state.searchResults.messages.some(function(b){return b.message_id===a})?this.$25(a,function(){return b("FantaTabActions").wipeJumpToMessage(this.props.threadID)}.bind(this)):b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().updateThreadState(this.props.threadID,a)};a.prototype.$21=function(){var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer),c=b("getElementPosition")(a);b("Arbiter").inform("chatScrolled/"+this.props.threadID,{scrollTop:b("Scroll").getTop(a),top:c.y,viewHeight:c.height})};a.prototype.$28=function(a){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);c&&this.$32(c.scrollHeight,a)};a.prototype.$32=function(a,c){var d=b("ReactDOM").findDOMNode(this.refs.scrollContainer);this.$5&&this.$5.stop();c===!0?this.$5=new(b("Animation"))(d).to("scrollTop",a).ease(b("Animation").ease.end).duration(400).go():b("Scroll").setTop(d,a)};a.propTypes={hasFetchedAll:c.bool.isRequired,isEmptyLocalThread:c.bool.isRequired,isFocused:c.bool.isRequired,messages:c.object.isRequired,onFocus:c.func,onLoadMoreMessages:c.func.isRequired,onlineUsers:c.instanceOf(b("immutable").List).isRequired,showContextBanner:c.bool,thread:c.object,threadID:c.string.isRequired,jumpToMessage:c.string};e.exports=a}),null);
__d("FantaDragAndDrop.react",["Bootloader","BootloadOnRender.react","FantaTypeComposer","JSResource","LazyComponent.react","MercuryShareAttachmentRenderLocations","MessengerEnvironment","React","emptyFunction","ifRequired"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=960;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$2=function(a){var b=this.props.composer;this.$5(function(c){c.removeSharePreview(a,b)})}.bind(this),this.$3=function(a,b){var c=this.props.composer;this.$5(function(d){d.loadedShareData(a,b,c)})}.bind(this),this.$4=function(a){var b=this.props.composer;this.$5(function(c){c.loadingShareData(a,b)})}.bind(this),b}a.prototype.componentDidMount=function(){b("MessengerEnvironment").messengerui?b("Bootloader").loadModules(["MessengerActions"],b("emptyFunction"),"FantaDragAndDrop.react"):b("Bootloader").loadModules(["FantaMessageActions"],b("emptyFunction"),"FantaDragAndDrop.react")};a.prototype.shouldComponentUpdate=function(a){var b=this.props,c=b.composer,d=a.composer,e=c.fileUploader,f=e.uploadingFiles;e=e.uploadedFiles;var g=d.fileUploader.uploadingFiles,h=d.fileUploader.uploadedFiles;c=c.sharePreview;d=d.sharePreview;return b.threadID!==a.threadID||!!(!f&&g)||!!(f&&g&&!f.equals(g))||!!(!e&&h)||!!(e&&h&&!e.equals(h))||!!(!c&&d)||!!(c&&d&&!c.equals(d))};a.prototype.render=function(){var a=this.props,c=a.composer;a=a.threadID;var d=c.sharePreview,e=d.share;d=d.uri;c=c.fileUploader;c.uploadingFiles;c.uploadedFiles;return b("React").createElement("div",{className:"fbNubFlyoutAttachments"},b("React").createElement("div",{className:"chatAttachmentShelf"},e||d?b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("MercurySharePreview.react").__setRef("FantaDragAndDrop.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{onClose:this.$2,onLoaded:this.$3,onLoading:this.$4,threadID:a,imageSize:{width:h,height:h},location:b("MercuryShareAttachmentRenderLocations").CHAT_PREVIEW,share:e,uri:d})}):null))};a.prototype.$5=function(a){b("MessengerEnvironment").messengerui?b("ifRequired")("MessengerActions",function(b){a(b)},function(){b("Bootloader").loadModules(["MessengerActions"],function(b){a(b)},"FantaDragAndDrop.react")}):b("ifRequired")("FantaMessageActions",function(b){a(b)},function(){b("Bootloader").loadModules(["FantaMessageActions"],function(b){a(b)},"FantaDragAndDrop.react")})};a.propTypes={composer:c.object.isRequired,threadID:c.string.isRequired};e.exports=a}),null);
__d("FantaMercuryTabOverflowBootloader.react",["BootloadOnRender.react","JSResource","LazyComponent.react","React","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){var a=b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr")?b("JSResource")("FantaM4TabOverflow.react").__setRef("FantaMercuryTabOverflowBootloader.react"):b("JSResource")("FantaMercuryTabOverflow.react").__setRef("FantaMercuryTabOverflowBootloader.react");return b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{items:this.props.items,tabContents:this.props.tabContents}),loader:a,placeholder:b("React").createElement("div",null)})};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("FantaTab.react",["cx","EventProfiler","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=!1,b}a.prototype.componentDidMount=function(){b("EventProfiler").informManualInteractionTimestamp(["MessageJewelListItem","ChatSideBarLink"],!0,"click")};a.prototype.render=function(){var a=this.props,c=a.isFocused,d=a.isLastTab,e=a.isLastTabOfType,f=a.MainComponent,g=a.messengerState,h=a.MinimizedComponent,i=a.raisedTabCount,j=a.tab;a=a.tabContent;h=j.isMinimized?h:f;f=j.id+(j.isMinimized?"-minimized":"-maximized");var k=this.$1&&!j.isMinimized;this.$1=j.isMinimized;return b("React").createElement("div",{className:"_5qi9 _5qib"+(this.props.isFocused?" _5qic":"")+(j.isMinimized?" _3001":"")},b("React").createElement(h,{isFocused:c,isHovered:j.isHovered||k,isLastTab:d,isLastTabOfType:e,key:f,messengerState:g,raisedTabCount:i,tab:j,tabContent:a}))};e.exports=a}),null);
__d("FantaTabGroup.react",["cx","FantaTab.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.shouldComponentUpdate=function(a){return!this.props.tabGroup.equals(a.tabGroup)||this.props.messengerState!==a.messengerState||!!(!this.props.tabContents&&a.tabContents)||!!(this.props.tabContents&&a.tabContents&&!this.props.tabContents.equals(a.tabContents))};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.isLastOfTypeChecker,d=a.MainComponent,e=a.messengerState,f=a.MinimizedComponent,g=a.OverflowComponent,h=a.tabContents;a=a.tabGroup;var i=a.focusedTabID,j=a.getRaisedandUnraisedTabs(),k=j.raisedTabs;j=j.unraisedTabs;var l;c&&(l=k.findLastKey(function(a){return c(a)&&a.id}));a=a.allowedRaisedTabs===0?null:this.$1(j,g);var m=k.count();return b("React").createElement("div",{className:"_59v1"},a,k.map(function(a){return b("React").createElement(b("FantaTab.react"),{isFocused:a.id===i,isLastTab:a===k.last(),isLastTabOfType:a.id===l,key:a.id,messengerState:e,MainComponent:d,MinimizedComponent:f,raisedTabCount:m,tab:a,tabContent:h&&h.get(a.id)})}).toArray())};a.prototype.$1=function(a,c){return!a.isEmpty()?b("React").createElement("div",{className:"_1kws"},b("React").createElement(c,{items:a,tabContents:this.props.tabContents})):null};function a(){h.apply(this,arguments)}a.propTypes={MainComponent:c.func.isRequired,messengerState:c.array,MinimizedComponent:c.func.isRequired,OverflowComponent:c.func.isRequired,tabContents:c.object,tabGroup:c.object.isRequired};e.exports=a}),null);
__d("MessengerPlatformPostbackFailedDialog.react",["fbt","MessengerDialog.react","MessengerDialogBodyReact.bs","MessengerDialogHeader.react","MessengerDialogs.bs","MessengerDialogTitle.react","React"],(function(a,b,c,d,e,f,g){"use strict";var h=b("MessengerDialogBodyReact.bs").jsComponent;function a(){return b("React").createElement(b("MessengerDialog.react"),{onToggle:function(a){a||b("MessengerDialogs.bs").removeDialog()}},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,g._("Action Unsuccessful"))),b("React").createElement(h,null,g._("There was an error delivering your message to the bot. Please try again later.")))}e.exports=a}),null);
__d("FantaPageComposerNullState.react",["cx","fbt","BootloadOnRender.react","CurrentUser","FantaAppStore","JSResource","LazyComponent.react","MessengerDialogs.bs","MessengerDiscoveryEntryPoint","MessengerDiscoveryEntryPointsLoggingHelper","MessengerPlatformPostbackFailedDialog.react","MNCommerceCallToActionType","MNCommercePostbackCTADataManager","MNCommercePostbackRefSendManager","React","XUISpinner.react","getPageIDFromThreadID"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$2=function(){__p&&__p();var a=this.props,c=a.threadID;a=a.nullStateCTA;switch(a.action_type){case b("MNCommerceCallToActionType").OPEN_NATIVE:break;case b("MNCommerceCallToActionType").POSTBACK:default:var d=b("FantaAppStore").getState().tabGroup.tabs.get(c),e=[];d&&d.entryPoint&&d.entryPoint[0]&&Object.values(b("MessengerDiscoveryEntryPoint")).indexOf(d.entryPoint[0])!==-1&&e.push(b("MessengerDiscoveryEntryPointsLoggingHelper").getEntryPointsLoggingTagStr([d.entryPoint[0]]));b("MNCommercePostbackCTADataManager").sendAndConfirm(a.id,a.title,c,null,function(a){a.error&&b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("MessengerPlatformPostbackFailedDialog.react"),null)})},null,e);break}}.bind(this),c}a.prototype.render=function(){return b("React").createElement("div",{className:"_2xh0"},this.$1(),b("React").createElement("div",{className:"_2xh4 _59w_"},b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{cta:this.props.nullStateCTA,onClick:this.$2,threadID:this.props.threadID}),loader:b("JSResource")("ChatPageComposerNullState.react").__setRef("FantaPageComposerNullState.react"),placeholder:b("React").createElement(b("XUISpinner.react"),{size:"small"})})))};a.prototype.$1=function(){__p&&__p();if(this.props.nullStateCTA!==null)switch(this.props.nullStateCTA.action_type){case b("MNCommerceCallToActionType").OPEN_NATIVE:return null;case b("MNCommerceCallToActionType").POSTBACK:if(!b("MNCommercePostbackRefSendManager").hasMDotMeRef(b("getPageIDFromThreadID")(this.props.threadID))&&!this.props.nullStateCTA.instantgame_metadata&&!b("CurrentUser").isWorkUser()){var a=this.props.pageName?this.props.pageName:h._("Page");return b("React").createElement("div",{className:"_4teq"},h._("When you tap {cta title}, {name} will see your public info.",[h._param("cta title",this.props.nullStateCTA.title),h._param("name",a)]))}break;default:return null}return null};e.exports=a}),null);
__d("FantaPendingActions.react",["Bootloader","BootloadOnRender.react","FantaTabActions","JSResource","LazyComponent.react","MercuryThreadActions","MessengerMessageRequestsTypedLogger","MessageRequestUtils","MessagingTag","React","MercuryIDs","CurrentUser"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("MercuryThreadActions").get();c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$3=function(){var a=this.props.thread;a=!!a&&b("MessageRequestUtils").isFiltered(a);var c=b("CurrentUser").getID();c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,c);new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_delete_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(a?"other":"pending").setThreadKey(c).setEntryPoint(null).log()}.bind(this),this.$4=function(a){var c=this.props.thread;c=!!c&&b("MessageRequestUtils").isFiltered(c);var d=b("CurrentUser").getID();d=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,d);a==="hide"&&new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_cancel").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(c?"other":"pending").setThreadKey(d).setEntryPoint("inbox_banner").log()}.bind(this),this.$1=function(){__p&&__p();var a=this.props,c=a.thread,d=a.threadID;a=!!c&&b("MessageRequestUtils").isFiltered(c);var e=b("CurrentUser").getID();e=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,e);if(a)b("Bootloader").loadModules(["WebMessengerDeleteThreadDialog"],function(a){a.show(d,this.$3,this.$4,function(){return b("FantaTabActions").closeTab(d)})}.bind(this),"FantaPendingActions.react");else{var f=b("MercuryIDs").isGroupChat(d);b("Bootloader").loadModules(["WebMessengerDeclineMRDialog"],function(a){a.show(c,d,function(){return b("FantaTabActions").closeTab(d)},f)},"FantaPendingActions.react")}new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_attempt").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(a?"other":"pending").setThreadKey(e).setEntryPoint(null).log()}.bind(this),this.$2=function(){var a=this.props.thread;a=!!a&&b("MessageRequestUtils").isFiltered(a);var c=b("CurrentUser").getID();c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,c);h.changeFolder(this.props.threadID,b("MessagingTag").INBOX);new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_accept_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(a?"other":"pending").setThreadKey(c).setEntryPoint(null).log()}.bind(this),c}a.prototype.render=function(){var a=this.props.thread;a=!!a&&b("MessageRequestUtils").isFiltered(a);return b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("ChatPendingActions.react").__setRef("FantaPendingActions.react"),placeholder:b("React").createElement("div",{style:{height:27}}),component:b("React").createElement(b("LazyComponent.react"),{isFiltered:a,onDeleteClick:this.$1,onReplyClick:this.$2})})};e.exports=a}),null);
__d("FantaTabComposer.react",["fbt","ChatTabComposerContainer.react","FantaTabActions","FantaTypeComposer","Keys","LogHistory","MessengerState.bs","PhotosUploadWaterfall","React","SimpleXUIDialog","WaterfallIDGenerator","WorkFileUploadsGating","XUIDialogButton.react","XUIDialogCancelButton.react","emptyFunction","getEveryoneMentionIndex"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("LogHistory").getInstance("chat_tab_view");c=b("React").PropTypes;var j=/^\s*$/;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$2=b("WaterfallIDGenerator").generate(),this.$14=function(a){this.$1=a,this.props.isFocused&&!this.props.isNewEmptyLocalThread&&this.focusInput()}.bind(this),this.$13=function(a){this.$15(b("PhotosUploadWaterfall").UPLOAD_START,a),this.props.onSendPhoto(a,this.$1.onSend),this.$16("submit",a),this.focusInput()}.bind(this),this.$7=function(a){this.$15(b("PhotosUploadWaterfall").CLIENT_ERROR,a),this.$16("failed",a)}.bind(this),this.$9=function(a){this.$15(b("PhotosUploadWaterfall").CLIENT_ERROR,a),this.$16("failed",a)}.bind(this),this.$11=function(a){this.$15(b("PhotosUploadWaterfall").CANCEL_DURING_UPLOAD,a),this.$16("canceled",a)}.bind(this),this.$12=function(a){this.$15(b("PhotosUploadWaterfall").ALL_UPLOADS_DONE,a);this.$16("completed",a);a=a.image_ids.length||a.attachments.length;this.$17(a)}.bind(this),this.$8=function(){this.props.onSendMessage("",this.props.composer,this.$1.onSend)}.bind(this),this.$10=function(a){this.props.onSelectSticker(a,b("emptyFunction"))}.bind(this),this.$5=function(a,b,c){this.props.onSendHotLike(a.emoji,b,c,function(){return this.$1.getInput()&&this.$1.getInput().focus()}.bind(this))}.bind(this),this.$6=function(a){this.$1.getInput().insertEmoji(a)}.bind(this),this.$4=function(event,a){var c=this.props.threadID;event.keyCode===b("Keys").RETURN&&!event.shiftKey&&(event.preventDefault(),this.$3(a));if(event.keyCode===b("Keys").DOWN&&event.shiftKey&&this.hasEmptyInput()){b("FantaTabActions").minimizeTab(c);return}}.bind(this),this.$3=function(a){var c=this.$20();if(c==null||c.length===0)this.$19(a,[]);else{var d=b("getEveryoneMentionIndex")(c)>-1;d?this.$18(a,c):this.$19(a,c)}}.bind(this),c}a.prototype.componentDidMount=function(){var a=this.props.participants;this.props.isFocused&&a.length>0&&!this.props.isEmptyLocalThread&&this.focusInput()};a.prototype.componentDidUpdate=function(a){this.props.isFocused&&this.props.isFocused!==a.isFocused&&!this.props.isEmptyLocalThread&&this.focusInput()};a.prototype.render=function(){var a=this.props,c=a.participants,d=a.threadID,e=a.viewer,f=a.isFocused;return c.length===0?b("React").createElement("div",null):b("React").createElement(b("MessengerState.bs").jsComponent,{fbid:e},function(a){return b("React").createElement(b("ChatTabComposerContainer.react"),{composer:this.props.composer,disableFileUploads:!b("WorkFileUploadsGating").canUploadFiles,disableInput:this.props.disableInput,fileUploader:this.props.fileUploader,handleSend:this.$3,inputKeyDown:this.$4,isFocused:f,onBlur:b("emptyFunction"),onCustomLikeSelect:this.$5,onEmojiSelect:this.$6,onEscape:this.props.onEscape,onFileUploadFail:this.$7,onMount:function(){},onP2PTrigger:this.$8,onPhotoUploadFail:this.$9,onStickerSelect:this.$10,onTab:this.props.onTab,onUploadCancel:this.$11,onUploadComplete:this.$12,onUploadSubmit:this.$13,placeholder:g._("Type a message..."),ref:this.$14,resizeFn:b("emptyFunction"),thread:b("MessengerState.bs").threads(a)[d],threadID:d,viewer:e})}.bind(this))};a.prototype.$15=function(a,c){b("PhotosUploadWaterfall").sendSignal(babelHelpers["extends"]({qn:this.$2,step:a,uploader:b("PhotosUploadWaterfall").APP_CHAT},c||{}))};a.prototype.$17=function(a){if(a===0)return;this.$15(b("PhotosUploadWaterfall").POST_PUBLISHED,{count:a});this.$2=b("WaterfallIDGenerator").generate()};a.prototype.$16=function(a,b){i.debug("photo_uploader:"+a,"{}")};a.prototype.$18=function(a,c){var d=g._("Mention everyone?").toString(),e=g._("Doing so will send a mention to everyone in this group.").toString(),f=g._("Mention \u0040everyone!").toString();f=b("React").createElement("div",null,b("React").createElement(b("XUIDialogCancelButton.react"),null),b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:f,use:"confirm",onClick:function(){this.$19(a,c)}.bind(this)}));b("SimpleXUIDialog").showEx(e,d,f,null,null)};a.prototype.$19=function(a,b){this.props.onSendMessage({message:a,mentions:b},this.props.composer,this.$1.onSend);return};a.prototype.focusInput=function(){this.$1&&this.$1.getInput()&&this.$1.getInput().focus()};a.prototype.$21=function(){return this.$1&&this.$1.getInput()&&this.$1.getInput().getValue()||""};a.prototype.$20=function(){if(!this.$1)return null;var a=this.$1.getInput();return a&&a.getMentions?a.getMentions():null};a.prototype.hasEmptyInput=function(){return j.test(this.$21())};a.propTypes={fileUploader:c.object,isEmptyLocalThread:c.bool.isRequired,isFocused:c.bool.isRequired,isNewEmptyLocalThread:c.bool.isRequired,onEscape:c.func.isRequired,onSelectSticker:c.func.isRequired,onSendHotLike:c.func.isRequired,onSendMessage:c.func.isRequired,onSendPhoto:c.func.isRequired,onTab:c.func.isRequired,participants:c.array.isRequired,threadID:c.string.isRequired,viewer:c.string.isRequired};e.exports=a}),null);
__d("FantaTabSheetPlaceholder.react",["cx","React","XUISpinner.react"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return b("React").createElement("div",{className:"_w_z"},b("React").createElement(b("XUISpinner.react"),null))};e.exports=a}),null);
__d("FantaTabSheet.react",["cx","BootloadedComponent.react","CurrentUser","FantaTabSheetPlaceholder.react","JSResource","MercuryIDs","MercuryMessages","MessengerParticipants.bs","MercurySheetPolicy","MessengerGroupsSyncStatus","React","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("MercuryMessages").get();c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.shouldComponentUpdate=function(a){var b=this.props;return b.threadID!==a.threadID||!b.tabContent.equals(a.tabContent)};a.prototype.maybeRenderMontage=function(){var a=this.props,c=a.threadID;a=a.tabContent;return a.isMontageOpen?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatMontageSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:"Montage",threadID:c,onResize:b("emptyFunction")}):null};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.threadID;a=a.tabContent;var d=a.loggingID,e=a.openSheet,f=a.privacyController,g=a.thread,h=a.typeahead,j;switch(e){case b("MercurySheetPolicy").sheets.ChatThreadIsMutedTabSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetChatThreadIsMuted.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatNameConversationTabSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetNameConversation.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement(b("FantaTabSheetPlaceholder.react"),null),key:e,thread:g,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatUserBlockedTabSheet:var k=b("MercuryIDs").getUserIDFromThreadID(c);if(k){k=b("MessengerParticipants.bs").getNow(b("MercuryIDs").getParticipantIDFromUserID(k));k&&f&&(j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUserBlockedTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),gender:k.gender,key:e,privacyActionController:f,shortName:k.short_name}))}break;case b("MercurySheetPolicy").sheets.ChatOfflineTabSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetOffline.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,privacyController:f,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatReadOnlyTabSheet:case b("MercurySheetPolicy").sheets.ChatReadOnlyPermanentTabSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetReadOnly.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,threadID:c});break;case b("MercurySheetPolicy").sheets.FantaAddFriendsSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetAddFriends.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement(b("FantaTabSheetPlaceholder.react"),null),key:e,loggingID:d,thread:g,threadID:c,typeahead:h});break;case b("MercurySheetPolicy").sheets.FantaAddMoreFriendsSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetAddMoreFriends.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement(b("FantaTabSheetPlaceholder.react"),null),key:e,loggingID:d,thread:g,threadID:c,typeahead:h});break;case b("MercurySheetPolicy").sheets.ChatThreadIsMessageBlockedSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetMessageBlocked.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatUserFocusSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUserFocusSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,thread:g,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatUserFocusBypassSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUserFocusBypassSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e});break;case b("MercurySheetPolicy").sheets.ChatUploadWarningTabSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUploadWarningTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e});break;case b("MercurySheetPolicy").sheets.ChatNoRecipientsTabSheet:b("MercuryIDs").isCanonical(c)||(j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatNoRecipientsTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e}));break;case b("MercurySheetPolicy").sheets.ChatNewMessagesTabSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaNewMessagesTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatEmployeeAwaySheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatEmployeeAwaySheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e});break;case b("MercurySheetPolicy").sheets.ChatEventReminderTabSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaEventReminderTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatAppointmentBanner:if(g){k=i.getCurrentlyLoadedMessages(c);j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatAppointmentBannerRoot.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),pageID:g.other_user_fbid,userID:b("CurrentUser").getID(),count:100,messageList:k,appointmentBannerDidUpdate:b("emptyFunction"),key:e,threadID:c})}break;case b("MercurySheetPolicy").sheets.ChatJoinCallSheet:if(g){f=g.rtc_call_data;d=g.thread_fbid;j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatJoinCallSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,rtcCallData:f,threadFBID:d})}break;case b("MercurySheetPolicy").sheets.ChatRoomAssociatedObjectSheet:if(g){h=g.associated_object;j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatRoomAssociatedObjectSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,associatedObject:h})}break;case b("MercurySheetPolicy").sheets.ChatMentorshipProgramSheet:j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("MentorshipProgramSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,mentorship:a.mentorship});break;case b("MercurySheetPolicy").sheets.ChatGroupsSyncTabSheet:g&&g.groups_sync_status==b("MessengerGroupsSyncStatus").OPT_IN&&g.groups_sync_fb_url&&(j=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatGroupsSyncTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,url:g.groups_sync_fb_url}));break}k=this.maybeRenderMontage();if(j)return b("React").createElement("div",{className:"_1sk5"},b("React").createElement("div",{className:"_1sk6"},j));else if(k)return k;return null};function a(){h.apply(this,arguments)}a.propTypes={threadID:c.string.isRequired,tabContent:c.object.isRequired};e.exports=a}),null);
__d("FantaTabMain.react",["cssVar","cx","fbt","invariant","Bootloader","BootloadOnRender.react","ChatBehavior","ChatConfig","ChatTabBlinking","CurrentUser","DragDropTarget","Event","FantaAvailableStatus","FantaChatHeaderContainer.react","FantaConversationScroller.react","FantaDispatcher","FantaDragAndDrop.react","FantaMessageActions","FantaPageComposerNullState.react","FantaPendingActions.react","FantaTabActions","FantaTabComposer.react","FantaTabSheet.react","FBIDCheck","immutable","JSResource","Keys","LazyComponent.react","MercuryIDs","MessengerParticipants.bs","MessageRequestUtils","MessagingTagConstants","MessengerBotMenuDataFetcher","MessengerParticipantUtils.bs","MessengerState.bs","MNCommercePageSetting","Parent","React","ReactDOM","SimpleXUIDialog","TrackingNodes","WorkChatAvailabilityStatusLoader","WorkFileUploadsGating","convertMIGColorToFIGColor","getPageIDFromThreadID","getVendorPrefixedEventName","gkx","ifRequired","joinClasses","promiseDone","throttle"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l=/\D+/g;c=b("React").PropTypes;var m=function(a){a=b("MercuryIDs").getUserIDFromThreadID(a.tab.id);return a&&b("gkx")("AT505jRFtG_7w3nhZICN2g5HZo5KZ4FP0G7n7x_oCDMvQmeZOfjSNcbXcUzDHS_pr0yjnx5p-38r7Z_8WJZNypI6")&&b("WorkChatAvailabilityStatusLoader").isLoaded()?b("WorkChatAvailabilityStatusLoader").getStoreEnforce().getIsDoNotDisturb(a):!1};function n(a,b,c){__p&&__p();var d={};if(a){b?d.backgroundColor=b:d.backgroundColor=c;if(a.length&&a.length>0)if(a.length===1)d.backgroundColor=a[0];else if(a.length===2)d.backgroundImage="linear-gradient("+a[0]+", "+a[1]+")";else{var e=a.length,f=100/(e-1);e=a.map(function(a,b){return a+" "+b*f+"%"}).join(", ");d.backgroundImage="linear-gradient("+e+")"}}else b?d.backgroundColor=b:d.backgroundColor=c;return d}d=babelHelpers.inherits(a,b("React").Component);k=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=k.constructor).call.apply(a,[this].concat(e)),this.$10=null,this.state={closing:!1,disableInput:!1,isDoNotDisturb:m(this.props)},this.$21=function(event){var a=!!b("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),c=!!b("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id);if(!a||!c){if(this.$9){clearTimeout(this.$9);this.$9=null;return}b("FantaTabActions").hoveredTab(this.props.tab.id)}}.bind(this),this.$22=function(event){var a=!!b("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),c=!!b("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id);(!a||!c)&&(this.$9&&clearTimeout(this.$9),this.$9=setTimeout(function(){this.$9=null,b("FantaTabActions").unhoveredTab(this.props.tab.id)}.bind(this),500))}.bind(this),this.$19=function(event){var a=!!b("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),c=!!b("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id);(!a||!c)&&(!event.relatedTarget||!event.target?this.$7=setTimeout(function(){this.$7=null,this.$24(this.props.tab.id)}.bind(this),100):this.$24(this.props.tab.id))}.bind(this),this.$20=function(event){if(this.$7){clearTimeout(this.$7);this.$7=null;return}var a=!!b("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),c=!!b("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id),d=event.target;d&&d.classList&&(d.classList.contains("_3olu")||d.classList.contains("_61td")||d.classList.contains("_40qq")||d.classList.contains("_4zs3"))||(!a||!c)&&(b("FantaDispatcher").isDispatching()||b("FantaTabActions").focusTab(this.props.tab.id))}.bind(this),this.$26=function(a){b("FantaMessageActions").linkPreview(this.props.tab.id,a)}.bind(this),this.$25=function(a){var c=this.props.tabContent;c=c||{};c=c.composer;var d=this.props.tab.id;c&&b("FantaMessageActions").prepareFilesForSend(d,a,c)}.bind(this),this.$16=function(a){a.keyCode===b("Keys").ESC&&(this.$2(!0),a.preventDefault(),a.stopPropagation())}.bind(this),this.$17=function(a){a.keyCode===b("Keys").TAB&&this.$18(a)}.bind(this),this.$18=function(event){var a=this.props.raisedTabCount;a>1&&(event.preventDefault(),this.$3(event.ctrlKey,event.shiftKey))}.bind(this),this.$2=function(a){var c=this.props,d=c.tab;c=c.tabContent;!c||c&&c.composer.text.length===0&&!this.$27()?(this.$28(),a?b("FantaTabActions").closeAndTabNext(d.id):b("FantaTabActions").closeTab(d.id)):this.$29()}.bind(this),c}a.prototype.UNSAFE_componentWillMount=function(){this.$2=b("throttle")(this.$2,100),this.$3=b("throttle")(this.$3,100)};a.prototype.componentDidMount=function(){this.$11(),this.$12(),this.$13(this.props.tab.id),this.$14(),this.$15()};a.prototype.componentDidUpdate=function(a){this.$12();if(b("gkx")("AT505jRFtG_7w3nhZICN2g5HZo5KZ4FP0G7n7x_oCDMvQmeZOfjSNcbXcUzDHS_pr0yjnx5p-38r7Z_8WJZNypI6")&&b("WorkChatAvailabilityStatusLoader").isLoaded()&&a.thread!==this.props.thread){var c=b("MercuryIDs").getUserIDFromThreadID(this.props.tab.id);a=b("MercuryIDs").getUserIDFromThreadID(a.tab.id);var d=b("WorkChatAvailabilityStatusLoader").getActionsEnforce();a&&d.unsubscribeUser(a,this);c&&(d.subscribeUser(c,this),b("WorkChatAvailabilityStatusLoader").getStoreEnforce().fetchUsers([c]))}};a.prototype.componentWillUnmount=function(){this.$4&&this.$4.disable();this.$10&&this.$10.remove();var a=b("MercuryIDs").getUserIDFromThreadID(this.props.tab.id);a&&b("WorkChatAvailabilityStatusLoader").isLoaded()&&b("WorkChatAvailabilityStatusLoader").getActionsEnforce().unsubscribeUser(a,this)};a.prototype.shouldComponentUpdate=function(a,b){var c=this.props,d=this.state;return c.hasFetchedAll!==a.hasFetchedAll||c.isFocused!==a.isFocused||c.isHovered!==a.isHovered||c.isLastGroupTab!==a.isLastGroupTab||!c.messages.equals(a.messages)||!c.tab.equals(a.tab)||!c.tabContent&&!!a.tabContent||c.tabContent&&!c.tabContent.equals(a.tabContent)||c.thread!==a.thread||c.messengerState!==a.messengerState||d.closing!==b.closing||d.disableInput!==b.disableInput||d.isDoNotDisturb!==b.isDoNotDisturb||!c.onlineUsers.equals(a.onlineUsers)};a.prototype.$12=function(){__p&&__p();if(b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr"))return;var a=this.props,c=a.tab;a=a.thread;c=c.id;if(!a)return;var d=this.refs.root&&b("ReactDOM").findDOMNode(this.refs.root);if(!d)return;a=a.unread_count;if(a!==undefined){a=!!a&&(!b("ChatBehavior").showsTabUnreadUI||b("ChatBehavior").showsTabUnreadUI());a?b("ChatTabBlinking").blinkTab(c,{getTabElem:function(){return d},isFocused:function(){return this.props.isFocused}.bind(this),isHovered:function(){return!1}}):b("ChatTabBlinking").unblinkTab(c)}};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.hasFetchedAll,d=a.isFocused,e=a.isHovered,f=a.isLastGroupTab,g=a.messages,h=a.onLoadMoreMessages,k=a.onSelectSticker,l=a.onSendHotLike,m=a.onSendMessage,o=a.onSendPhoto,p=a.showContextBanner,q=a.tab,r=a.tabContent;a=a.thread;q=q.id;var s=b("CurrentUser").getID(),t=r&&r.composer.fileUploader,u=r&&r.composer.sharePreview,v=t&&t.uploadingFiles,w=t&&t.uploadedFiles,x=a&&b("convertMIGColorToFIGColor")(a.header_color),y=r&&r.nullStateCTA,z=y&&a&&a.message_count===0,A=a&&a.participants||[],B=r&&r.threadPreviewRecipients||b("immutable").List();A=A.length>0?A:B.toArray();B=(B=this.props)!=null?(B=B.thread)!=null?B.other_user_fbid:B:B;B=B?b("MessengerParticipants.bs").getNow(b("MercuryIDs").getParticipantIDFromUserID(B)):null;var C=b("getPageIDFromThreadID")(this.props.tab.id),D=b("MessengerState.bs").isEmptyLocalThread(s,q),E=b("MessengerState.bs").isNewEmptyLocalThread(s,q);z=a&&b("MessageRequestUtils").isMessageRequest(a)?b("React").createElement(b("FantaPendingActions.react"),{thread:a,threadID:q}):z&&y?b("React").createElement(b("FantaPageComposerNullState.react"),{threadID:q,nullStateCTA:y,pageName:B&&B.short_name}):r?b("React").createElement("div",{className:"fbNubFlyoutFooter"+(this.state.disableInput?" fbNubFlyoutComposerDisabled":"")},b("React").createElement(b("FantaTabComposer.react"),{composer:r.composer,disableInput:this.state.disableInput,fileUploader:t,isEmptyLocalThread:D,isFocused:d,isNewEmptyLocalThread:E,onEscape:this.$16,onKeyDown:this.$16,onKeyPress:this.$17,onSelectSticker:k,onSendHotLike:l,onSendMessage:m,onSendPhoto:o,onTab:this.$18,ref:"composer",participants:A,threadID:q,viewer:s})):null;y=b("FantaAvailableStatus").isAvailable(a,q)&&!this.state.isDoNotDisturb;!r&&j(0);B=b("React").createElement(b("FantaTabSheet.react"),{tabContent:r,threadID:q});E=(t=a)!=null?t.marketplace_thread_data:t;l=(k=E)!=null?k.for_sale_item:k;o=(m=E)!=null?m.buyer_fbid:m;t=(A=E)!=null?A.seller_fbid:A;var F;l&&o&&t&&(F=b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("MarketplaceMessengerContextBanner.react").__setRef("FantaTabMain.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{buyerID:o,forSaleItem:l,renderLocation:"chat",sellerID:t})}));k=a&&b("gkx")("AT4vZBWyiZL1KZrir2lJt4vVNMIYu8sDbA3PtNwJWZh5seJSYZeYdmCgqH3wgiUS4PfslnEPm3wz9jSsjDINBCSy")?n(a.gradient_colors,a.solid_color,"#0084ff"):undefined;m=r&&r.isMultiCompany;A=r&&r.joinableInterstitialData?b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("ChatJoinableInterstitialPreview.react").__setRef("FantaTabMain.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{data:r.joinableInterstitialData,isActive:d,onClose:this.$2})}):b("React").createElement("div",{className:"fbNubFlyoutInner"},b("React").createElement(b("FantaChatHeaderContainer.react"),{blockedIDs:b("MessengerState.bs").blockedIds(this.props.messengerState),composer:r.composer,customColor:x,highlightNewMessage:r&&r.highlightNewMessage,isDoNotDisturb:this.state.isDoNotDisturb,isFocused:d,isLastGroupTab:f,isMultiCompany:m,isNewMessageTab:r&&r.isNewMessageTab,membershipParticipants:r.membershipParticipants,onClose:this.$2,pageIndicatorDescription:r.pageIndicatorDescription,participants:r.participants,thread:a,threadHref:r&&r.threadHref,threadID:q,viewer:s}),b("React").createElement("div",{className:"_1ia _2sz2",ref:function(a){this.$5=a}.bind(this),style:k},B,b("React").createElement(b("FantaConversationScroller.react"),{hasFetchedAll:c,isFocused:d,isEmptyLocalThread:D,messages:g,onFocus:function(){return this.refs.composer&&this.refs.composer.focusInput()}.bind(this),onLoadMoreMessages:h,onlineUsers:this.props.onlineUsers,readReceipts:b("MessengerState.bs").readReceiptsPerThread(this.props.messengerState),showContextBanner:p,thread:a,threadID:q,viewer:s,jumpToMessage:r.jumpToMessage}),b("React").createElement("div",{className:"_3bpu"}),b("React").createElement("div",{className:"_2hc2"},b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("P2PChatThreadBannerContainer.react").__setRef("FantaTabMain.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{isVisible:!0,otherUserID:b("MercuryIDs").getUserIDFromThreadID(q),threadID:q})})),b("React").createElement("div",{className:"_4g6x"},b("React").createElement("div",{className:"_4g6y"},b("React").createElement("div",{className:"_4g6z _4g71"},i._("Drag Link\/Files Here")),b("React").createElement("div",{className:"_4g6z _4g6- _4g6_"},i._("Drop Files Here")),b("React").createElement("div",{className:"_4g6z _4g6- _4g70"},i._("Drop Link Here")))),C?b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{originalElement:z,pageID:C,playLinkClassName:"_2xh6 _2h_r",showGameImage:!0,threadFBID:(E=this.props)!=null?(E=E.thread)!=null?E.thread_fbid:E:E,threadID:q}),loader:b("JSResource")("MessengerGameBotPlayButton.react").__setRef("FantaTabMain.react"),placeholder:b("React").createElement("div",null)}):z,b("React").createElement(b("FantaDragAndDrop.react"),{composer:r.composer,threadID:q,uploadedFiles:w,uploadingFiles:v,sharePreview:u}),F));o=b("gkx")("AT7HdSIkhS9TSQx6PWXopj-NxmSus9nuXkEu6XM1WdZJElXpLdnQNN92q5iZdzYJyRUbbjoWOgsBC8RH9ivzcfSt");return b("React").createElement("div",{className:b("joinClasses")((this.state.closing?"_2suj":"")+" _3_9e _s0f _50mz _50m_"+(y?" _4-0b":"")+(this.state.isDoNotDisturb?" _1oh2":"")+" fbNub _50-v"+(d?" focusedTab":"")+(e?" hoveredTab":"")+" opened _27_3"+(b("ChatConfig").get("single_line_composer")?" _68h9":"")+(o?" _69cg":"")+(o?" _4k2r":""),"fantaTabMain-"+q),"data-ft":b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.CHAT_FLYOUT),onBlur:this.$19,onFocus:this.$20,onKeyDown:this.$16,onKeyPress:this.$17,onMouseEnter:this.$21,onMouseLeave:this.$22,ref:"root"},b("React").createElement("div",{className:"fbNubFlyout fbDockChatTabFlyout uiContextualLayerParent",role:"complementary"},b("React").createElement("div",{className:"fbNubFlyoutOuter"},A)))};a.prototype.$23=function(){var a=b("MercuryIDs").getUserIDFromThreadID(this.props.tab.id);a&&b("gkx")("AT505jRFtG_7w3nhZICN2g5HZo5KZ4FP0G7n7x_oCDMvQmeZOfjSNcbXcUzDHS_pr0yjnx5p-38r7Z_8WJZNypI6")&&b("promiseDone")(b("WorkChatAvailabilityStatusLoader").load(),function(b){var c=b.store;b=b.actions;b.subscribeUser(a);c.fetchUsers([[a]]);this.$10=c.addListener(function(){this.setState({isDoNotDisturb:c.getIsDoNotDisturb(a)})}.bind(this))}.bind(this))};a.prototype.$24=function(a){b("FantaDispatcher").isDispatching()||b("FantaTabActions").blurTab(this.props.tab.id),this.$9&&(clearTimeout(this.$9),this.$9=null),setTimeout(function(){b("FantaTabActions").unhoveredTab(a)})};a.prototype.$15=function(){var a=b("getPageIDFromThreadID")(this.props.tab.id);a&&b("MessengerBotMenuDataFetcher").getHasPageSetting(a,function(a){this.setState({disableInput:a})}.bind(this),function(){this.setState({disableInput:!1})}.bind(this),b("MNCommercePageSetting").COMPOSER_INPUT_DISABLED)};a.prototype.$11=function(){__p&&__p();if(b("WorkFileUploadsGating").canUploadFiles&&!this.$4){var a=b("ReactDOM").findDOMNode(this.$5);if(a){a=new(b("DragDropTarget"))(a);this.$4=a;a.setOnFilesDropCallback(this.$25);a.setOnURLDropCallback(this.$26);a.enable()}}};a.prototype.$3=function(a,c){a||(c?b("FantaTabActions").focusPreviousTab():b("FantaTabActions").focusNextTab())};a.prototype.$28=function(){var a=this.props.tab.id;b("Bootloader").loadModules(["MessengerShareFilePreviewFunnelLogger"],function(b){return b.endFunnel(a)},"FantaTabMain.react")};a.prototype.$27=function(){return this.$30()||this.$31()};a.prototype.$30=function(){var a,b=this.props.tabContent;a=((a=b)!=null?(a=a.composer)!=null?(a=a.fileUploader)!=null?a.uploadedFiles:a:a:a)||{size:0};b=((b=b)!=null?(b=b.composer)!=null?(b=b.fileUploader)!=null?b.uploadingFiles:b:b:b)||{size:0};return a.size>0||b.size>0};a.prototype.$31=function(){var a=this.props.tabContent;a=(a=a)!=null?(a=a.composer)!=null?a.sharePreview:a:a;return!!(a&&a.params&&a.type)};a.prototype.$32=function(a){__p&&__p();var c=this.props.tab,d=b("ReactDOM").findDOMNode(this.refs.root);this.$1=setTimeout(function(){return a?b("FantaTabActions").closeAndTabNext(c.id):b("FantaTabActions").closeTab(c.id)},1.2*b("ifRequired")("cssVar",function(a){return"200ms".replace(l,"")},function(){return 200}));if(d)var e=b("Event").listen(d,b("getVendorPrefixedEventName")("animationend"),function(d){d.animationName==="closeChatTab"&&(a?b("FantaTabActions").closeAndTabNext(c.id):b("FantaTabActions").closeTab(c.id),clearTimeout(this.$1),e.remove())}.bind(this));this.$33();this.setState({closing:!0})};a.prototype.$29=function(a){var c=this.props.tab,d=c.id;b("FantaTabActions").blurTab(d);c=i._("Are you sure you want to close this chat window?");var e=i._("You haven't sent your message.");b("SimpleXUIDialog").showConfirm(c,e,function(c){c?(this.$28(),a?b("FantaTabActions").closeAndTabNext(d):b("FantaTabActions").closeTab(d)):b("FantaTabActions").focusTab(d)}.bind(this),{autofocusConfirm:!0,useReactFocusBehavior:!0})};a.prototype.$14=function(){this.$8=Math.floor(Date.now()/1e3)};a.prototype.$33=function(){var a=this.props.thread,c=a?a.other_user_fbid:null,d=Math.floor(Date.now()/1e3),e=this.$8;a&&c&&!b("FBIDCheck").isUser_deprecated(c)&&b("Bootloader").loadModules(["PagesLogger","PagesLoggerEventEnum","PagesLoggerEventTargetEnum","PagesEventObserver","PagesEventType"],function(b,f,g,h,i){b.log(c,f.CLICK,g.MESSAGE_FANTA_TAB_CLOSE,"",["pages_surface_team"],{open_tab_timestamp:e,close_tab_timestamp:d,last_message_timestamp:a.last_message_timestamp,message_count:a.message_count,snippet_sender:a.snippet_sender,participants:a.participants}),h.notify(i.MESSAGES_FANTA_TAB_CLOSE,c,{open_tab_timestamp:e,close_tab_timestamp:d,last_message_timestamp:a.last_message_timestamp,message_count:a.message_count,snippet_sender:a.snippet_sender,participants:a.participants})},"FantaTabMain.react")};a.prototype.$13=function(a){__p&&__p();if(!b("MercuryIDs").isValidThreadID(a))return;b("Bootloader").loadModules(["GroupChatMessageBlockAlert","GroupChatMessageIgnoreAlert","MercuryIgnoredBlockedParticipants.bs","MercuryThreadActions"],function(c,d,e,f){__p&&__p();var g=f.get();b("MessengerState.bs").getThreadMeta(b("CurrentUser").getID(),a,function(f){var h=b("MessengerState.bs").fbid(this.props.messengerState),i=b("MessengerState.bs").ignoredIds(this.props.messengerState);b("MessengerState.bs").compute(h,function(j){j=j.blocked_ids;e.isPresentInGroupThread(h,j,f)?c.show(e.participantsInGroupThread(h,j,f),function(){b("FantaTabActions").focusTab(a)},function(){b("FantaTabActions").closeTab(a),b("MessengerState.bs").isEmptyLocalThread(b("CurrentUser").getID(),a)||g.leaveGroup(a)}):b("MessengerParticipantUtils.bs").areParticipantsInGroupThread(h,i,f)&&f.folder==="inbox"&&d.show(b("MessengerParticipantUtils.bs").participantsInGroupThread(h,i,f),b("MercuryIDs").getThreadFBIDFromThreadID(a),function(){b("FantaTabActions").focusTab(a)},function(){b("FantaTabActions").closeTab(a),b("Bootloader").loadModules(["IgnoreMessagesTypedLogger","IgnoreMessagesLoggingEvent","IgnoreMessagesPlatforms"],function(c,d,e){g.changeFolder(a,b("MessagingTagConstants").other),new c().setEvent(d.IGNORE_CONFIRMED).setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(a)).setPlatform(e.CHAT_TABS).log()},"FantaTabMain.react")})})}.bind(this))}.bind(this),"FantaTabMain.react")};a.propTypes={hasFetchedAll:c.bool.isRequired,isFocused:c.bool.isRequired,isHovered:c.bool.isRequired,isLastGroupTab:c.bool.isRequired,messages:c.object,messengerState:c.array,onlineUsers:c.instanceOf(b("immutable").List).isRequired,onLoadMoreMessages:c.func.isRequired,onSelectSticker:c.func.isRequired,onSendHotLike:c.func.isRequired,onSendMessage:c.func.isRequired,onSendPhoto:c.func.isRequired,raisedTabCount:c.number,showContextBanner:c.bool,tab:c.object.isRequired,tabContent:c.object,thread:c.object};e.exports=a}),null);
__d("FantaTabMainLoader.react",["Bootloader","FantaAppStore","FantaAvailableStatus","FantaGetMessageActions","FantaMessageActions","FantaTabMain.react","immutable","MercuryConfig","MercuryIDs","React","TimeSlice","emptyFunction","requestIdleCallback","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;var h=function(a){__p&&__p();b("FantaAppStore").addReducers(a);a=b("FantaAppStore").getState();a=(a=a)!=null?(a=a.mercury)!=null?a.tabContents:a:a;if(a){var c=a.reduce(function(a,b){b=b.thread;b&&a.push(b);return a},[]);b("setImmediate")(function(){return b("FantaGetMessageActions").threadsUpdated(c)})}h=b("emptyFunction")};d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$2=function(){var a=this.props.tab;b("FantaGetMessageActions").fetchMoreMessages(a.id)}.bind(this),this.$3=function(a,c){var d=this.props.tab;b("FantaMessageActions").sendSticker(d.id,a,c)}.bind(this),this.$4=function(a,c,d,e){var f=this.props.tab;b("FantaMessageActions").sendHotLike(f.id,a,c,d,e)}.bind(this),this.$5=function(a,c,d){var e=this.props.tab;b("FantaMessageActions").sendMessage(e.id,a,c,d)}.bind(this),this.$6=function(a,c){var d=this.props.tab;b("FantaMessageActions").sendPhoto(d.id,a,c)}.bind(this),c}a.prototype.shouldComponentUpdate=function(a){var b=this.props;return b.isFocused!==a.isFocused||b.isHovered!==a.isHovered||b.isLastTabOfType!==a.isLastTabOfType||b.messengerState!==a.messengerState||!b.tab.equals(a.tab)||!b.tabContent.equals(a.tabContent)};a.prototype.componentDidMount=function(){var a=function(){b("Bootloader").loadModules(["FantaReducersTabSheets"],h,"FantaTabMainLoader.react")};b("TimeSlice").guard(function(){b("requestIdleCallback")(a)},"additional request not needed for initial display",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.isFocused,d=a.isHovered,e=a.isLastTabOfType,f=a.messengerState,g=a.raisedTabCount,h=a.tab;a=a.tabContent;var i=a.hasFetchedAll,j=a.showContextBanner,k=a.thread,l=a.threadPreviewID,m=a.messages;l=l?h.id+"-"+l:h.id;if(!a)return b("React").createElement("div",{key:"noContent-"+l});m||(m=b("immutable").List());var n=b("immutable").List([]);b("MercuryConfig").GDWC&&(n=this.$1(k,h));return b("React").createElement(b("FantaTabMain.react"),{hasFetchedAll:i,isFocused:c,isHovered:d,isLastGroupTab:e,key:l,messages:m,messengerState:f,onlineUsers:n,onLoadMoreMessages:this.$2,onSelectSticker:this.$3,onSendHotLike:this.$4,onSendMessage:this.$5,onSendPhoto:this.$6,raisedTabCount:g,showContextBanner:j,tab:h,tabContent:a,thread:k})};a.prototype.$1=function(a,c){__p&&__p();var d=b("MercuryIDs").getUserIDFromThreadID(c.id),e=[];d?e=b("FantaAvailableStatus").isAvailable(a,c.id)?[d]:[]:a&&(e=a.participants.filter(function(a){if(!a)return!1;a=b("MercuryIDs").getThreadIDFromParticipantID(a);if(!a)return!1;a=b("FantaAvailableStatus").isAvailable(null,a);return a}),e=e.map(function(a){return b("MercuryIDs").getUserIDFromParticipantID(a)||""}));return b("immutable").List(e)};a.propTypes={isFocused:c.bool.isRequired,isHovered:c.bool.isRequired,isLastTabOfType:c.bool.isRequired,messengerState:c.array,raisedTabCount:c.number,tab:c.object.isRequired,tabContent:c.object};e.exports=a}),null);
__d("XUIBadgeReact.bs",["ReasonReact.bs","XUIBadge.react","bs_js_null_undefined"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){if(a)if(a[0])return["regular"];else return["special"];else return 0}function a(a,c,d,e,f){return b("ReasonReact.bs").wrapJsForReason(b("XUIBadge.react"),{className:b("bs_js_null_undefined").fromOption(c),count:b("bs_js_null_undefined").fromOption(d),maxcount:b("bs_js_null_undefined").fromOption(e),type:b("bs_js_null_undefined").fromOption(g(a))},f)}f.stringOfBadgeType=g;f.make=a}),null);
__d("FantaM4HeaderMinimized.bs",["cx","fbt","cssVar","bs_block","bs_curry","React","bs_caml_obj","MercuryIDs","ReasonReact.bs","bs_js_primitive","XUIBadgeReact.bs","ChatThreadName.bs","ChatDetailStack.bs","FantaCloseButton.bs","FantaProfilePresence.bs","MessengerParticipants.bs","getGroupNameTooltipFromParticipantIDs"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("ReasonReact.bs").reducerComponentWithRetainedProps("FantaM4HeaderMinimized");function k(a,c){__p&&__p();if(a){var d=a[0];return d.reduce(function(a,e,f,g){__p&&__p();if(a.length<5)if(d.size>4){if(b("bs_caml_obj").caml_notequal(e.fbid,c)){f=e.image_src;f==null||a.push(f)}}else{g=e.image_src;g==null||a.push(g)}return a},[])}else return[]}function l(a,c,d){__p&&__p();if(a){a=a[0];var e=a.image_src;if(e==null){a=b("MercuryIDs").getParticipantIDFromFromThreadID(a.thread_id);if(a==null)return k(c,d);else{c=b("MessengerParticipants.bs").getNow(a);if(c==null)return[];else{d=c.image_src;if(d==null)return[];else return[d]}}}else return[e]}else return[]}function m(a){__p&&__p();if(a){a=a[0];if(a.is_canonical)return"";else{a=b("getGroupNameTooltipFromParticipantIDs").getGroupNameTooltipFromParticipantIDs(a.participants);if(a==null)return"";else return a}}else return""}function n(a,c,d,e,f,g,i,k,n){__p&&__p();return[j[0],j[1],j[2],j[3],j[4],function(a){var c=a[1];if(!a[0][2][0]&&c[2][0]){b("bs_curry")._1(c[3],0);setTimeout(function(){return b("bs_curry")._1(c[3],1)},1e3);return 0}else return 0},j[6],j[7],function(j){__p&&__p();var n=l(g,f,i),o=g?g[0].unread_count:0,p=m(g);if(g){var q=g[0].header_color;q=q==null?["#0084ff"]:[q]}else q=["#0084ff"];var r=a&&j[1][0];r=r?q?[q[0],"_69pt _2mgn _6d6l"]:["","_69pt _6d6l"]:q?["","_69pt _6d6l"]:["","_69pt _6d6l"];q=r[0];n=k?null:b("ReasonReact.bs").element(0,0,b("FantaProfilePresence.bs").make(n,20,c,[!0],g,"",p,[q],[]));p=k?h._("New Message"):b("ReasonReact.bs").element(0,0,b("ChatThreadName.bs").make(g,"",p,i,"_2mgq",[]));j=o>0&&!(a&&j[1][0]);return b("React").createElement("div",{className:r[1],style:{backgroundColor:q},onClick:e},b("React").createElement("div",{className:"_66n2"},n,b("React").createElement("div",{className:"_66n3"},b("ReasonReact.bs").element(0,0,b("ChatDetailStack.bs").make(p,null,[])),j?b("ReasonReact.bs").element(0,0,b("XUIBadgeReact.bs").make([0],["_429n"],[o],[99],[])):null)),b("ReasonReact.bs").element(0,0,b("FantaCloseButton.bs").make(d,!1,[])))},function(){return[!1]},[a],function(c,a){if(c)return b("bs_block").__(0,[[!1]]);else return b("bs_block").__(0,[[!0]])},j[12]]}a=b("ReasonReact.bs").wrapReasonForJs(j,function(a){return n(a.highlightNewMessage,a.isActive,a.onClose,a.onHeaderToggle,b("bs_js_primitive").null_undefined_to_opt(a.participants),b("bs_js_primitive").null_undefined_to_opt(a.thread),a.viewer,a.isNewMessageTab,[])});c=20;d=1e3;f.component=j;f.small_profile_image_size=c;f.blink_threshold_ms=d;f.getUpToFourImages=k;f.getProfileImages=l;f.getTooltip=m;f.make=n;f.jsComponent=a}),null);
__d("FantaTabMinimized.react",["cx","fbt","Bootloader","ChatBehavior","ChatTabBlinking","ChatTabHeaderContainer.react","CurrentUser","FantaAvailableStatus","FantaM4HeaderMinimized.bs","FantaTabActions","React","ReactDOM","SimpleXUIDialog","emptyFunction","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("FantaM4HeaderMinimized.bs").jsComponent;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={closing:!1},this.$5=function(event){var a=this.props,c=a.tab;a=a.tabContent;!a||a&&a.composer.text.length===0&&!this.$7()?(this.$8(),b("FantaTabActions").closeTab(c.id)):this.$9()}.bind(this),this.$6=function(event){var a=event.target;a&&a.classList&&!a.classList.contains("button")&&(event.stopPropagation(),b("FantaTabActions").unminimizeTab(this.props.tab.id),b("FantaTabActions").focusTab(this.props.tab.id))}.bind(this),c}a.prototype.componentDidMount=function(){this.$3()};a.prototype.componentDidUpdate=function(){this.$3()};a.prototype.shouldComponentUpdate=function(a){var b=this.props;return!b.tab.equals(a.tab)||!b.tabContent&&!!a.tabContent||!!b.tabContent&&!b.tabContent.equals(a.tabContent)};a.prototype.$3=function(){__p&&__p();if(b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr"))return;var a=this.props,c=a.tab;a=a.tabContent;c=c.id;if(!a)return;a=a.thread;if(!a)return;var d=this.refs.root&&b("ReactDOM").findDOMNode(this.refs.root);if(!d)return;a=a.unread_count;if(a!==undefined){a=!!a&&(!b("ChatBehavior").showsTabUnreadUI||b("ChatBehavior").showsTabUnreadUI());a?b("ChatTabBlinking").blinkTab(c,{getTabElem:function(){return d},isFocused:function(){return!1},isHovered:function(){return!1}}):b("ChatTabBlinking").unblinkTab(c)}};a.prototype.$4=function(){var a=this.props;a.tab;a=a.tabContent;var c=a&&a.thread,d=c&&c.thread_id,e=a&&a.thread&&a.thread.header_color,f=e?{color:e}:null,g=b("CurrentUser").getID();if(b("gkx")("AT6A1bnDK2h8UfK21QtwMasCKSCRuJLNl1CkXiFlb4ngyuzOTwnMPylW45yiU1EwI4xsY2mbtMRkoGbbra-xak0V")){d=c&&d&&b("FantaAvailableStatus").isAvailable(c,d);return b("React").createElement("div",{className:"clearfix titlebar"},b("React").createElement(j,{highlightNewMessage:a&&a.highlightNewMessage,isActive:d,isNewMessageTab:a&&a.isNewMessageTab,onClose:this.$5,onHeaderToggle:this.$6,participants:a&&a.participants,thread:c,viewer:g}))}return b("React").createElement("div",{className:(this.state.closing?"_2suj":"")+" clearfix fbNubFlyoutTitlebar titlebar"+(e?" _1m34":""),style:f},b("React").createElement(b("ChatTabHeaderContainer.react"),{attachmentsShelf:document.createElement("div"),composer:a&&a.composer,hasBlockedMessages:!1,isActive:!1,isRaised:!1,isTyping:!1,membershipParticipants:a&&a.membershipParticipants,onClick:this.$6,onCloseClick:this.$5,onRTCNuxCloseButtonClick:b("emptyFunction"),participants:a&&a.participants,rtcNuxShown:!1,sheetController:{},showAddFriend:b("emptyFunction"),thread:c,threadID:this.props.tab.id,viewer:g}))};a.prototype.render=function(){var a=this.props,c=a.tab;a=a.tabContent;c=c.id;a=a&&!!a.thread&&b("FantaAvailableStatus").isAvailable(a.thread,c);return b("React").createElement("div",{className:"_4cd8 _50mz _50m_ fbNub _50-v"+(a?" _4-0b":"")+" _27_3"+(b("gkx")("AT7HdSIkhS9TSQx6PWXopj-NxmSus9nuXkEu6XM1WdZJElXpLdnQNN92q5iZdzYJyRUbbjoWOgsBC8RH9ivzcfSt")?" _69cg":""),ref:"root"},this.$4())};a.prototype.$8=function(){var a=this.props.tab.id;b("Bootloader").loadModules(["MessengerShareFilePreviewFunnelLogger"],function(b){return b.endFunnel(a)},"FantaTabMinimized.react")};a.prototype.$7=function(){return this.$10()||this.$11()};a.prototype.$10=function(){var a,b=this.props.tabContent;a=((a=b)!=null?(a=a.composer)!=null?(a=a.fileUploader)!=null?a.uploadedFiles:a:a:a)||{size:0};b=((b=b)!=null?(b=b.composer)!=null?(b=b.fileUploader)!=null?b.uploadingFiles:b:b:b)||{size:0};return a.size>0||b.size>0};a.prototype.$11=function(){var a=this.props.tabContent;a=(a=a)!=null?(a=a.composer)!=null?a.sharePreview:a:a;return!!(a&&a.params&&a.type)};a.prototype.$9=function(){var a=this.props.tab,c=h._("Are you sure you want to close this chat window?");b("FantaTabActions").blurTab(a.id);var d=h._("You haven't sent your message.");b("SimpleXUIDialog").showConfirm(c,d,function(c){c?b("FantaTabActions").closeTab(a.id):b("FantaTabActions").focusTab(a.id)},{autofocusConfirm:!0,useReactFocusBehavior:!0})};a.propTypes={tab:c.object.isRequired,tabContent:c.object};e.exports=a}),null);
__d("FantaMercuryTabsWithMain.react",["Bootloader","CurrentUser","FantaAppStore","FantaCookieUtil","FantaMercuryTabOverflowBootloader.react","FantaTabActions","FantaTabGroup.react","FantaTabMainLoader.react","FantaTabMinimized.react","FluxContainer","LazyComponent.react","LoadOnRender.react","MercuryIDs","MessengerState.bs","PresenceState","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("MessengerState.bs").jsComponent,i=function(a){b("Bootloader").loadModules(["MessengerReasonDialogContainerReact.bs"],function(b){b=b.jsComponent;return a(b)},"FantaMercuryTabsWithMain.react")};g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("FantaAppStore")]};a.calculateState=function(){return{tabGroup:b("FantaAppStore").getState().tabGroup,tabContents:b("FantaAppStore").getState().mercury.tabContents}};a.prototype.componentDidMount=function(){this.props.loadDataOnMount&&b("FantaTabActions").loadFromData(b("FantaCookieUtil").convertCookieData(b("PresenceState").get()))};a.prototype.render=function(){return b("React").createElement(h,{fbid:b("CurrentUser").getID()},function(a){return[b("React").createElement(b("FantaTabGroup.react"),{key:"tabgroup",messengerState:a,MainComponent:b("FantaTabMainLoader.react"),MinimizedComponent:b("FantaTabMinimized.react"),OverflowComponent:b("FantaMercuryTabOverflowBootloader.react"),tabGroup:this.state.tabGroup,tabContents:this.state.tabContents,isLastOfTypeChecker:this.$1}),b("React").createElement(b("LoadOnRender.react"),{key:"dialog",component:b("React").createElement(b("LazyComponent.react"),null),loader:i,placeholder:b("React").createElement("span",null)})]}.bind(this))};a.prototype.$1=function(a){return b("MercuryIDs").isGroupChat(a.id)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a)}),null);
__d("FantaTabsReactApp",["ChatPerfInstrumentation","FantaMercuryTabsWithMain.react","FantaTabsAppBase","React","ReactDOM","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h;g=babelHelpers.inherits(a,b("FantaTabsAppBase"));g&&g.prototype;a.prototype.initializeFantaData=function(a){__p&&__p();d(["FantaAppStore","FantaCookieUtil","FantaGetMessageActions","FantaTabActions","MercuryThreadInformer","PresenceState"],function(c,d,e,f,g,i){__p&&__p();f.loadFromData(d.convertCookieData(i.get(),null,a)),i.registerStateLoader(function(b){f.loadFromData(d.convertCookieData(b,c.getState().tabGroup,a))}),i.registerStateStorer(function(a){var b=c.getState().tabGroup;if(!h||h&&!h.equals(b)){h=b;return d.createCookieData(b,a)}else return a}),g.get().subscribe("threads-updated",function(a,c){Object.keys(c).forEach(function(a){b("setImmediate")(function(){e.refreshThread(a)})})}),b("ChatPerfInstrumentation").logInitData()})};a.prototype.initializeFantaUI=function(){__p&&__p();d(["FantaAppStore","FantaMercuryThreadEventsBootloaded","FantaMessageActions","FantaTabActions","FantaTabViewportManager","FBRTCMessageHandler","MercuryBrowserAlerts"],function(a,c,d,e,f,g,h){__p&&__p();g.init();h.init();b("ReactDOM").render(this.getViewComponent(),this.tabsElem);c.onMessagesReceived(function(a,c){b("setImmediate")(function(){d.receivedNewMessage(a,c)})});f.init(this.tabsElem);b("ChatPerfInstrumentation").logInitUI();e=a.getState().tabGroup.tabs;e.toArray().length===0&&b("ChatPerfInstrumentation").logDisplayDone()}.bind(this))};a.prototype.getViewComponent=function(){return b("React").createElement(b("FantaMercuryTabsWithMain.react"),{loadDataOnMount:!1})};function a(){g.apply(this,arguments)}e.exports=new a()}),null);
__d("ChatInitialDataTransformer.bs",["bs_array","bs_js_dict","bs_caml_array","bs_caml_format","MessengerServerPayloadTransformer.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){__p&&__p();var c=a.viewer,d=a.is_page,e=[],f=[],g={},h=[],i={},j=[];b("bs_array").iter(function(a){__p&&__p();if(a==null)return 0;else{var k=b("MessengerServerPayloadTransformer.bs").getThreadFBID(a),l=b("MessengerServerPayloadTransformer.bs").getOtherUserID(a),m=b("MessengerServerPayloadTransformer.bs").transformThread(c,a,d);e.push(m);var n=b("MessengerServerPayloadTransformer.bs").transformMessages(c,a,d);n&&b("bs_array").iter(function(a){f.push(a);return 0},n[0]);n=b("MessengerServerPayloadTransformer.bs").getMessagePageInfo(a);n&&(n[0].has_previous_page||(k==null?l==null||j.push({type:"thread",fbid:l}):j.push({type:"thread",fbid:k})));n=b("MessengerServerPayloadTransformer.bs").transformReadReceipts(c,a);if(n){n=n[0];k==null||(g[k]=n);l==null||(g[l]=n)}k=b("MessengerServerPayloadTransformer.bs").transformDeliveryReceipts(a);if(k.length>=1){l=b("bs_caml_array").caml_array_get(k,0);if(m.is_canonical){n=m.other_user_fbid;n==null||h.push({other_user_fbid:n,thread_fbid:null,time:b("bs_caml_format").caml_float_of_string(l.timestamp_precise)})}else{k=m.thread_fbid;k==null||h.push({other_user_fbid:null,thread_fbid:k,time:b("bs_caml_format").caml_float_of_string(l.timestamp_precise)})}}n=b("MessengerServerPayloadTransformer.bs").transformParticipants(a);return b("bs_array").iter(function(a){i[a.fbid]=a;return 0},n)}},a.threads);return{threads:e,actions:f,roger:g,delivery_receipts:h,participants:b("bs_js_dict").values(i),end_of_history:j}}f.transform=a}),null);